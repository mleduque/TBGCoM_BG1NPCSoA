BACKUP ~BG1NPCSoA/backup~
SUPPORT ~http://www.baldursgatemods.com/forums/index.php?board=133.0~
VERSION ~13.6~

AUTO_TRA ~BG1NPCSoA/tra/%s~

ALWAYS
INCLUDE ~BG1NPCSoA/lib/functions.tph~

// The code that is needed to remove NPCs from The Darkest Day mod and install NPCs from this mod instead
INCLUDE ~BG1NPCSoA/lib/TDD_compat.tph~

// Loads macros and functions library dealing with tooltip appending and specific EE items descriptions.
INCLUDE ~%MOD_FOLDER%/lib/gw_functions.tpa~ 

ACTION_IF NOT VARIABLE_IS_SET bg2_chapter THEN BEGIN // check to make this happen only once per install

ACTION_IF (GAME_IS ~eet~) BEGIN // Check for EET and change chapter variables if it is detected
OUTER_SET bg2_chapter = 12
END ELSE BEGIN
  OUTER_SET bg2_chapter = 0
END
OUTER_FOR (i=1; i<=10; i=i+1) BEGIN
  OUTER_SET bg2_chapter = bg2_chapter + 1
  OUTER_SPRINT name_source ~bg2_chapter_%i%~
  OUTER_SET EVAL ~%name_source%~ = bg2_chapter
END

END

     // convert strings to UTF-8 for BGEE/BG2EE
	
ACTION_DEFINE_ARRAY 9xnoconvert BEGIN END
ACTION_DEFINE_ARRAY 9xreload BEGIN setup END

  LAF HANDLE_CHARSETS
    INT_VAR
      infer_charsets = 1
    STR_VAR
      tra_path = EVAL ~%MOD_FOLDER%/tra~
      noconvert_array = 9xnoconvert
      reload_array = 9xreload
END 


ACTION_IF (GAME_IS ~eet~) BEGIN // Check for EET and and fix NPC ToB-scripts so that there are no errors after a call through the Fate Spirit 
<<<<<<<< fix_tob_script.baf
IF
	GlobalGT("Chapter","GLOBAL",%bg2_chapter_7%) //If the ToB is launched, then ToB-scripts are added to all NPCs (they are created in the block of the corresponding component). This is necessary for the EET_NPC_TRANSITION function to work.
	GlobalGT("%tob_var%","GLOBAL",0)
THEN
	RESPONSE #100
	    ChangeAIScript("shoutdlg",DEFAULT) // add the default script to all NPCs in ToB, so that they themselves start a dialogue after calling through the Fate Spirit
		ChangeAIScript("%tob_override%",OVERRIDE)
		END
>>>>>>>>

END

END

// Translations
LANGUAGE ~English~
         ~English~
         ~BG1NPCSoA/tra/English/Setup.TRA~
LANGUAGE ~Russian, by Arcanecoast Team (Austin, yota13 & MacksimSl)~
         ~Russian~
         ~BG1NPCSoA/tra/Russian/Setup.TRA~

BEGIN @0 DESIGNATED 0
GROUP ~Main Mod~
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~

COPY_EXISTING ~sw1h01.itm~ ~override/7xbg1n.mrk~ // This file helps to determine if at least one component is installed - to disable the installation of the audio component and cross-banters if none of the main components is installed.
COPY_EXISTING ~sw1h01.itm~ ~override/7xbg1n1.mrk~ // This file helps to determine if at least one component is installed - to disable the installation auction component if Water Garden component is not installed.


APPEND ~STATE.IDS~ ~0x80101FEF CD_STATE_NOTVALID~
UNLESS ~CD_STATE_NOTVALID~

APPEND ~gtimes.ids~ ~7200 ONE_DAY~ UNLESS ~ONE_DAY~

 ACTION_IF GAME_IS "bg2ee eet" BEGIN

  // If a EE-version is installed, change the journal entries to adapt it 
  ADD_JOURNAL @1773 @1778 @1779 @1780 @1781 @1782 @1783 @1784 @1785 @1786 @1787 @1788 @1789 @1790 @1791 @1792 @1793 @1794 @1795 @1796 @1797 @1798 @1812 @1813 @1814 @1815 @1816 @1817
END  

COPY ~BG1NPCSoA/cre/MISC/7Xcre9.cre~ ~override/7Xcre9.cre~
SAY NAME1 @210
SAY NAME2 @210
SAY BIO @211
SAY INITIAL_MEETING ~~ [DEEKIN1]
  SAY MORALE ~~ 
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ [DEEKIN#]
  SAY UNHAPPY_SERIOUS ~~ [DEEKIN#]
  SAY UNHAPPY_BREAKING ~~ [DEEKIN#]
  SAY LEADER ~~ [DEEKIN9]
  SAY TIRED ~~ [DEEKIN8]
  SAY BORED ~~ [DEEKIN5]
  SAY BATTLE_CRY1 @217
  SAY BATTLE_CRY2 ~~ [deek2]
  SAY BATTLE_CRY3 @219
  SAY BATTLE_CRY4 ~~ [DEEKIN3]
  SAY BATTLE_CRY5 @217
  SAY DAMAGE ~~ [deek6]
  SAY DYING ~~ [deek5]
  SAY HURT ~~ [DEEKIN7]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1 ~~ [DEEKIN9]
  SAY SELECT_COMMON2 ~~ 
  SAY SELECT_COMMON3 ~~ [DEEKIN0]
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ [DEEKIN9]
  SAY SELECT_COMMON6 ~~ [DEEKIN0]
  SAY SELECT_ACTION1 ~~ [DEEKIN6]
  SAY SELECT_ACTION2 ~~ [deek7]
  SAY SELECT_ACTION3 ~~ [DEEKIN6]
  SAY SELECT_ACTION4 ~~ [deek7]
  SAY SELECT_ACTION5 ~~ [DEEKIN6]
  SAY SELECT_ACTION6 ~~ [deek7]
  SAY SELECT_ACTION7 ~~ [DEEKIN6]
  SAY SELECT_RARE1 ~~ [DEEKIN0]
  SAY SELECT_RARE2 ~~ [DEEKIN9]
  SAY CRITICAL_HIT @227 
  SAY CRITICAL_MISS ~~ 
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ [deek1]
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [deek4]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END

ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
COPY ~BG1NPCSoA/portraits/MAIN/EE-portraits/DEEKINL.BMP~ ~override/DEEKINL.BMP~
COPY ~BG1NPCSoA/portraits/MAIN/EE-portraits/DEEKINS.BMP~ ~override/DEEKINS.BMP~
COPY ~BG1NPCSoA/portraits/MAIN/EE-portraits/DEEKINM.BMP~ ~override/DEEKINM.BMP~
END ELSE BEGIN
COPY ~BG1NPCSoA/portraits/MAIN/vanilla-portraits/DEEKINL.BMP~ ~override/DEEKINL.BMP~
COPY ~BG1NPCSoA/portraits/MAIN/vanilla-portraits/DEEKINS.BMP~ ~override/DEEKINS.BMP~
END

COPY ~BG1NPCSoA/store/DEEKIN.sto~ ~override~
SAY NAME2 @230

COMPILE ~BG1NPCSoA/dialogues/DEEKIN.d~ EVALUATE_BUFFER
COMPILE ~BG1NPCSoA/dialogues/DEEKINToB.d~ EVALUATE_BUFFER

// Add dialog file to Tibit
COPY_EXISTING ~YSGP03.CRE~ ~override~
	SPRINT ~new_dialog~ ~%SOURCE_RES%~
	READ_ASCII 0x2cc dlg (8) NULL
	PATCH_IF ( ~%dlg%~ STR_CMP ~~ ) AND ( FILE_EXISTS_IN_GAME ~%dlg%.dlg~ ) BEGIN
		SPRINT EVAL ~%new_dialog%_DLG~ ~%dlg%~ //если диалог существует и прописан в cre-файле, назначаем его в переменную
	END ELSE BEGIN
		WRITE_EVALUATED_ASCII 0x2cc ~%new_dialog%~ (8) //если диалог пустой, прописываем в cre-файл диалог
		SPRINT EVAL ~%new_dialog%_DLG~ ~%new_dialog%~  //и назначаем его в переменную
		PATCH_IF ( NOT FILE_EXISTS_IN_GAME ~%new_dialog%.dlg~) BEGIN
			INNER_ACTION BEGIN
				COMPILE ~YSGP03.d~ EVALUATE_BUFFER // если такого диалога нет в игре, создаем его
			END
		END
	END
	BUT_ONLY_IF_IT_CHANGES

COMPILE ~BG1NPCSoA/scripts/DEEKIN.baf~ 
COMPILE ~BG1NPCSoA/scripts/DEEK25.baf~ 

APPEND ~pdialog.2da~
~DEEKIN	DEEKINP	DEEKINJ	DEEKIND DEEK25P DEEK25J DEEK25D DEEK25~
UNLESS ~DEEKIN~
APPEND ~interdia.2da~
  ~DEEKIN BDEEKIN BDEEK25~
  UNLESS ~DEEKIN~


// Deekin's Epilogue
EXTEND_TOP ~AR6200.bcs~ ~BG1NPCSoA/epilogues/Deekin/AR6200.baf~
COPY ~BG1NPCSoA/epilogues/Deekin/DeekEp.2da~ ~override/DeekEp.2da~
REPLACE ~99999~ @8018

// EET Fate Spirit Deeking

ACTION_IF (GAME_IS ~eet~) BEGIN
INCLUDE ~EET/other/EET_functions.tph~ // functions from EET mod

//// Create and install a missing ToB-script file to avoid installation errors and not to use a script from the BG1&SOA
ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/DEEKIN.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/DEEKIN.baf~
END ELSE BEGIN
<<<<<<<<DEEKIN.baf
>>>>>>>>
	COMPILE ~DEEKIN.baf~
END

ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/MISC/DEEK25.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/MISC/DEEK25.baf~ END
ELSE BEGIN
<<<<<<<<DEEK25.baf
>>>>>>>>
COMPILE ~DEEK25.baf~
END

LAF ~EET_NPC_TRANSITION~
INT_VAR
type = 2 // NPC is summon-able if met before
default_ToB = 1
STR_VAR
dv = "DEEKIN" // death variable 
override_SoA = "DEEKIN" // override script (SoA)
override_ToB = "DEEK25" // override script (ToB)
cre_ToB = "7XCRE9"
dialog_ToB = "DEEKIN" // joining dialogue for ToB
traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/DEEKINToB.tra"
string = "@0"
stringPosDV = "Dorn"
END
OUTER_SPRINT ~tob_override~ ~DEEK25~
OUTER_SPRINT ~tob_var~ ~DEEKINSummonedToB~
EXTEND_TOP ~DEEKIN.bcs~ ~fix_tob_script.baf~ EVALUATE_BUFFER
END 

LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Water-Gardens" oggdec_path = "BG1NPCSoA/sounds" END

COPY ~BG1NPCSoA/BAM~ ~override~


COPY ~BG1NPCSoA/Items/BG1IWD3.itm~ ~Override/BG1IWD3.itm~
SAY NAME1 @231
SAY NAME2 @231
SAY UNIDENTIFIED_DESC @231
SAY DESC @232


COPY ~BG1NPCSoA/Items/BG1IWD4.itm~ ~Override/BG1IWD4.itm~
SAY NAME1 @233
SAY NAME2 @233
SAY UNIDENTIFIED_DESC @234
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@235" END


COPY ~BG1NPCSoA/Items/BG1IWD5.itm~ ~Override/BG1IWD5.itm~
SAY NAME1 @236
SAY NAME2 @236
SAY UNIDENTIFIED_DESC @236
SAY DESC @237

COPY ~BG1NPCSoA/Items/BG1IWD1.itm~ ~Override/BG1IWD1.itm~
SAY NAME1 @238
SAY NAME2 @238
SAY UNIDENTIFIED_DESC @238
SAY DESC @239


COPY ~BG1NPCSoA/Items/BG1IWD2.itm~ ~Override/BG1IWD2.itm~
SAY NAME1 @240
SAY NAME2 @240
SAY UNIDENTIFIED_DESC @240
SAY DESC @241



COPY ~BG1NPCSoA/Items/BG1IWD6.itm~ ~Override/BG1IWD6.itm~
SAY NAME1 @242
SAY NAME2 @243
SAY UNIDENTIFIED_DESC @243
SAY DESC @244


COPY ~BG1NPCSoA/Items/BG1IWD7.itm~ ~Override/BG1IWD7.itm~
SAY NAME1 @245
SAY NAME2 @246
SAY UNIDENTIFIED_DESC @245
SAY DESC @247
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "scimitar" END

COPY ~BG1NPCSoA/Items/DEPO45.itm~ ~Override/DEPO45.itm~
SAY NAME1 @248
SAY NAME2 @248
SAY UNIDENTIFIED_DESC @248
SAY DESC @249

COPY ~BG1NPCSoA/Items/DEPO18.itm~ ~Override/DEPO18.itm~
SAY NAME1 @250
SAY NAME2 @251
SAY UNIDENTIFIED_DESC @250
SAY DESC @252
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "axe" END


COPY ~BG1NPCSoA/Items/BG1IWD8.itm~ ~Override/BG1IWD8.itm~
SAY NAME1 @245
SAY NAME2 @253
SAY UNIDENTIFIED_DESC @245
SAY DESC @254
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "scimitar" END


COPY ~BG1NPCSoA/Items/BG1IWD9.itm~ ~Override/BG1IWD9.itm~
SAY NAME1 @255
SAY NAME2 @255
SAY UNIDENTIFIED_DESC @255
SAY DESC @256
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "axe" END


///////////////////////////////////////////////////////////////////////////////////

// Borivyk

COPY ~BG1NPCSoA/cre/MISC/7XBoriv.cre~ ~override/7XBoriv.cre~
SAY NAME1 @1727
SAY NAME2 @1727

COPY ~BG1NPCSoA/cre/MISC/7XMaid.cre~ ~override/7XMaid.cre~
SAY NAME1 @1728
SAY NAME2 @1728

COPY ~BG1NPCSoA/cre/MISC/7xBear1.cre~ ~override/7xBear1.cre~
SAY NAME1 @1930
SAY NAME2 @1930

COPY ~BG1NPCSoA/cre/MISC/7xRanger.cre~ ~override/7xRanger.cre~
SAY NAME1 @1931
SAY NAME2 @1931

COPY ~BG1NPCSoA/Items/Rabb7x.itm~ ~Override/Rabb7x.itm~
SAY NAME1 @1928
SAY NAME2 @1928
SAY UNIDENTIFIED_DESC @1928
SAY DESC @1929

COPY ~BG1NPCSoA/Items/dragn7x.itm~ ~Override/dragn7x.itm~
SAY NAME1 @1932
SAY NAME2 @1932
SAY UNIDENTIFIED_DESC @1932
SAY DESC @1933

COPY ~BG1NPCSoA/Items/bird7x.itm~ ~Override/bird7x.itm~
SAY NAME1 @1934
SAY NAME2 @1934
SAY UNIDENTIFIED_DESC @1934
SAY DESC @1935

COPY ~BG1NPCSoA/Items/ferret7x.itm~ ~Override/ferret7x.itm~
SAY NAME1 @1936
SAY NAME2 @1936
SAY UNIDENTIFIED_DESC @1936
SAY DESC @1937

EXTEND_BOTTOM ~Aerie.bcs~ ~%MOD_FOLDER%/scripts/MISC/7xAerieWaterGardens.baf~
EXTEND_BOTTOM ~AR2000.bcs~ ~BG1NPCSoA/scripts/MISC/AR2000.baf~

///////////////////////////////////////////////////////////////////////////////////

COPY ~BG1NPCSoA/cre/MISC/7Xcre24.cre~ ~override/7Xcre24.cre~
SAY NAME1 @278
SAY NAME2 @278

COPY ~BG1NPCSoA/cre/MISC/7Xcre25.cre~ ~override/7Xcre25.cre~
SAY NAME1 @279
SAY NAME2 @279

COPY ~BG1NPCSoA/cre/MISC/7Xcre26.cre~ ~override/7Xcre26.cre~
SAY NAME1 @280
SAY NAME2 @281

COPY ~BG1NPCSoA/store/bg1npc7.sto~ ~override~
SAY NAME2 @282

COPY ~BG1NPCSoA/Items/ETBITM1.itm~ ~Override/ETBITM1.itm~
SAY NAME1 @283
SAY NAME2 @284
SAY UNIDENTIFIED_DESC @283
SAY DESC @285


COPY ~BG1NPCSoA/Items/ETBITM2.itm~ ~Override/ETBITM2.itm~
SAY NAME1 @286
SAY NAME2 @287
SAY UNIDENTIFIED_DESC @286
SAY DESC @288


COPY ~BG1NPCSoA/Items/ETBITM3.itm~ ~Override/ETBITM3.itm~
SAY NAME1 @283
SAY NAME2 @289
SAY UNIDENTIFIED_DESC @283
SAY DESC @290



COPY ~BG1NPCSoA/Items/ETBITM4.itm~ ~Override/ETBITM4.itm~
SAY NAME1 @250
SAY NAME2 @291
SAY UNIDENTIFIED_DESC @250
SAY DESC @292
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "axe" END


COPY ~BG1NPCSoA/Items/ETBITM5.itm~ ~Override/ETBITM5.itm~
SAY NAME1 @293
SAY NAME2 @294
SAY UNIDENTIFIED_DESC @293
SAY DESC @295


COPY ~BG1NPCSoA/Items/ETBITM6.itm~ ~Override/ETBITM6.itm~
SAY NAME1 @296
SAY NAME2 @297
SAY UNIDENTIFIED_DESC @296
SAY DESC @298

COPY ~BG1NPCSoA/Items/ETBITM7.itm~ ~Override/ETBITM7.itm~
SAY NAME1 @299
SAY NAME2 @300
SAY UNIDENTIFIED_DESC @299
SAY DESC @300


COPY ~BG1NPCSoA/Items/kgsto5X.itm~ ~Override/kgsto5X.itm~
SAY NAME1 @301		
SAY NAME2 @301
SAY UNIDENTIFIED_DESC @301
SAY DESC @302


COPY ~BG1NPCSoA/Items/PLATNUM.itm~ ~Override/PLATNUM.itm~
SAY NAME1 @303		
SAY NAME2 @303
SAY UNIDENTIFIED_DESC @303
SAY DESC @304

COPY ~BG1NPCSoA/Items/DEPO45.itm~ ~Override/DEPO45.itm~
SAY NAME1 @248
SAY NAME2 @248
SAY UNIDENTIFIED_DESC @248
SAY DESC @249

COPY ~BG1NPCSoA/cre/MISC/7Xcre27.cre~ ~override/7Xcre27.cre~
SAY NAME1 @305
SAY NAME2 @305

COPY ~BG1NPCSoA/cre/MISC/7Xcre28.cre~ ~override/7Xcre28.cre~
SAY NAME1 @306
SAY NAME2 @306


COPY ~BG1NPCSoA/cre/MISC/7Xcre29.cre~ ~override/7Xcre29.cre~
SAY NAME1 @307
SAY NAME2 @307

COPY ~BG1NPCSoA/cre/MISC/7Xcre30.cre~ ~override/7Xcre30.cre~
SAY NAME1 @308
SAY NAME2 @308

COPY ~BG1NPCSoA/cre/MISC/7Xcre31.cre~ ~override/7Xcre31.cre~
SAY NAME1 @309
SAY NAME2 @309


COPY ~BG1NPCSoA/cre/MISC/7Xcre32.cre~ ~override/7Xcre32.cre~
SAY NAME1 @310
SAY NAME2 @310


COPY ~BG1NPCSoA/cre/KAGAIN'S-KORNER/KGSTO2.CRE~ ~override/KGSTO2.cre~
SAY NAME1 @311
SAY NAME2 @311
SAY INITIAL_MEETING @312 
  SAY MORALE @313 
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED @314 
  SAY UNHAPPY_SERIOUS @314 
  SAY UNHAPPY_BREAKING @314
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ 
  SAY BATTLE_CRY2 ~~ 
  SAY BATTLE_CRY3 ~~ 
  SAY BATTLE_CRY4 ~~ 
  SAY BATTLE_CRY5 ~~ 
  SAY DAMAGE ~~ 
  SAY DYING ~~ 
  SAY HURT ~~   
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~  
  SAY SELECT_COMMON1  @315 
  SAY SELECT_COMMON2 @313 
  SAY SELECT_COMMON3 @316 
  SAY SELECT_COMMON4 @317
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 @316 
  SAY SELECT_ACTION2 @313 
  SAY SELECT_ACTION3 @314 
  SAY SELECT_ACTION4  @318 
  SAY SELECT_ACTION5 @319 
  SAY SELECT_ACTION6 @315 
  SAY SELECT_ACTION7 @318 
  SAY SELECT_RARE1 @313 
  SAY SELECT_RARE2 @315 
  SAY CRITICAL_HIT ~~ 
  SAY CRITICAL_MISS ~~ 
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
SAY REACT_TO_DIE_GENERAL ~~ 
  SAY INTERACTION3 @315 
  SAY COMPLIMENT1 @317 



COPY ~BG1NPCSoA/store/BG1NPC2.sto~ ~override~
SAY NAME2 @320
SAY 0xa4 @321
  SAY 0xb8 @322
  SAY 0xcc @323
  SAY 0xe0 @324
  SAY 0xf4 @325
  SAY 0x108 @326
  SAY 0x11c @327

COPY ~BG1NPCSoA/store/BG1NPCX.sto~ ~override~
SAY NAME2 @328
SAY 0xa4 @329
  SAY 0xb8 @330
  SAY 0xcc @331
  SAY 0xe0 @324
  SAY 0xf4 @332
  SAY 0x108 @333
  SAY 0x11c @334




COPY ~BG1NPCSoA/cre/MISC/7Xcre33.cre~ ~override/7Xcre33.cre~
SAY NAME1 @335
SAY NAME2 @335


COPY ~BG1NPCSoA/cre/MISC/7Xcre34.cre~ ~override/7Xcre34.cre~
SAY NAME1 @336
SAY NAME2 @336


COPY ~BG1NPCSoA/cre/MISC/7Xcre35.cre~ ~override/7Xcre35.cre~
SAY NAME1 @337
SAY NAME2 @337


COPY ~BG1NPCSoA/cre/MISC/7Xcre36.cre~ ~override/7Xcre36.cre~
SAY NAME1 @338
SAY NAME2 @338

COPY ~BG1NPCSoA/cre/MISC/7Xcre37.cre~ ~override/7Xcre37.cre~
SAY NAME1 @339
SAY NAME2 @339

COPY ~BG1NPCSoA/cre/MISC/7XCRE38.cre~ ~override/7XCRE38.cre~
SAY NAME1 @340
SAY NAME2 @340


COPY ~BG1NPCSoA/cre/MISC/7XCRE39.cre~ ~override/7XCRE39.cre~
SAY NAME1 @341
SAY NAME2 @341

COPY ~BG1NPCSoA/cre/MISC/7XCRE40.cre~ ~override/7XCRE40.cre~
SAY NAME1 @342
SAY NAME2 @342
SAY INITIAL_MEETING ~~ 
  SAY MORALE ~~ 
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ 
  SAY BATTLE_CRY2 ~~ 
  SAY BATTLE_CRY3 ~~ 
  SAY BATTLE_CRY4 ~~ 
  SAY BATTLE_CRY5 ~~ 
  SAY DAMAGE ~~ [KRYST05]
  SAY DYING ~~ 
  SAY HURT ~~ [KRYST05]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ 
  SAY SELECT_COMMON2 ~~ 
  SAY SELECT_COMMON3 ~~ 
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ 
  SAY SELECT_ACTION2 ~~ 
  SAY SELECT_ACTION3 ~~ 
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ 
  SAY SELECT_RARE2 ~~ 
  SAY CRITICAL_HIT ~~ 
  SAY CRITICAL_MISS ~~ 
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ 
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~


COPY ~BG1NPCSoA/cre/MISC/7XCRE41.cre~ ~override/7XCRE41.cre~
SAY NAME1 @344
SAY NAME2 @344


COPY ~BG1NPCSoA/cre/MISC/7XCRE42.cre~ ~override/7XCRE42.cre~
SAY NAME1 @345
SAY NAME2 @345

COPY ~BG1NPCSoA/store/BG1NPC3.sto~ ~override~
SAY NAME2 @346



COPY ~BG1NPCSoA/cre/MISC/7XCRE43.cre~ ~override/7XCRE43.cre~
SAY NAME1 @347
SAY NAME2 @347
SAY INITIAL_MEETING ~~ [DWARF03]
  SAY MORALE ~~ 
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ 
  SAY BATTLE_CRY2 ~~ 
  SAY BATTLE_CRY3 ~~ 
  SAY BATTLE_CRY4 ~~ 
  SAY BATTLE_CRY5 ~~ 
  SAY DAMAGE ~~ 
  SAY DYING ~~ 
  SAY HURT ~~ 
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [DWARF02]
  SAY SELECT_COMMON2 ~~ [DWARF04]
  SAY SELECT_COMMON3 ~~ [DWARF01]
  SAY SELECT_COMMON4 ~~ [DWARF03]
  SAY SELECT_COMMON5 ~~ [DWARF02]
  SAY SELECT_COMMON6 ~~ [DWARF04]
  SAY SELECT_ACTION1 ~~ 
  SAY SELECT_ACTION2 ~~ 
  SAY SELECT_ACTION3 ~~ 
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ [DWARF01]
  SAY SELECT_RARE2 ~~ [DWARF03]
  SAY CRITICAL_HIT ~~ 
SAY CRITICAL_MISS ~~ 
SAY TARGET_IMMUNE ~~ 
SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ 
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~ 


COPY ~BG1NPCSoA/cre/Coran-Safana-Chronicles/7XCRE44.cre~ ~override/7XCRE44.cre~
SAY NAME1 @352
SAY NAME2 @352

COPY ~BG1NPCSoA/Items/bg1x23b.itm~ ~Override/bg1x23b.itm~
SAY NAME1 @353
SAY NAME2 @353
SAY UNIDENTIFIED_DESC @353
SAY DESC @353


COPY ~BG1NPCSoA/cre/Coran-Safana-Chronicles/7XCRE45.cre~ ~override/7XCRE45.cre~
SAY NAME1 @354
SAY NAME2 @354
SAY INITIAL_MEETING ~~ [BASIL01]
  SAY MORALE ~~ [BASIL01]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ [BASIL01]
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ [BASIL01]
  SAY BORED ~~ [BASIL01]
  SAY BATTLE_CRY1 ~~ [BASIL02]
  SAY BATTLE_CRY2 ~~ [BASIL01]
  SAY BATTLE_CRY3 ~~ [BASIL03]
  SAY BATTLE_CRY4 ~~ [BASIL02]
  SAY BATTLE_CRY5 ~~ [BASIL03]
  SAY DAMAGE ~~ [BASIL08]
  SAY DYING ~~ [BASIL10]
  SAY HURT ~~ [BASIL09]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [BASIL03]
  SAY SELECT_COMMON2 ~~ [BASIL01]
  SAY SELECT_COMMON3 ~~ [BASIL01]
  SAY SELECT_COMMON4 ~~ [BASIL01]
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ 
  SAY SELECT_ACTION2 ~~ 
  SAY SELECT_ACTION3 ~~ 
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ [BASIL01]
  SAY SELECT_RARE2 ~~ [BASIL01]
  SAY CRITICAL_HIT ~~ [BASIL03]
SAY CRITICAL_MISS ~~ [BASIL02]
SAY TARGET_IMMUNE ~~ [BASIL08]
SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [BASIL03]
  SAY INTERACTION3 ~~ [BASIL08]
  SAY COMPLIMENT1 ~~ [BASIL08]


COPY ~BG1NPCSoA/cre/MISC/7Xcre46.cre~ ~override/7Xcre46.cre~
SAY NAME1 @361
SAY NAME2 @361

COMPILE ~BG1NPCSoA/scripts/MISC/Firebead.baf~

COPY ~BG1NPCSoA/store/BG1NPC4.sto~ ~override~
SAY NAME2 @362


COPY ~BG1NPCSoA/Items/BGSX01.itm~ ~Override/BGSX01.itm~
SAY NAME1 @363
SAY NAME2 @364
SAY UNIDENTIFIED_DESC @363
SAY DESC @365


COPY ~BG1NPCSoA/Items/BGSX02.itm~ ~Override/BGSX02.itm~
SAY NAME1 @366
SAY NAME2 @367
SAY UNIDENTIFIED_DESC @366
SAY DESC @368


COPY ~BG1NPCSoA/Items/BGSX03.itm~ ~Override/BGSX03.itm~
SAY NAME1 @369
SAY NAME2 @370
SAY UNIDENTIFIED_DESC @369
SAY DESC @371


COPY ~BG1NPCSoA/Items/BGSX04.itm~ ~Override/BGSX04.itm~
SAY NAME1 @372
SAY NAME2 @372
SAY UNIDENTIFIED_DESC @372
SAY DESC @373



COPY ~BG1NPCSoA/Items/BGSX05.itm~ ~Override/BGSX05.itm~
SAY NAME1 @245
SAY NAME2 @374
SAY UNIDENTIFIED_DESC @245
SAY DESC @375
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "scimitar" END


COPY ~BG1NPCSoA/Items/BGSX06.itm~ ~Override/BGSX06.itm~
SAY NAME1 @376
SAY NAME2 @376
SAY UNIDENTIFIED_DESC @376
SAY DESC @377


COPY ~BG1NPCSoA/Items/BGSX07.itm~ ~Override/BGSX07.itm~
SAY NAME1 @378
SAY NAME2 @378
SAY UNIDENTIFIED_DESC @378
SAY DESC @379


COPY ~BG1NPCSoA/Items/BGSX08.itm~ ~Override/BGSX08.itm~
SAY NAME1 @380
SAY NAME2 @380
SAY UNIDENTIFIED_DESC @380
SAY DESC @381
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "axe" END

COPY ~BG1NPCSoA/Items/BGSX16.itm~ ~Override/BGSX16.itm~
SAY NAME1 @382
SAY NAME2 @383
SAY UNIDENTIFIED_DESC @382
SAY DESC @384


COPY ~BG1NPCSoA/Items/BGSX17.itm~ ~Override/BGSX17.itm~
SAY NAME1 @385
SAY NAME2 @385
SAY UNIDENTIFIED_DESC @385
SAY DESC @386



COPY ~BG1NPCSoA/Items/BGSX18.itm~ ~Override/BGSX18.itm~
SAY NAME1 @387
SAY NAME2 @387
SAY UNIDENTIFIED_DESC @387
SAY DESC @387


COPY ~BG1NPCSoA/Items/BGSX19.itm~ ~Override/BGSX19.itm~
SAY NAME1 @388
SAY NAME2 @388
SAY UNIDENTIFIED_DESC @388
SAY DESC @388


COPY ~BG1NPCSoA/cre/MISC/7Xcre47.cre~ ~override/7Xcre47.cre~
SAY NAME1 @389
SAY NAME2 @389

COPY ~BG1NPCSoA/cre/MISC/7Xcre48.cre~ ~override/7Xcre48.cre~
SAY NAME1 @390
SAY NAME2 @390

COPY ~BG1NPCSoA/cre/MISC/7Xcre49.cre~ ~override/7Xcre49.cre~
SAY NAME1 @391
SAY NAME2 @391

COPY ~BG1NPCSoA/cre/MISC/7Xcre50.cre~ ~override/7Xcre50.cre~
SAY NAME1 @392
SAY NAME2 @392

COPY ~BG1NPCSoA/cre/MISC/7Xcre51.cre~ ~override/7Xcre51.cre~
SAY NAME1 @393
SAY NAME2 @393


COPY ~BG1NPCSoA/cre/MISC/7Xcre52.cre~ ~override/7Xcre52.cre~
SAY NAME1 @394
SAY NAME2 @394

COPY ~BG1NPCSoA/cre/MISC/7Xcre53.cre~ ~override/7Xcre53.cre~
SAY NAME1 @395
SAY NAME2 @396
SAY INITIAL_MEETING ~~ [arena1]
  SAY MORALE ~~ [arena1]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ [arena1]
  SAY BATTLE_CRY2 ~~ [arena1]
  SAY BATTLE_CRY3 ~~ [arena1]
  SAY BATTLE_CRY4 ~~ [arena1]
  SAY BATTLE_CRY5 ~~ [arena1]
  SAY DAMAGE ~~ [arena1]
  SAY DYING ~~ [arena2]
  SAY HURT ~~ [arena1]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [arena1]
  SAY SELECT_COMMON2 ~~ [arena2]
  SAY SELECT_COMMON3 ~~ [arena1]
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ [arena1]
  SAY SELECT_ACTION2 ~~ [arena1]
  SAY SELECT_ACTION3 ~~ [arena2]
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ [arena2]
  SAY SELECT_RARE2 ~~ [arena2]
  SAY CRITICAL_HIT ~~ [arena2]
  SAY CRITICAL_MISS ~~ [arena1]
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [arena1]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~


COPY ~BG1NPCSoA/cre/MISC/7Xcre54.cre~ ~override/7Xcre54.cre~
SAY NAME1 @397
SAY NAME2 @397
SAY INITIAL_MEETING ~~ [arena1]
  SAY MORALE ~~ [arena1]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ [arena1]
  SAY BATTLE_CRY2 ~~ [arena1]
  SAY BATTLE_CRY3 ~~ [arena1]
  SAY BATTLE_CRY4 ~~ [arena1]
  SAY BATTLE_CRY5 ~~ [arena1]
  SAY DAMAGE ~~ [arena1]
  SAY DYING ~~ [arena2]
  SAY HURT ~~ [arena1]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [arena1]
  SAY SELECT_COMMON2 ~~ [arena2]
  SAY SELECT_COMMON3 ~~ [arena1]
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ [arena1]
  SAY SELECT_ACTION2 ~~ [arena1]
  SAY SELECT_ACTION3 ~~ [arena2]
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ [arena2]
  SAY SELECT_RARE2 ~~ [arena2]
  SAY CRITICAL_HIT ~~ [arena2]
  SAY CRITICAL_MISS ~~ [arena1]
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [arena1]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~


COPY ~BG1NPCSoA/cre/MISC/7Xcre55.cre~ ~override/7Xcre55.cre~
SAY NAME1 @398
SAY NAME2 @398
SAY INITIAL_MEETING ~~ [arena1]
  SAY MORALE ~~ [arena1]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ [arena1]
  SAY BATTLE_CRY2 ~~ [arena1]
  SAY BATTLE_CRY3 ~~ [arena1]
  SAY BATTLE_CRY4 ~~ [arena1]
  SAY BATTLE_CRY5 ~~ [arena1]
  SAY DAMAGE ~~ [arena1]
  SAY DYING ~~ [arena2]
  SAY HURT ~~ [arena1]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [arena1]
  SAY SELECT_COMMON2 ~~ [arena2]
  SAY SELECT_COMMON3 ~~ [arena1]
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ [arena1]
  SAY SELECT_ACTION2 ~~ [arena1]
  SAY SELECT_ACTION3 ~~ [arena2]
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ [arena2]
  SAY SELECT_RARE2 ~~ [arena2]
  SAY CRITICAL_HIT ~~ [arena2]
  SAY CRITICAL_MISS ~~ [arena1]
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [arena1]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~

COPY ~BG1NPCSoA/cre/MISC/7Xcre56.cre~ ~override/7Xcre56.cre~
SAY NAME1 @399
SAY NAME2 @399
SAY INITIAL_MEETING ~~ [arena1]
  SAY MORALE ~~ [arena1]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ [arena1]
  SAY BATTLE_CRY2 ~~ [arena1]
  SAY BATTLE_CRY3 ~~ [arena1]
  SAY BATTLE_CRY4 ~~ [arena1]
  SAY BATTLE_CRY5 ~~ [arena1]
  SAY DAMAGE ~~ [arena1]
  SAY DYING ~~ [arena2]
  SAY HURT ~~ [arena1]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [arena1]
  SAY SELECT_COMMON2 ~~ [arena2]
  SAY SELECT_COMMON3 ~~ [arena1]
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ [arena1]
  SAY SELECT_ACTION2 ~~ [arena1]
  SAY SELECT_ACTION3 ~~ [arena2]
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ [arena2]
  SAY SELECT_RARE2 ~~ [arena2]
  SAY CRITICAL_HIT ~~ [arena2]
  SAY CRITICAL_MISS ~~ [arena1]
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [arena1]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~




COPY ~BG1NPCSoA/cre/MISC/7Xcre57.cre~ ~override/7Xcre57.cre~
SAY NAME1 @400
SAY NAME2 @400
SAY INITIAL_MEETING ~~ [arena1]
  SAY MORALE ~~ [arena1]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ [arena1]
  SAY BATTLE_CRY2 ~~ [arena1]
  SAY BATTLE_CRY3 ~~ [arena1]
  SAY BATTLE_CRY4 ~~ [arena1]
  SAY BATTLE_CRY5 ~~ [arena1]
  SAY DAMAGE ~~ [arena1]
  SAY DYING ~~ [arena2]
  SAY HURT ~~ [arena1]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [arena1]
  SAY SELECT_COMMON2 ~~ [arena2]
  SAY SELECT_COMMON3 ~~ [arena1]
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ [arena1]
  SAY SELECT_ACTION2 ~~ [arena1]
  SAY SELECT_ACTION3 ~~ [arena2]
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ [arena2]
  SAY SELECT_RARE2 ~~ [arena2]
  SAY CRITICAL_HIT ~~ [arena2]
  SAY CRITICAL_MISS ~~ [arena1]
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [arena1]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~


COPY ~BG1NPCSoA/cre/MISC/7Xcre58.cre~ ~override/7Xcre58.cre~
SAY NAME1 @401
SAY NAME2 @401
SAY INITIAL_MEETING ~~ [arena1]
  SAY MORALE ~~ [arena1]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ [arena1]
  SAY BATTLE_CRY2 ~~ [arena1]
  SAY BATTLE_CRY3 ~~ [arena1]
  SAY BATTLE_CRY4 ~~ [arena1]
  SAY BATTLE_CRY5 ~~ [arena1]
  SAY DAMAGE ~~ [arena1]
  SAY DYING ~~ [arena2]
  SAY HURT ~~ [arena1]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [arena1]
  SAY SELECT_COMMON2 ~~ [arena2]
  SAY SELECT_COMMON3 ~~ [arena1]
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ [arena1]
  SAY SELECT_ACTION2 ~~ [arena1]
  SAY SELECT_ACTION3 ~~ [arena2]
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ [arena2]
  SAY SELECT_RARE2 ~~ [arena2]
  SAY CRITICAL_HIT ~~ [arena2]
  SAY CRITICAL_MISS ~~ [arena1]
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [arena1]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~


COPY ~BG1NPCSoA/cre/MISC/7Xcre59.cre~ ~override/7Xcre59.cre~
SAY NAME1 @402
SAY NAME2 @402
SAY INITIAL_MEETING ~~ [arena1]
  SAY MORALE ~~ [arena1]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ [arena1]
  SAY BATTLE_CRY2 ~~ [arena1]
  SAY BATTLE_CRY3 ~~ [arena1]
  SAY BATTLE_CRY4 ~~ [arena1]
  SAY BATTLE_CRY5 ~~ [arena1]
  SAY DAMAGE ~~ [arena1]
  SAY DYING ~~ [arena2]
  SAY HURT ~~ [arena1]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [arena1]
  SAY SELECT_COMMON2 ~~ [arena2]
  SAY SELECT_COMMON3 ~~ [arena1]
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ [arena1]
  SAY SELECT_ACTION2 ~~ [arena1]
  SAY SELECT_ACTION3 ~~ [arena2]
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ [arena2]
  SAY SELECT_RARE2 ~~ [arena2]
  SAY CRITICAL_HIT ~~ [arena2]
  SAY CRITICAL_MISS ~~ [arena1]
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [arena1]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~

COPY ~BG1NPCSoA/cre/MISC/7Xcre60.cre~ ~override/7Xcre60.cre~
SAY NAME1 @403
SAY NAME2 @403
SAY INITIAL_MEETING ~~ [arena1]
  SAY MORALE ~~ [arena1]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ [arena1]
  SAY BATTLE_CRY2 ~~ [arena1]
  SAY BATTLE_CRY3 ~~ [arena1]
  SAY BATTLE_CRY4 ~~ [arena1]
  SAY BATTLE_CRY5 ~~ [arena1]
  SAY DAMAGE ~~ [arena1]
  SAY DYING ~~ [arena2]
  SAY HURT ~~ [arena1]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [arena1]
  SAY SELECT_COMMON2 ~~ [arena2]
  SAY SELECT_COMMON3 ~~ [arena1]
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ [arena1]
  SAY SELECT_ACTION2 ~~ [arena1]
  SAY SELECT_ACTION3 ~~ [arena2]
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ [arena2]
  SAY SELECT_RARE2 ~~ [arena2]
  SAY CRITICAL_HIT ~~ [arena2]
  SAY CRITICAL_MISS ~~ [arena1]
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [arena1]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~



COPY ~BG1NPCSoA/cre/MISC/7Xcre61.cre~ ~override/7Xcre61.cre~
SAY NAME1 @404
SAY NAME2 @404


COPY ~BG1NPCSoA/store/BG1NPC6.sto~ ~override~
SAY NAME2 @405



COPY ~BG1NPCSoA/store/BG1NPC9.sto~ ~override~
SAY NAME2 @406


COPY ~BG1NPCSoA/Items/DEPO211.itm~ ~Override/DEPO211.itm~
SAY NAME1 @242
SAY NAME2 @407
SAY UNIDENTIFIED_DESC @242
SAY DESC @408

COPY ~BG1NPCSoA/Items/DEPO189.itm~ ~Override/DEPO189.itm~
SAY NAME1 @366
SAY NAME2 @409
SAY UNIDENTIFIED_DESC @366
SAY DESC @410

COPY ~BG1NPCSoA/Items/DEPO135.itm~ ~Override/DEPO135.itm~
SAY NAME1 @411
SAY NAME2 @412
SAY UNIDENTIFIED_DESC @412
SAY DESC @413



COPY ~BG1NPCSoA/Items/DEPO212.itm~ ~Override/DEPO212.itm~
SAY NAME1 @414
SAY NAME2 @415
SAY UNIDENTIFIED_DESC @414
SAY DESC @416


COPY ~BG1NPCSoA/cre/MISC/7Xcre81.cre~ ~override/7Xcre81.cre~
SAY NAME1 @417
SAY NAME2 @417

COPY ~BG1NPCSoA/cre/MISC/7Xcre82.cre~ ~override/7Xcre82.cre~
SAY NAME1 @418
SAY NAME2 @418

COPY ~BG1NPCSoA/cre/MISC/7Xcre83.cre~ ~override/7Xcre83.cre~
SAY NAME1 @419
SAY NAME2 @419

COPY ~BG1NPCSoA/cre/MISC/7Xcre84.cre~ ~override/7Xcre84.cre~
SAY NAME1 @420
SAY NAME2 @420

COPY ~BG1NPCSoA/cre/MISC/7Xcre85.cre~ ~override/7Xcre85.cre~
SAY NAME1 @423
SAY NAME2 @423


COPY ~BG1NPCSoA/cre/MISC/7Xcre86.cre~ ~override/7Xcre86.cre~
SAY NAME1 @424
SAY NAME2 @424

COPY ~BG1NPCSoA/cre/MISC/7Xcre87.cre~ ~override/7Xcre87.cre~
SAY NAME1 @425
SAY NAME2 @425



COPY ~BG1NPCSoA/Items/DEPO284.itm~ ~Override/DEPO284.itm~
SAY NAME1 @429
SAY NAME2 @429
SAY UNIDENTIFIED_DESC @429
SAY DESC @429

COPY ~BG1NPCSoA/Spells/squirrel.SPL~ ~Override/squirrel.SPL~
SAY NAME1 @429
 SAY UNIDENTIFIED_DESC @430

COPY ~BG1NPCSoA/Items/BGSX21.itm~ ~Override/BGSX21.itm~
SAY NAME1 @431
SAY NAME2 @431
SAY UNIDENTIFIED_DESC @431
SAY DESC @432

COPY ~BG1NPCSoA/Spells/calguar.SPL~ ~Override/calguar.SPL~
SAY NAME1  @431
 SAY UNIDENTIFIED_DESC @432



COPY ~BG1NPCSoA/Items/BGSX22.itm~ ~Override/BGSX22.itm~
SAY NAME1 @433
SAY NAME2 @433
SAY UNIDENTIFIED_DESC @433
SAY DESC @434


COPY ~BG1NPCSoA/Items/BGSX23.itm~ ~Override/BGSX23.itm~
SAY NAME1 @435
SAY NAME2 @435
SAY UNIDENTIFIED_DESC @435
SAY DESC @435


COPY ~BG1NPCSoA/Items/BGSX24.itm~ ~Override/BGSX24.itm~
SAY NAME1 @436
SAY NAME2 @436
SAY UNIDENTIFIED_DESC @436
SAY DESC @436

COPY ~BG1NPCSoA/Items/BGSX25.itm~ ~Override/BGSX25.itm~
SAY NAME1 @437
SAY NAME2 @437
SAY UNIDENTIFIED_DESC @437
SAY DESC @437


COPY ~BG1NPCSoA/Items/BGSX26.itm~ ~Override/BGSX26.itm~
SAY NAME1 @438
SAY NAME2 @438
SAY UNIDENTIFIED_DESC @438
SAY DESC @438


COPY ~BG1NPCSoA/Items/BGSX27.itm~ ~Override/BGSX27.itm~
SAY NAME1 @439
SAY NAME2 @439
SAY UNIDENTIFIED_DESC @439
SAY DESC @439


COPY ~BG1NPCSoA/Items/BGSX28.itm~ ~Override/BGSX28.itm~
SAY NAME1 @440
SAY NAME2 @440
SAY UNIDENTIFIED_DESC @440
SAY DESC @440


COPY ~BG1NPCSoA/Items/BGSX29.itm~ ~Override/BGSX29.itm~
SAY NAME1 @441
SAY NAME2 @441
SAY UNIDENTIFIED_DESC @441
SAY DESC @441


COPY ~BG1NPCSoA/Items/BGSX30.itm~ ~Override/BGSX30.itm~
SAY NAME1 @442
SAY NAME2 @442
SAY UNIDENTIFIED_DESC @442
SAY DESC @442


COPY ~BG1NPCSoA/Items/BGSX31.itm~ ~Override/BGSX31.itm~
SAY NAME1 @443
SAY NAME2 @443
SAY UNIDENTIFIED_DESC @443
SAY DESC @444


COPY ~BG1NPCSoA/Items/BGSX32.itm~ ~Override/BGSX32.itm~
SAY NAME1 @445
SAY NAME2 @445
SAY UNIDENTIFIED_DESC @445
SAY DESC @445


COPY ~BG1NPCSoA/Items/MISC5K.itm~ ~Override/MISC5K.itm~
SAY NAME1 @446
SAY NAME2 @446
SAY UNIDENTIFIED_DESC @446
SAY DESC @447


COPY ~BG1NPCSoA/Items/BGSX33.itm~ ~Override/BGSX33.itm~
SAY NAME1 @448
SAY NAME2 @448
SAY UNIDENTIFIED_DESC @448
SAY DESC @448


COPY ~BG1NPCSoA/Items/BGSX34.itm~ ~Override/BGSX34.itm~
SAY NAME1 @449
SAY NAME2 @449
SAY UNIDENTIFIED_DESC @449
SAY DESC @450


COPY ~BG1NPCSoA/Items/BGSX35.itm~ ~Override/BGSX35.itm~
SAY NAME1 @451
SAY NAME2 @451
SAY UNIDENTIFIED_DESC @451
SAY DESC @452


COPY ~BG1NPCSoA/Items/BGSX36.itm~ ~Override/BGSX36.itm~
SAY NAME1 @453
SAY NAME2 @453
SAY UNIDENTIFIED_DESC @453
SAY DESC @453
	

COPY ~BG1NPCSoA/Items/BGSX37.itm~ ~Override/BGSX37.itm~
SAY NAME1 @454
SAY NAME2 @455
SAY UNIDENTIFIED_DESC @454
SAY DESC @454


COPY ~BG1NPCSoA/Items/BGSX38.itm~ ~Override/BGSX38.itm~
SAY NAME1 @456
SAY NAME2 @456
SAY UNIDENTIFIED_DESC @456
SAY DESC @456

COPY ~BG1NPCSoA/Items/BGSX39.itm~ ~Override/BGSX39.itm~
SAY NAME1 @457
SAY NAME2 @457
SAY UNIDENTIFIED_DESC @457
SAY DESC @458


COPY ~BG1NPCSoA/Items/BGSX40.itm~ ~Override/BGSX40.itm~
SAY NAME1 @459
SAY NAME2 @459
SAY UNIDENTIFIED_DESC @459
SAY DESC @459

COPY ~BG1NPCSoA/Items/BGSX41.itm~ ~Override/BGSX41.itm~
SAY NAME1 @460
SAY NAME2 @460
SAY UNIDENTIFIED_DESC @460
SAY DESC @460


COPY ~BG1NPCSoA/Items/BGSX42.itm~ ~override~
 SAY NAME1 @461
 SAY NAME2 @461
 SAY UNIDENTIFIED_DESC @461 
 SAY DESC @461 

COPY ~BG1NPCSoA/Spells/SUMDRAG.spl~ ~override~
 SAY NAME1 @461
 SAY UNIDENTIFIED_DESC @461
 
COPY ~BG1NPCSoA/eff/SUMDRAG.eff~ ~override~

COPY ~BG1NPCSoA/Items/BGSX43.itm~ ~override~
 SAY NAME1 @462
 SAY NAME2 @462
 SAY UNIDENTIFIED_DESC @462 
 SAY DESC @1726 

COPY ~BG1NPCSoA/Items/BGSX44.itm~ ~override~
 SAY NAME1 @463
 SAY NAME2 @463
 SAY UNIDENTIFIED_DESC @463 
 SAY DESC @463 

COPY ~BG1NPCSoA/Items/BGSX45.itm~ ~override~
 SAY NAME1 @464
 SAY NAME2 @464
 SAY UNIDENTIFIED_DESC @464 
 SAY DESC @464 


COPY ~BG1NPCSoA/Items/BGSX46.itm~ ~override~
 SAY NAME1 @465
 SAY NAME2 @465
 SAY UNIDENTIFIED_DESC @465 
 SAY DESC @465


COPY ~BG1NPCSoA/Items/BGSX47.itm~ ~override~
 SAY NAME1 @466
 SAY NAME2 @466
 SAY UNIDENTIFIED_DESC @466 
 SAY DESC @466


COPY ~BG1NPCSoA/Items/bgsx48.itm~ ~Override/bgsx48.itm~
 SAY NAME1 @467
 SAY NAME2 @467
 SAY UNIDENTIFIED_DESC @467 
 SAY DESC @467


APPEND ~ItemDial.2da~ ~bgsx48    5689    bgsx48~


COPY ~BG1NPCSoA/Items/bgsx49.itm~ ~Override/bgsx49.itm~
 SAY NAME1 @468
 SAY NAME2 @468
 SAY UNIDENTIFIED_DESC @468 
 SAY DESC @468

COPY ~BG1NPCSoA/Items/bgsx50.itm~ ~Override/bgsx50.itm~
 SAY NAME1 @469
 SAY NAME2 @469
 SAY UNIDENTIFIED_DESC @469 
 SAY DESC @469

COPY ~BG1NPCSoA/Items/bgsx51.itm~ ~Override/bgsx51.itm~
 SAY NAME1 @470
 SAY NAME2 @470
 SAY UNIDENTIFIED_DESC @470 
 SAY DESC @470

COPY ~BG1NPCSoA/Items/bgsx52.itm~ ~Override/bgsx52.itm~
 SAY NAME1 @471
 SAY NAME2 @471
 SAY UNIDENTIFIED_DESC @471 
 SAY DESC @472

COPY ~BG1NPCSoA/Items/bgsx53.itm~ ~Override/bgsx53.itm~
 SAY NAME1 @473
 SAY NAME2 @473
 SAY UNIDENTIFIED_DESC @473 
 SAY DESC @474


COPY ~BG1NPCSoA/Items/bgsx54.itm~ ~Override/bgsx54.itm~
 SAY NAME1 @475
 SAY NAME2 @475
 SAY UNIDENTIFIED_DESC @475 
 SAY DESC @475

COPY ~BG1NPCSoA/Items/bgsx55.itm~ ~Override/bgsx55.itm~
 SAY NAME1 @476
 SAY NAME2 @476
 SAY UNIDENTIFIED_DESC @476 
 SAY DESC @476

COPY ~BG1NPCSoA/Items/bgsx56.itm~ ~Override/bgsx56.itm~
 SAY NAME1 @477
 SAY NAME2 @477
 SAY UNIDENTIFIED_DESC @477 
 SAY DESC @478

COPY ~BG1NPCSoA/Items/bgsx57.itm~ ~Override/bgsx57.itm~
 SAY NAME1 @479
 SAY NAME2 @479
 SAY UNIDENTIFIED_DESC @479 
 SAY DESC @480

COPY ~BG1NPCSoA/Items/bgsx58.itm~ ~Override/bgsx58.itm~
 SAY NAME1 @481
 SAY NAME2 @481
 SAY UNIDENTIFIED_DESC @481 
 SAY DESC @481

COPY ~BG1NPCSoA/Items/bgsx59.itm~ ~Override/bgsx59.itm~
 SAY NAME1 @482
 SAY NAME2 @482
 SAY UNIDENTIFIED_DESC @482 
 SAY DESC @482

COPY ~BG1NPCSoA/Items/bgsx60.itm~ ~Override/bgsx60.itm~
 SAY NAME1 @483
 SAY NAME2 @483
 SAY UNIDENTIFIED_DESC @483 
 SAY DESC @484


COPY ~BG1NPCSoA/Items/bgsx61.itm~ ~Override/bgsx61.itm~
 SAY NAME1 @485
 SAY NAME2 @485
 SAY UNIDENTIFIED_DESC @485 
 SAY DESC @485

COPY ~BG1NPCSoA/Items/bgsx62.itm~ ~Override/bgsx62.itm~
 SAY NAME1 @486
 SAY NAME2 @486
 SAY UNIDENTIFIED_DESC @486 
 SAY DESC @487
 LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "axe" END

COPY ~BG1NPCSoA/Items/bgsx63.itm~ ~Override/bgsx63.itm~
 SAY NAME1 @488
 SAY NAME2 @488
 SAY UNIDENTIFIED_DESC @488 
 SAY DESC @488

COPY ~BG1NPCSoA/Items/TOB7X1.itm~ ~Override/TOB7X1.itm~
SAY NAME1 @489
SAY NAME2 @489
SAY UNIDENTIFIED_DESC @489
SAY DESC @489

COPY ~BG1NPCSoA/Spells/ASTRO.SPL~ ~Override/ASTRO.SPL~
SAY NAME1  @489
 SAY UNIDENTIFIED_DESC @490

COPY ~BG1NPCSoA/Spells/WraithF.SPL~ ~Override/WraithF.SPL~
SAY NAME1  @491
 SAY UNIDENTIFIED_DESC @492

COPY ~BG1NPCSoA/Items/TOB7X3.itm~ ~Override/TOB7X3.itm~
SAY NAME1 @491
SAY NAME2 @491
SAY UNIDENTIFIED_DESC @491
SAY DESC @491 

COPY ~BG1NPCSoA/Items/bgsx64.itm~ ~Override/bgsx64.itm~
 SAY NAME1 @493
 SAY NAME2 @493
 SAY UNIDENTIFIED_DESC @493 
 SAY DESC @494

COPY ~BG1NPCSoA/Items/bgsx65.itm~ ~Override/bgsx65.itm~
 SAY NAME1 @495
 SAY NAME2 @495
 SAY UNIDENTIFIED_DESC @495 
 SAY DESC @495

COPY ~BG1NPCSoA/Spells/GOLEMS.SPL~ ~Override/GOLEMS.SPL~
SAY NAME1  @496
 SAY UNIDENTIFIED_DESC @497

COPY ~BG1NPCSoA/Items/bgsx66.itm~ ~Override/bgsx66.itm~
SAY NAME1 @496
SAY NAME2 @496
SAY UNIDENTIFIED_DESC @496
SAY DESC @496 

COPY ~BG1NPCSoA/Items/bgsx67.itm~ ~Override/bgsx67.itm~
SAY NAME1 @498
SAY NAME2 @498
SAY UNIDENTIFIED_DESC @498
SAY DESC @499 


COPY ~BG1NPCSoA/Spells/SPPO401.SPL~ ~Override/SPPO401.SPL~
SAY NAME1  @498
 SAY UNIDENTIFIED_DESC @500


COPY ~BG1NPCSoA/scripts/MISC/POpocket.bcs~ ~override/POpocket.bcs~

COPY ~BG1NPCSoA/Spells/CAGE.SPL~ ~Override/CAGE.SPL~
SAY NAME1  @501
 SAY UNIDENTIFIED_DESC @502


COPY ~BG1NPCSoA/Items/bgsx68.itm~ ~Override/bgsx68.itm~
SAY NAME1 @501
SAY NAME2 @501
SAY UNIDENTIFIED_DESC @501
SAY DESC @502 

COPY ~BG1NPCSoA/Items/bgsx69.itm~ ~Override/bgsx69.itm~
SAY NAME1 @503
SAY NAME2 @503
SAY UNIDENTIFIED_DESC @503
SAY DESC @503

COPY ~BG1NPCSoA/Spells/SEXFLIP.SPL~ ~Override/SEXFLIP.SPL~
SAY NAME1  @503
 SAY UNIDENTIFIED_DESC @503

COPY ~BG1NPCSoA/Items/bgsx70.itm~ ~Override/bgsx70.itm~
SAY NAME1 @504
SAY NAME2 @504
SAY UNIDENTIFIED_DESC @504
SAY DESC @504

COPY ~BG1NPCSoA/Spells/column.SPL~ ~Override/column.SPL~
SAY NAME1  @504
 SAY UNIDENTIFIED_DESC @505

COPY ~BG1NPCSoA/Items/bgsx71.itm~ ~Override/bgsx71.itm~
SAY NAME1 @506
SAY NAME2 @506
SAY UNIDENTIFIED_DESC @506
SAY DESC @507

COPY ~BG1NPCSoA/Spells/CUndead.SPL~ ~Override/CUndead.SPL~
SAY NAME1  @506
 SAY UNIDENTIFIED_DESC @507

COPY ~BG1NPCSoA/Spells/FaerieF.SPL~ ~Override/FaerieF.SPL~
SAY NAME1  @508
 SAY UNIDENTIFIED_DESC @509

COPY ~BG1NPCSoA/Spells/BLACK.SPL~ ~Override/BLACK.SPL~
SAY NAME1  @510
 SAY UNIDENTIFIED_DESC @510


COPY ~BG1NPCSoA/Items/bgsx72.itm~ ~Override/bgsx72.itm~
SAY NAME1 @510
SAY NAME2 @510
SAY UNIDENTIFIED_DESC @510
SAY DESC @511

COPY ~BG1NPCSoA/Items/bgsx73.itm~ ~Override/bgsx73.itm~
SAY NAME1 @512
SAY NAME2 @512
SAY UNIDENTIFIED_DESC @512
SAY DESC @512

COPY ~BG1NPCSoA/Spells/LIQUEF.SPL~ ~Override/LIQUEF.SPL~
SAY NAME1  @512
 SAY UNIDENTIFIED_DESC @513

COPY ~BG1NPCSoA/Items/bgsx74.itm~ ~Override/bgsx74.itm~
SAY NAME1 @514
SAY NAME2 @514
SAY UNIDENTIFIED_DESC @514
SAY DESC @515

COPY ~BG1NPCSoA/Items/bgsx75.itm~ ~Override/bgsx75.itm~
SAY NAME1 @516
SAY NAME2 @516
SAY UNIDENTIFIED_DESC @516
SAY DESC @516

COPY ~BG1NPCSoA/cre/MISC/FLESH.cre~ ~override/FLESH.cre~
SAY NAME1 @517
SAY NAME2 @517

COPY ~BG1NPCSoA/Spells/FLESH.SPL~ ~Override/FLESH.SPL~
SAY NAME1  @516
 SAY UNIDENTIFIED_DESC @516

COPY ~BG1NPCSoA/Items/bgsx76.itm~ ~Override/bgsx76.itm~
SAY NAME1 @518
SAY NAME2 @518
SAY UNIDENTIFIED_DESC @518
SAY DESC @518

COPY ~BG1NPCSoA/Items/bgsx77.itm~ ~Override/bgsx77.itm~
SAY NAME1 @519
SAY NAME2 @519
SAY UNIDENTIFIED_DESC @519
SAY DESC @519

COPY ~BG1NPCSoA/Items/bgsx78.itm~ ~Override/bgsx78.itm~
SAY NAME1 @520
SAY NAME2 @520
SAY UNIDENTIFIED_DESC @520
SAY DESC @520

COPY ~BG1NPCSoA/Items/bgsx79.itm~ ~Override/bgsx79.itm~
SAY NAME1 @521
SAY NAME2 @521
SAY UNIDENTIFIED_DESC @521
SAY DESC @522

COPY ~BG1NPCSoA/Spells/SPINRAT.SPL~ ~Override/SPINRAT.SPL~
SAY NAME1  @523
 SAY UNIDENTIFIED_DESC @523

COPY ~BG1NPCSoA/cre/MISC/SRAT1.cre~ ~override/SRAT1.cre~
SAY NAME1 @524
SAY NAME2 @524

COPY ~BG1NPCSoA/Items/bgsx81.itm~ ~Override/bgsx81.itm~
SAY NAME1 @527
SAY NAME2 @527
SAY UNIDENTIFIED_DESC @527
SAY DESC @527

COPY ~BG1NPCSoA/Items/bgsx82.itm~ ~Override/bgsx82.itm~
SAY NAME1 @528
SAY NAME2 @528
SAY UNIDENTIFIED_DESC @528
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@529" END

COPY ~BG1NPCSoA/cre/MISC/DANCER.cre~ ~override/DANCER.cre~
SAY NAME1 @528
SAY NAME2 @528

COPY ~BG1NPCSoA/Items/bgsx83.itm~ ~Override/bgsx83.itm~
SAY NAME1 @530
SAY NAME2 @530
SAY UNIDENTIFIED_DESC @530
SAY DESC @531

COPY ~BG1NPCSoA/Spells/Whirly.SPL~ ~Override/Whirly.SPL~
SAY NAME1  @530
 SAY UNIDENTIFIED_DESC @531


COPY ~BG1NPCSoA/Items/bgsx84.itm~ ~Override/bgsx84.itm~
SAY NAME1 @532
SAY NAME2 @532
SAY UNIDENTIFIED_DESC @532
SAY DESC @533

COPY ~BG1NPCSoA/Spells/implode.SPL~ ~Override/implode.SPL~
SAY NAME1  @532
 SAY UNIDENTIFIED_DESC @534

COPY ~BG1NPCSoA/Items/bgsx85.itm~ ~Override/bgsx85.itm~
SAY NAME1 @535
SAY NAME2 @535
SAY UNIDENTIFIED_DESC @535
SAY DESC @535

COPY ~BG1NPCSoA/Spells/LWTOWNP.SPL~ ~Override/LWTOWNP.SPL~
SAY NAME1  @535
 SAY UNIDENTIFIED_DESC @535 

COPY ~BG1NPCSoA/cre/MISC/LWTOWNP.cre~ ~override/LWTOWNP.cre~
SAY NAME1 @536
SAY NAME2 @536

COMPILE ~BG1NPCSoA/dialogues/MISC/lwtownp.d~ 
COPY ~BG1NPCSoA/scripts/MISC/lwtownp.bcs~ ~override/lwtownp.bcs~


COPY ~BG1NPCSoA/Items/bgsx86.itm~ ~Override/bgsx86.itm~
SAY NAME1 @537
SAY NAME2 @537
SAY UNIDENTIFIED_DESC @537
SAY DESC @537

COPY ~BG1NPCSoA/Spells/mblank.SPL~ ~Override/mblank.SPL~
SAY NAME1  @537
 SAY UNIDENTIFIED_DESC @538


COPY ~BG1NPCSoA/Items/bgsx87.itm~ ~Override/bgsx87.itm~
SAY NAME1 @539
SAY NAME2 @539
SAY UNIDENTIFIED_DESC @539
SAY DESC @540

COPY ~BG1NPCSoA/Spells/DSKINSIL.SPL~ ~Override/DSKINSIL.SPL~
SAY NAME1  @539
 SAY UNIDENTIFIED_DESC @540 

COPY ~BG1NPCSoA/Items/bgsx88.itm~ ~Override/bgsx88.itm~
SAY NAME1 @541
SAY NAME2 @541
SAY UNIDENTIFIED_DESC @541
SAY DESC @542

COPY ~BG1NPCSoA/Spells/zap.SPL~ ~Override/zap.SPL~
SAY NAME1  @541
 SAY UNIDENTIFIED_DESC @542 

COPY ~BG1NPCSoA/Items/bgsx89.itm~ ~Override/bgsx89.itm~
SAY NAME1 @543
SAY NAME2 @543
SAY UNIDENTIFIED_DESC @543
SAY DESC @543

COPY ~BG1NPCSoA/Spells/SUICIDE.SPL~ ~Override/SUICIDE.SPL~
SAY NAME1  @543
 SAY UNIDENTIFIED_DESC @544

COPY ~BG1NPCSoA/Items/bgsx90.itm~ ~Override/bgsx90.itm~
SAY NAME1 @545
SAY NAME2 @545
SAY UNIDENTIFIED_DESC @545
SAY DESC @545

COPY ~BG1NPCSoA/Spells/COMET.SPL~ ~Override/COMET.SPL~
SAY NAME1  @545
 SAY UNIDENTIFIED_DESC @546


COPY ~BG1NPCSoA/Items/bgsx91.itm~ ~Override/bgsx91.itm~
SAY NAME1 @547
SAY NAME2 @547
SAY UNIDENTIFIED_DESC @547
SAY DESC @547

COPY ~BG1NPCSoA/Items/bgsx92.itm~ ~Override/bgsx92.itm~
SAY NAME1 @548
SAY NAME2 @548
SAY UNIDENTIFIED_DESC @548
SAY DESC @548


COPY ~BG1NPCSoA/Items/bgsx93.itm~ ~Override/bgsx93.itm~
SAY NAME1 @549
SAY NAME2 @549
SAY UNIDENTIFIED_DESC @549
SAY DESC @550

COPY ~BG1NPCSoA/Spells/gravwell.SPL~ ~Override/gravwell.SPL~
SAY NAME1  @549
 SAY UNIDENTIFIED_DESC @550


COPY ~BG1NPCSoA/Items/bgsx94.itm~ ~Override/bgsx94.itm~
SAY NAME1 @551
SAY NAME2 @551
SAY UNIDENTIFIED_DESC @551
SAY DESC @552


COPY ~BG1NPCSoA/Spells/CATG.SPL~ ~Override/CATG.SPL~
SAY NAME1  @551
 SAY UNIDENTIFIED_DESC @553

COPY ~BG1NPCSoA/Items/bgsx95.itm~ ~Override/bgsx95.itm~
SAY NAME1 @554
SAY NAME2 @554
SAY UNIDENTIFIED_DESC @554
SAY DESC @555


COPY ~BG1NPCSoA/Spells/ILANCE.SPL~ ~Override/ILANCE.SPL~
SAY NAME1  @554
 SAY UNIDENTIFIED_DESC @555


COPY ~BG1NPCSoA/Items/bgsx96.itm~ ~Override/bgsx96.itm~
SAY NAME1 @556
SAY NAME2 @556
SAY UNIDENTIFIED_DESC @556
SAY DESC @557


COPY ~BG1NPCSoA/Spells/MONSTER.SPL~ ~Override/MONSTER.SPL~
SAY NAME1  @556
 SAY UNIDENTIFIED_DESC @557

COPY ~BG1NPCSoA/Items/bgsx97.itm~ ~Override/bgsx97.itm~
SAY NAME1 @558
SAY NAME2 @558
SAY UNIDENTIFIED_DESC @558
SAY DESC @559



COPY ~BG1NPCSoA/Spells/TROLLF.SPL~ ~Override/TROLLF.SPL~
SAY NAME1  @558
 SAY UNIDENTIFIED_DESC @559



COPY ~BG1NPCSoA/Items/bgsx98.itm~ ~Override/bgsx98.itm~
SAY NAME1 @560
SAY NAME2 @560
SAY UNIDENTIFIED_DESC @560
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@561" END

COPY ~BG1NPCSoA/Items/bgsx99.itm~ ~Override/bgsx99.itm~
SAY NAME1 @562
SAY NAME2 @562
SAY UNIDENTIFIED_DESC @562
SAY DESC @562
READ_BYTE 0x21 use
LPF GET_BIT INT_VAR number = use nth_bit = 5 RET bit_value END
PATCH_IF ( NOT bit_value ) BEGIN WRITE_BYTE 0x21 ( use + 32 ) END
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "arrow" END

COPY ~BG1NPCSoA/Items/bgsx100.itm~ ~Override/bgsx100.itm~
SAY NAME1 @563
SAY NAME2 @563
SAY UNIDENTIFIED_DESC @563
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@564" END

COPY ~BG1NPCSoA/Spells/SPIN884.SPL~ ~Override/SPIN884.SPL~
SAY NAME1  @565
 SAY UNIDENTIFIED_DESC @565

COPY ~BG1NPCSoA/Items/bgsx101.itm~ ~Override/bgsx101.itm~
SAY NAME1 @566
SAY NAME2 @567
SAY UNIDENTIFIED_DESC @567
SAY DESC @567

COPY ~BG1NPCSoA/Spells/THUNDER.SPL~ ~Override/THUNDER.SPL~
SAY NAME1  @567
 SAY UNIDENTIFIED_DESC @568

COPY ~BG1NPCSoA/Items/bgsx102.itm~ ~Override/bgsx102.itm~
SAY NAME1 @569
SAY NAME2 @569
SAY UNIDENTIFIED_DESC @569
SAY DESC @569

COPY ~BG1NPCSoA/Items/bgsx103.itm~ ~Override/bgsx103.itm~
SAY NAME1 @570
SAY NAME2 @570
SAY UNIDENTIFIED_DESC @570
SAY DESC @571

COPY ~BG1NPCSoA/Spells/BLORD.SPL~ ~Override/BLORD.SPL~
SAY NAME1  @569
 SAY UNIDENTIFIED_DESC @569

COPY ~BG1NPCSoA/Spells/EVARDBT.SPL~ ~Override/EVARDBT.SPL~
SAY NAME1  @570
 SAY UNIDENTIFIED_DESC @572

COPY ~BG1NPCSoA/Items/bgsx104.itm~ ~Override/bgsx104.itm~
SAY NAME1 @573
SAY NAME2 @573
SAY UNIDENTIFIED_DESC @573
SAY DESC @574

COPY ~BG1NPCSoA/Spells/FOXC.SPL~ ~Override/FOXC.SPL~
SAY NAME1  @573
 SAY UNIDENTIFIED_DESC @575

COPY ~BG1NPCSoA/Items/bgsx105.itm~ ~Override/bgsx105.itm~
SAY NAME1 @576
SAY NAME2 @576
SAY UNIDENTIFIED_DESC @576
SAY DESC @576

COPY ~BG1NPCSoA/Items/bgsx106.itm~ ~Override/bgsx106.itm~
SAY NAME1 @577
SAY NAME2 @577
SAY UNIDENTIFIED_DESC @577
SAY DESC @577

COPY ~BG1NPCSoA/Items/bgsx107.itm~ ~Override/bgsx107.itm~
SAY NAME1 @578
SAY NAME2 @578
SAY UNIDENTIFIED_DESC @578
SAY DESC @578

COPY ~BG1NPCSoA/Items/bgsx108.itm~ ~Override/bgsx108.itm~
SAY NAME1 @579
SAY NAME2 @579
SAY UNIDENTIFIED_DESC @579
SAY DESC @579

COPY ~BG1NPCSoA/Spells/BULLSM.SPL~ ~Override/BULLSM.SPL~
SAY NAME1  @578
 SAY UNIDENTIFIED_DESC @578

COPY ~BG1NPCSoA/Spells/MCHARM.SPL~ ~Override/MCHARM.SPL~
SAY NAME1  @576
 SAY UNIDENTIFIED_DESC @576


COPY ~BG1NPCSoA/Spells/boneskn.SPL~ ~Override/boneskn.SPL~
SAY NAME1  @577
 SAY UNIDENTIFIED_DESC @577


COPY ~BG1NPCSoA/Spells/dragont.SPL~ ~Override/dragont.SPL~
SAY NAME1  @579
 SAY UNIDENTIFIED_DESC @579


COPY ~BG1NPCSoA/Items/bgsx117.itm~ ~Override/bgsx117.itm~
SAY NAME1 @580
SAY NAME2 @580
SAY UNIDENTIFIED_DESC @580
SAY DESC @581

COPY ~BG1NPCSoA/Spells/chamo.SPL~ ~Override/chamo.SPL~
SAY NAME1  @580
 SAY UNIDENTIFIED_DESC @581




COPY ~BG1NPCSoA/Items/BG1IWD0.itm~ ~Override/BG1IWD0.itm~
SAY NAME1 @582
SAY NAME2 @582
SAY UNIDENTIFIED_DESC @582
SAY DESC @583



COPY ~BG1NPCSoA/Spells/SSSIWD.SPL~ ~Override/SSSIWD.SPL~
SAY NAME1  @582
 SAY UNIDENTIFIED_DESC @583


COPY ~BG1NPCSoA/Items/BG1IWDA.itm~ ~Override/BG1IWDA.itm~
SAY NAME1 @584
SAY NAME2 @584
SAY UNIDENTIFIED_DESC @584
SAY DESC @585

COPY ~BG1NPCSoA/Spells/SHOUT.SPL~ ~Override/SHOUT.SPL~
SAY NAME1  @584
 SAY UNIDENTIFIED_DESC @586


COPY ~BG1NPCSoA/Items/BG1IWDB.itm~ ~Override/BG1IWDB.itm~
SAY NAME1 @587
SAY NAME2 @587
SAY UNIDENTIFIED_DESC @587
SAY DESC @588


COPY ~BG1NPCSoA/Spells/BONES.SPL~ ~Override/BONES.SPL~
SAY NAME1  @587
 SAY UNIDENTIFIED_DESC @588


COPY ~BG1NPCSoA/Items/BG1IWDC.itm~ ~Override/BG1IWDC.itm~
SAY NAME1 @589
SAY NAME2 @589
SAY UNIDENTIFIED_DESC @589
SAY DESC @590


COPY ~BG1NPCSoA/Spells/EAGLE.SPL~ ~Override/EAGLE.SPL~
SAY NAME1  @589
 SAY UNIDENTIFIED_DESC @590


COPY ~BG1NPCSoA/Items/BG1IWDd.itm~ ~Override/BG1IWDd.itm~
SAY NAME1 @591
SAY NAME2 @591
SAY UNIDENTIFIED_DESC @591
SAY DESC @592


COPY ~BG1NPCSoA/Spells/NOAIR.SPL~ ~Override/NOAIR.SPL~
SAY NAME1  @591
 SAY UNIDENTIFIED_DESC @592

COPY ~BG1NPCSoA/Items/BG1IWDe.itm~ ~Override/BG1IWDe.itm~
SAY NAME1 @593
SAY NAME2 @593
SAY UNIDENTIFIED_DESC @593
SAY DESC @594

COPY ~BG1NPCSoA/Spells/BELTYN.SPL~ ~Override/BELTYN.SPL~
SAY NAME1  @593
 SAY UNIDENTIFIED_DESC @594

COPY ~BG1NPCSoA/Items/BG1IWDF.itm~ ~Override/BG1IWDF.itm~
SAY NAME1 @595
SAY NAME2 @595
SAY UNIDENTIFIED_DESC @595
SAY DESC @596

COPY ~BG1NPCSoA/Spells/VSPHERE.SPL~ ~Override/VSPHERE.SPL~
SAY NAME1  @595
 SAY UNIDENTIFIED_DESC @596



COPY ~BG1NPCSoA/Spells/OWLW.SPL~ ~Override/OWLW.SPL~
SAY NAME1  @597
 SAY UNIDENTIFIED_DESC @598

COPY ~BG1NPCSoA/Items/BG1IWDg.itm~ ~Override/BG1IWDg.itm~
SAY NAME1 @597
SAY NAME2 @597
SAY UNIDENTIFIED_DESC @597
SAY DESC @598

COPY ~BG1NPCSoA/Items/BG1IWDH.itm~ ~Override/BG1IWDH.itm~
SAY NAME1 @599
SAY NAME2 @599
SAY UNIDENTIFIED_DESC @599
SAY DESC @600

COPY ~BG1NPCSoA/Spells/TLAUGH.SPL~ ~Override/TLAUGH.SPL~
SAY NAME1  @599
 SAY UNIDENTIFIED_DESC @600

COPY ~BG1NPCSoA/Items/BG1IWDi.itm~ ~Override/BG1IWDi.itm~
SAY NAME1 @601
SAY NAME2 @601
SAY UNIDENTIFIED_DESC @601
SAY DESC @602

COPY ~BG1NPCSoA/Items/BG1IWDJ.itm~ ~Override/BG1IWDJ.itm~
SAY NAME1 @603
SAY NAME2 @603
SAY UNIDENTIFIED_DESC @603
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@604" END

COPY ~BG1NPCSoA/Items/BG1IWDk.itm~ ~Override/BG1IWDk.itm~
SAY NAME1 @605
SAY NAME2 @605
SAY UNIDENTIFIED_DESC @605
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@606" END

COPY ~BG1NPCSoA/Items/BG1IWDL.itm~ ~Override/BG1IWDL.itm~
SAY NAME1 @607
SAY NAME2 @607
SAY UNIDENTIFIED_DESC @607
SAY DESC @608

COPY ~BG1NPCSoA/Spells/APOC.SPL~ ~Override/APOC.SPL~
SAY NAME1  @607
 SAY UNIDENTIFIED_DESC @608

COPY ~BG1NPCSoA/Spells/BWALL.SPL~ ~Override/BWALL.SPL~
SAY NAME1  @609
 SAY UNIDENTIFIED_DESC @610

COPY ~BG1NPCSoA/Items/BG1IWDM.itm~ ~Override/BG1IWDM.itm~
SAY NAME1 @609
SAY NAME2 @609
SAY UNIDENTIFIED_DESC @609
SAY DESC @610


COPY ~BG1NPCSoA/Items/bgsx118.itm~ ~Override/bgsx118.itm~
SAY NAME1 @611
SAY NAME2 @611
SAY UNIDENTIFIED_DESC @611
SAY DESC @611

COPY ~BG1NPCSoA/Spells/plague.SPL~ ~Override/plague.SPL~
SAY NAME1  @611
 SAY UNIDENTIFIED_DESC @612

COPY ~BG1NPCSoA/Items/bgsx119.itm~ ~Override/bgsx119.itm~
SAY NAME1 @613
SAY NAME2 @613
SAY UNIDENTIFIED_DESC @613
SAY DESC @613

COPY ~BG1NPCSoA/Spells/zombie.SPL~ ~Override/zombie.SPL~
SAY NAME1  @613
 SAY UNIDENTIFIED_DESC @613

COPY ~BG1NPCSoA/Items/bgsx120.itm~ ~Override/bgsx120.itm~
SAY NAME1 @614
SAY NAME2 @614
SAY UNIDENTIFIED_DESC @614
SAY DESC @614

COPY ~BG1NPCSoA/Spells/bballs.SPL~ ~Override/bballs.SPL~
SAY NAME1  @614
 SAY UNIDENTIFIED_DESC @614

COPY ~BG1NPCSoA/Items/bgsx121.itm~ ~Override/bgsx121.itm~
SAY NAME1 @615
SAY NAME2 @615
SAY UNIDENTIFIED_DESC @615
SAY DESC @615

COPY ~BG1NPCSoA/Spells/banish.SPL~ ~Override/banish.SPL~
SAY NAME1  @615
 SAY UNIDENTIFIED_DESC @615

COPY ~BG1NPCSoA/Items/bgsx122.itm~ ~Override/bgsx122.itm~
SAY NAME1 @616
SAY NAME2 @616
SAY UNIDENTIFIED_DESC @616
SAY DESC @617

COPY ~BG1NPCSoA/Spells/IFIST.SPL~ ~Override/IFIST.SPL~
SAY NAME1  @616
 SAY UNIDENTIFIED_DESC @617

COPY ~BG1NPCSoA/Items/bgsx123.itm~ ~Override/bgsx123.itm~
SAY NAME1 @618
SAY NAME2 @618
SAY UNIDENTIFIED_DESC @618
SAY DESC @619

COPY ~BG1NPCSoA/Spells/BRAPO.SPL~ ~Override/BRAPO.SPL~
SAY NAME1  @618
 SAY UNIDENTIFIED_DESC @619


COPY ~BG1NPCSoA/Items/bgsx124.itm~ ~Override/bgsx124.itm~
SAY NAME1 @620
SAY NAME2 @620
SAY UNIDENTIFIED_DESC @620
SAY DESC @621

COPY ~BG1NPCSoA/Spells/fharp.SPL~ ~Override/fharp.SPL~
SAY NAME1  @620
 SAY UNIDENTIFIED_DESC @621

COPY ~BG1NPCSoA/Items/bgsx125.itm~ ~Override/bgsx125.itm~
SAY NAME1 @622
SAY NAME2 @622
SAY UNIDENTIFIED_DESC @622
SAY DESC @622



////////////////////////

COPY ~BG1NPCSoA/Spells/TROLLD.SPL~ ~Override/TROLLD.SPL~
SAY NAME1  @622
 SAY UNIDENTIFIED_DESC @622
//////////////////////////////
COPY ~BG1NPCSoA/cre/MISC/7Xcre97.cre~ ~override/7Xcre97.cre~
SAY NAME1 @623
SAY NAME2 @623

COPY ~BG1NPCSoA/cre/MISC/7Xcre98.cre~ ~override/7Xcre98.cre~
SAY NAME1 @624
SAY NAME2 @624

COPY ~BG1NPCSoA/cre/MISC/7Xcre99.cre~ ~override/7Xcre99.cre~
SAY NAME1 @625
SAY NAME2 @625

COPY ~BG1NPCSoA/cre/MISC/7XcreXX.cre~ ~override/7XcreXX.cre~
SAY NAME1 @626
SAY NAME2 @626

COPY ~BG1NPCSoA/cre/MISC/7XcreHH.cre~ ~override/7XcreHH.cre~
SAY NAME1 @627
SAY NAME2 @627

COPY ~BG1NPCSoA/cre/MISC/7XcreAA.cre~ ~override/7XcreAA.cre~
SAY NAME1 @628
SAY NAME2 @628

COPY ~BG1NPCSoA/cre/MISC/7XcreBB.cre~ ~override/7XcreBB.cre~
SAY NAME1 @629
SAY NAME2 @629

COPY ~BG1NPCSoA/cre/MISC/7XcreCC.cre~ ~override/7XcreCC.cre~
SAY NAME1 @630
SAY NAME2 @630

COPY ~BG1NPCSoA/cre/MISC/7XcreDD.cre~ ~override/7XcreDD.cre~
SAY NAME1 @631
SAY NAME2 @631

COPY ~BG1NPCSoA/cre/MISC/7XVolo.cre~ ~override/7XVolo.cre~
SAY NAME1 @632
SAY NAME2 @632

COPY ~BG1NPCSoA/cre/MISC/7Xcre21.CRE~ ~override/7Xcre21.cre~
SAY NAME1 @270
SAY NAME2 @270

/////////////////////////////////////////////////////////////////////////////////////////////

COMPILE ~BG1NPCSoA/dialogues/MISC/Norflkn.d~ 
COMPILE ~BG1NPCSoA/dialogues/MISC/7XVolo.d~
COMPILE ~BG1NPCSoA/dialogues/MISC/7XCRE97.d~

EXTEND_TOP ~Ar0406.bcs~ ~BG1NPCSoA/scripts/AR0406.baf~

COMPILE ~BG1NPCSoA/scripts/MISC/CONDO.BAF~
COMPILE ~BG1NPCSoA/dialogues/MISC/ETBNPC1.d~ 
COMPILE ~BG1NPCSoA/dialogues/MISC/ETBNPC2.d~ 
COMPILE ~BG1NPCSoA/dialogues/MISC/FEYNA.d~ 
COMPILE ~BG1NPCSoA/dialogues/MISC/DFQUEST.d~ 
COMPILE ~BG1NPCSoA/dialogues/MISC/FEDORAK.d~
COMPILE ~BG1NPCSoA/dialogues/MISC/DRANDRA.d~
COMPILE EVALUATE_BUFFER ~BG1NPCSoA/dialogues/MISC/KGSTO2.d~ 
COMPILE ~BG1NPCSoA/dialogues/MISC/KGSTO7.d~

EXTEND_TOP ~Ar1004.bcs~ ~BG1NPCSoA/scripts/MISC/AR1004.baf~
EXTEND_TOP ~Ar1200.bcs~ ~BG1NPCSoA/scripts/MISC/AR1200.baf~
EXTEND_TOP ~Ar0526.bcs~ ~BG1NPCSoA/scripts/MISC/AR0526.baf~

ACTION_IF GAME_IS "bg2ee eet" BEGIN
      OUTER_SPRINT yuanti_animation YUAN-TI_PRIEST 
   END ELSE BEGIN 
      OUTER_SPRINT yuanti_animation IC_YUANTI3 
   END

COMPILE ~BG1NPCSoA/dialogues/MISC/BG1X7.d~
COMPILE ~BG1NPCSoA/dialogues/MISC/BG1X6.d~
COMPILE ~BG1NPCSoA/dialogues/MISC/BG1X5.d~
COMPILE ~BG1NPCSoA/dialogues/MISC/BG1X4.d~
COMPILE ~BG1NPCSoA/dialogues/MISC/BG1X1.d~
COMPILE ~BG1NPCSoA/scripts/MISC/BG1X3.baf~
COMPILE ~BG1NPCSoA/dialogues/MISC/BG1X3.d~
COMPILE ~BG1NPCSoA/dialogues/MISC/BG1X2.d~
COMPILE ~BG1NPCSoA/dialogues/MISC/BG1X8.d~
COMPILE ~BG1NPCSoA/dialogues/MISC/BG1X9.d~


///
// We create dialogue files for those NPCs that will speak in Water Gardens 
//(so that there are no compilation errors if the components of these NPCs are not installed in the future)
ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XGarJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XGar-Begin.d~
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XSHARJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XSHARJ-Begin.d~
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XSKIJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XSKIJ-Begin.d~
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XXZARJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XXZARJ-begin.d~
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XCoranJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XCoranJ-Begin.d~
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XSafaJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XSafaJ-Begin.d~
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XTIAXJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XTIAXJ-Begin.d~
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XFALDJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/Faldorn/7XFALD-begin.d~
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XMONTJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XMONTJ-begin.d~
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XkagaJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XkagaJ-begin.d~
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XQUAYJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XQUAYJ-begin.d~
END


/////


COMPILE EVALUATE_BUFFER ~BG1NPCSoA/dialogues/MISC/BG1X10.d~ 
COMPILE EVALUATE_BUFFER ~BG1NPCSoA/dialogues/MISC/BG1X24.d~ 
COMPILE ~BG1NPCSoA/dialogues/MISC/BG1X36.d~
COMPILE EVALUATE_BUFFER ~BG1NPCSoA/dialogues/MISC/7XCREXX.d~ 

////////////////////
// AUCTION
////////////////////

COPY ~BG1NPCSoA/cre/MISC/7xAUCTIO.CRE~ ~override/7xAUCTIO.CRE~
SAY NAME1 @1820
SAY NAME2 @1820 

COPY ~BG1NPCSoA/cre/MISC/7XNOBLE1.cre~ ~override/7XNOBLE1.cre~
SAY NAME1 @1821
SAY NAME2 @1821

COPY ~BG1NPCSoA/cre/MISC/7XNOBLE2.cre~ ~override/7XNOBLE2.cre~
SAY NAME1 @1822
SAY NAME2 @1822

COPY ~BG1NPCSoA/cre/MISC/7XNOBLE3.cre~ ~override/7XNOBLE3.cre~
SAY NAME1 @1831
SAY NAME2 @1831

COPY ~BG1NPCSoA/cre/MISC/7XNOBLE4.cre~ ~override/7XNOBLE4.cre~
SAY NAME1 @1823
SAY NAME2 @1823

COPY ~BG1NPCSoA/cre/MISC/7XNOBLE5.cre~ ~override/7XNOBLE5.cre~
SAY NAME1 @1824
SAY NAME2 @1824

COPY ~BG1NPCSoA/cre/MISC/7XNOBLE6.cre~ ~override/7XNOBLE6.cre~
SAY NAME1 @1825
SAY NAME2 @1825

COPY ~BG1NPCSoA/cre/MISC/7XTUFUS.cre~ ~override/7XTUFUS.cre~
SAY NAME1 @1826
SAY NAME2 @1826

COPY ~BG1NPCSoA/cre/MISC/7XDruzer.cre~ ~override/7XDruzer.cre~
SAY NAME1 @1827
SAY NAME2 @1827

COPY ~BG1NPCSoA/cre/MISC/7XSAREZ.cre~ ~override/7XSAREZ.cre~
SAY NAME1 @1830
SAY NAME2 @1830

COPY ~BG1NPCSoA/cre/MISC/7XDILIN.cre~ ~override/7XDILIN.cre~
SAY NAME1 @1832
SAY NAME2 @1832

COPY ~BG1NPCSoA/cre/MISC/7XNOBLE7.cre~ ~override/7XNOBLE7.cre~
SAY NAME1 @1833
SAY NAME2 @1833

COPY ~BG1NPCSoA/cre/MISC/7XNOBLE8.cre~ ~override/7XNOBLE8.cre~
SAY NAME1 @1828
SAY NAME2 @1828

COPY ~BG1NPCSoA/cre/MISC/7XNOBLE9.cre~ ~override/7XNOBLE9.cre~
SAY NAME1 @1834
SAY NAME2 @1834

COPY ~BG1NPCSoA/cre/MISC/7XNOBL10.cre~ ~override/7XNOBL10.cre~
SAY NAME1 @1829
SAY NAME2 @1829

COPY ~BG1NPCSoA/cre/MISC/7XNOBL11.cre~ ~override/7XNOBL11.cre~
SAY NAME1 @1835
SAY NAME2 @1835

COPY ~BG1NPCSoA/cre/MISC/7XNOBL12.cre~ ~override/7XNOBL12.cre~
SAY NAME1 @1836
SAY NAME2 @1836

COPY ~BG1NPCSoA/cre/MISC/7XNOBL13.cre~ ~override/7XNOBL13.cre~
SAY NAME1 @1837
SAY NAME2 @1837


//// Auction items

COPY "%MOD_FOLDER%/bam/Auction" ~Override~
COPY "%MOD_FOLDER%/eff/RASBARD.eff" ~Override~
COPY "%MOD_FOLDER%/spells/RASBARD.spl" ~Override~

COPY ~BG1NPCSoA/Items/Auction/PLATPANT.itm~ ~Override/PLATPANT.itm~
SAY NAME1 @1880
SAY NAME2 @1880
SAY UNIDENTIFIED_DESC @1880
SAY DESC @1881

COPY ~BG1NPCSoA/Items/Auction/TOPGAD.itm~ ~Override/TOPGAD.itm~
SAY NAME1 @1882
SAY NAME2 @1882
SAY UNIDENTIFIED_DESC @1882
SAY DESC @1883

COPY ~BG1NPCSoA/Items/Auction/TOMGENIA.itm~ ~Override/TOMGENIA.itm~
SAY NAME1 @1884
SAY NAME2 @1884
SAY UNIDENTIFIED_DESC @1884
SAY DESC @1885

COPY ~BG1NPCSoA/Items/Auction/ZEROCHAR.itm~ ~Override/ZEROCHAR.itm~
SAY NAME1 @1886
SAY NAME2 @1886
SAY UNIDENTIFIED_DESC @1886
SAY DESC @1887

COPY ~BG1NPCSoA/Items/Auction/NEVROSA.itm~ ~Override/NEVROSA.itm~
SAY NAME1 @1888
SAY NAME2 @1888
SAY UNIDENTIFIED_DESC @1888
SAY DESC @1889

COPY ~BG1NPCSoA/Items/Auction/FLAODUH.itm~ ~Override/FLAODUH.itm~
SAY NAME1 @1890
SAY NAME2 @1890
SAY UNIDENTIFIED_DESC @1890
SAY DESC @1891

COPY ~BG1NPCSoA/Items/Auction/RASBARD.itm~ ~Override/RASBARD.itm~
SAY NAME1 @1892
SAY NAME2 @1892
SAY UNIDENTIFIED_DESC @1892
SAY DESC @1893

COPY ~BG1NPCSoA/Items/Auction/PURECOUR.itm~ ~Override/PURECOUR.itm~
SAY NAME1 @1894
SAY NAME2 @1894
SAY UNIDENTIFIED_DESC @1894
SAY DESC @1895

COPY ~BG1NPCSoA/Items/Auction/AMULNALI.itm~ ~Override/AMULNALI.itm~
SAY NAME1 @1896
SAY NAME2 @1896
SAY UNIDENTIFIED_DESC @1896
SAY DESC @1897

COPY ~BG1NPCSoA/Items/Auction/ANTIMSAP.itm~ ~Override/ANTIMSAP.itm~
SAY NAME1 @1898
SAY NAME2 @1898
SAY UNIDENTIFIED_DESC @1898
SAY DESC @1899

COPY ~BG1NPCSoA/Items/Auction/BEZPOST.itm~ ~Override/BEZPOST.itm~
SAY NAME1 @1878
SAY NAME2 @1878
SAY UNIDENTIFIED_DESC @1878
SAY DESC @1879

COPY ~BG1NPCSoA/Items/Auction/SHLAPAEL.itm~ ~Override/SHLAPAEL.itm~
SAY NAME1 @1876
SAY NAME2 @1876
SAY UNIDENTIFIED_DESC @1876
SAY DESC @1877


/////

COMPILE ~BG1NPCSoA/dialogues/MISC/BG1X11.d~ // Auction
COMPILE ~BG1NPCSoA/dialogues/MISC/BG1X12.d~ // Borivyk % his animals

ACTION_IF GAME_IS "bg2ee eet" BEGIN
OUTER_SPRINT ~baf_string1~ ~DestroyGroundPiles()~
END
ELSE BEGIN
OUTER_SPRINT ~baf_string1~ ~~
END
COMPILE ~BG1NPCSoA/scripts/MISC/7xARAU.baf~ EVALUATE_BUFFER

COPY_EXISTING ~PEHLLUS.cre~ ~override~
    WRITE_EVALUATED_ASCII SCRIPT_GENERAL ~PEHLLUS~ #8
  BUT_ONLY_IF_IT_CHANGES
  
COPY_EXISTING ~BNOBLE1.cre~ ~override~
    WRITE_EVALUATED_ASCII SCRIPT_GENERAL ~BNOBLE1~ #8
  BUT_ONLY_IF_IT_CHANGES  
  
// Add Pellus's script name
COPY_EXISTING ~PEHLLUS.cre~ ~override\PEHLLUS.cre~
WRITE_ASCII 0x280 ~PEHLLUS~ (32)

ACTION_IF NOT FILE_EXISTS_IN_GAME ~bdoffscr.cre~ BEGIN
COPY "%MOD_FOLDER%/cre/bdoffscr.cre" override
COPY "%MOD_FOLDER%/spells/bdoffscr.spl" override
END

////////////////////////

COMPILE ~BG1NPCSoA/scripts/MISC/ARBGX2.baf~
COMPILE ~BG1NPCSoA/scripts/MISC/ARBGX3.baf~
COMPILE ~BG1NPCSoA/scripts/MISC/ARBGX4.baf~
COMPILE ~BG1NPCSoA/scripts/MISC/ARBGX6.baf~
COMPILE ~BG1NPCSoA/scripts/MISC/ARBGX7.baf~
COMPILE ~BG1NPCSoA/scripts/MISC/ARBGX9.baf~
COMPILE ~BG1NPCSoA/scripts/MISC/BG1X1.baf~
COMPILE ~BG1NPCSoA/scripts/MISC/BG1X8.baf~
COMPILE ~BG1NPCSoA/scripts/MISC/7XCREHH.baf~
COMPILE ~BG1NPCSoA/scripts/MISC/PEHLLUS.baf~
COMPILE ~BG1NPCSoA/scripts/MISC/BNOBLE1.baf~
COMPILE ~BG1NPCSoA/scripts/MISC/7xNoble8.baf~
COMPILE ~BG1NPCSoA/scripts/MISC/7xAxHell.baf~
EXTEND_TOP ~baldur.bcs~ ~BG1NPCSoA/scripts/MISC/baldur.baf~ EVALUATE_BUFFER

COMPILE ~BG1NPCSoA/dialogues/MISC/rumar.D~
COMPILE ~BG1NPCSoA/dialogues/MISC/priss.D~

EXTEND_TOP ~Ar0022.bcs~ ~BG1NPCSoA/scripts/MISC/AR0022.baf~
COPY ~BG1NPCSoA/scripts/MISC/DRANDRA.bcs~ ~override/DRANDRA.bcs~
COPY ~BG1NPCSoA/scripts/MISC/BG1X24.bcs~ ~override/BG1X24.bcs~
EXTEND_TOP ~Ar0700.bcs~ ~BG1NPCSoA/scripts/MISC/AR0700.baf~
EXTEND_TOP ~Ar0400.bcs~ ~BG1NPCSoA/scripts/AR0400.baf~
EXTEND_TOP ~Ar0400.bcs~ ~BG1NPCSoA/scripts/ARENA/AR0400.baf~

ACTION_IF GAME_IS "bg2ee eet" BEGIN
  // Enhanced Edition game detected
COPY ~BG1NPCSoA/areas/EE-tis~ ~override~ // Copy TIS files for EE version

END ELSE BEGIN  // GAME_IS ~bg2 tob tutu bgt~
  // vanilla Infinity Engine game detected

  // simply copy over MOS and TIS files
COPY ~BG1NPCSoA/areas/mos/~ ~override~
COPY ~BG1NPCSoA/areas/vanilla-tis~ ~override~
END


COPY ~BG1NPCSoA/areas/ARBGX1.are~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX1HT.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX1LM.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX1SR.bmp~ ~override~

COPY ~BG1NPCSoA/areas/ARBGX1.wed~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX2.are~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX2HT.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX2LM.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX2SR.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX2.wed~ ~override~

COPY ~BG1NPCSoA/areas/ARBGX3.are~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX3HT.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX3LM.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX3SR.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX3.wed~ ~override~


COPY ~BG1NPCSoA/areas/ARBGX4.are~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX4HT.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX4LM.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX4SR.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX4.wed~ ~override~

COPY ~BG1NPCSoA/areas/ARBGX5.are~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX5HT.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX5LM.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX5SR.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX5.wed~ ~override~

COPY ~BG1NPCSoA/areas/ARBGX6.are~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX6HT.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX6LM.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX6SR.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX6.wed~ ~override~

COPY ~BG1NPCSoA/areas/ARBGX7.are~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX7HT.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX7LM.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX7SR.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX7.wed~ ~override~

COPY ~BG1NPCSoA/areas/ARBGX8.are~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX8HT.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX8LM.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX8SR.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX8.wed~ ~override~

COPY ~BG1NPCSoA/areas/ARBGX9.are~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX9HT.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX9LM.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX9SR.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX9.wed~ ~override~

COPY ~BG1NPCSoA/areas/ARBGX0.are~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX0HT.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX0LM.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX0SR.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGX0.wed~ ~override~

COPY ~BG1NPCSoA/areas/ARBGXX.are~ ~override~
COPY ~BG1NPCSoA/areas/ARBGXXHT.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGXXLM.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGXXSR.bmp~ ~override~
COPY ~BG1NPCSoA/areas/ARBGXX.wed~ ~override~

COPY ~BG1NPCSoA/areas/7xARAU.are~ ~override~
COPY ~BG1NPCSoA/areas/7xARAUHT.bmp~ ~override~
COPY ~BG1NPCSoA/areas/7xARAULM.bmp~ ~override~
COPY ~BG1NPCSoA/areas/7xARAUSR.bmp~ ~override~
COPY ~BG1NPCSoA/areas/7xARAU.wed~ ~override~


APPEND ~mastarea.2da~
~ARBGX2   value~
UNLESS ~ARBGX2~

APPEND ~mastarea.2da~
~ARBGX7   value~
UNLESS ~ARBGX7~


ACTION_IF NOT FILE_EXISTS_IN_GAME ~override/bimoen2.dlg~ THEN BEGIN
  <<<<<<<< BG1NPCSoA/dialogues/MISC/BIMOEN2.d
  BEGIN BIMOEN2
  >>>>>>>>
  COMPILE ~BG1NPCSoA/dialogues/MISC/BIMOEN2.d~
END


//Giving Imoen a banter file if the Fixpack isn't installed
ACTION_IF NOT FILE_EXISTS_IN_GAME ~cdbehbla.pro~ //makes sure the fixpack isn't already installed
THEN BEGIN
ACTION_IF FILE_EXISTS_IN_GAME ~saradush.mve~ THEN BEGIN
  COPY_EXISTING ~interdia.2da~ ~override~
    SET_2DA_ENTRY 17 1 2 ~BIMOEN2~ // fixes ToB version
    BUT_ONLY_IF_IT_CHANGES
END ELSE BEGIN
  APPEND ~interdia.2da~ ~IMOEN       BIMOEN2~ // fixes SoA version
    UNLESS ~BIMOEN2~
END
END

/*
// Optional component 
// Delete Deekin
BEGIN ~Delete Deekin from Water Gardens~ DESIGNATED 100
GROUP ~Main Mod~
REQUIRE_COMPONENT ~BG1NPCSoA.tp2~ ~0~ ~Water Gardens not installed~
EXTEND_TOP ~ARBGX4.bcs~~BG1NPCSoA/scripts/MISC/DeekinDelete.baf~
*/

BEGIN @1902 DESIGNATED 2
GROUP ~Main Mod~
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~

REQUIRE_PREDICATE (NOT FILE_EXISTS_IN_GAME ~shartel.cre~) AND // Check if the Shar-Teel from the NEJ mod is installed
NOT (FILE_EXISTS_IN_GAME ~SHARTE7.cre~) 
~Shar-Teel already found; skipping to next NPC~

// SHARTEEL

ACTION_IF FILE_EXISTS_IN_GAME ~SHARTE12.cre~ BEGIN
// The code that is needed to remove Shar-Teel from "The Darkest Day" mod and install Shar-Teel from this mod instead
LAF CLEAR_SCRIPT_BLOCKS INT_VAR reverse = 1 STR_VAR search_text = ~shartedd~ END
COPY_EXISTING ~AR1005.bcs~ ~override~
	DECOMPILE_AND_PATCH BEGIN
		SET start_offset = BUFFER_LENGTH - 1
		WHILE (start_offset >= 0) BEGIN
			LPF GET_SCRIPT_BLOCK INT_VAR reverse = 1 start_offset STR_VAR search_regexp = ~SHARTE12~ RET start_offset end_offset END
			PATCH_IF start_offset >= 0 BEGIN
				DELETE_BYTES start_offset (end_offset - start_offset)
			END
		END
	END
	BUT_ONLY_IF_IT_CHANGES

COPY_EXISTING ~pdialog.2da~ ~override~
	REPLACE_TEXTUALLY ~[ %TAB%%LNL%%WNL%%MNL%]SHARTEDD.*$~ ~~

/*SHARTEEL BGT + "The Darkest Day" mod compatibility*/
ACTION_IF GAME_IS ~bgt~ BEGIN
	COPY_EXISTING ~AR1005.bcs~ ~override~
		DECOMPILE_AND_PATCH BEGIN
			SET start_offset = BUFFER_LENGTH - 1
			WHILE (start_offset >= 0) BEGIN
				LPF GET_SCRIPT_BLOCK INT_VAR reverse = 1 start_offset STR_VAR search_regexp = ~BP_SharteelBG1Check~ RET start_offset end_offset END
				PATCH_IF start_offset >= 0 BEGIN
					DELETE_BYTES start_offset (end_offset - start_offset)
				END
			END
		END
	BUT_ONLY_IF_IT_CHANGES

	OUTER_SPRINT ~aram00_bgt~ ~IF
    InParty("Sharteel")
    Global("MeetOldenFriends","GLOBAL",23)
THEN
  RESPONSE #100
    ActionOverride("Sharteel",LeaveParty())
    ActionOverride("Sharteel",ChangeAIScript("",DEFAULT))
    ActionOverride("Sharteel",ClearAllActions())
    ActionOverride("Sharteel",DestroySelf())
    SetGlobal("MeetOldenFriends","GLOBAL",24)
    Continue()
END~
	OUTER_SET ~strlen~ = STRING_LENGTH ~%aram00_bgt%~

	COPY_EXISTING ~aram00.bcs~ ~override~
		DECOMPILE_AND_PATCH BEGIN
			LPF GET_SCRIPT_BLOCK STR_VAR search_regexp = ~SharteelPartyBG1~ RET start_offset end_offset END
			PATCH_IF start_offset >= 0 BEGIN
				DELETE_BYTES start_offset (end_offset - start_offset)
				INSERT_BYTES start_offset strlen
				WRITE_ASCIIE start_offset ~%aram00_bgt%~
			END
		END
		BUT_ONLY_IF_IT_CHANGES
END

END

COPY_EXISTING ~sw1h01.itm~ ~override/7xbg1n.mrk~ // This file helps to determine if at least one component is installed - to disable the installation of the audio component and cross-banters if none of the main components is installed.
COPY_EXISTING ~sw1h01.itm~ ~override/FirstComp.mrk~ // For enable the installation of the ToB component is installed.

APPEND ~STATE.IDS~ ~0x80101FEF CD_STATE_NOTVALID~
UNLESS ~CD_STATE_NOTVALID~

COPY ~BG1NPCSoA/Cre/7xcre1.cre~ ~override/7xcre1.cre~ 
SAY NAME1 @2
SAY NAME2 @3
SAY BIO @4
SAY INITIAL_MEETING ~~ 
  SAY MORALE ~~ 
  SAY HAPPY @6 
  SAY UNHAPPY_ANNOYED @7 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER @8
  SAY TIRED ~~ [shartc]
  SAY BORED ~~ [shartd]
  SAY BATTLE_CRY1 @11
  SAY BATTLE_CRY2 ~~ [shart8]
  SAY BATTLE_CRY3 ~~ [shart9] 
  SAY BATTLE_CRY4 ~~ [sharta]
  SAY BATTLE_CRY5 ~~ [shart8]
  SAY DAMAGE ~~ [shartl]
  SAY DYING ~~ [shartm]
  SAY HURT @17  
  SAY AREA_FOREST ~~ [shartn]
  SAY AREA_CITY ~~ [sharto]
  SAY AREA_DUNGEON ~~ [shartp]
  SAY AREA_DAY ~~ [shartq]
  SAY AREA_NIGHT ~~ [shartr] 
  SAY SELECT_COMMON1  ~~ [shartf]
  SAY SELECT_COMMON2 ~~ [shartg]
  SAY SELECT_COMMON3 ~~ [shartH]
  SAY SELECT_COMMON4 @26 
  SAY SELECT_COMMON5 ~~ [shart0] 
  SAY SELECT_COMMON6 ~~ [shartf]
  SAY SELECT_ACTION1 ~~ [sharti] 
  SAY SELECT_ACTION2 ~~ [shartj]  
  SAY SELECT_ACTION3 ~~ [sharti] 
  SAY SELECT_ACTION4  ~~ [shartj]
  SAY SELECT_ACTION5 ~~ [shartt]
  SAY SELECT_ACTION6 ~~ [shartu] 
  SAY SELECT_ACTION7 ~~ [shartv]
  SAY SELECT_RARE1 ~~ [shartx]
  SAY SELECT_RARE2 ~~ [sharty]
  SAY CRITICAL_HIT ~~ [shartz]
  SAY CRITICAL_MISS ~~ [shart1]
  SAY TARGET_IMMUNE ~~ [shart2]
  SAY INVENTORY_FULL ~~ [shart3]
  SAY PICKED_POCKET ~~ [shart4]
  SAY HIDDEN_IN_SHADOWS ~~ [shart5] 
  SAY SPELL_DISRUPTED ~~ [shart6]
  SAY SET_A_TRAP ~~ [shart7]
SAY REACT_TO_DIE_GENERAL ~~ [shartw]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~ 
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END

LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Sharteel" oggdec_path = "BG1NPCSoA/sounds" END

COMPILE ~BG1NPCSoA/dialogues/7Xshar.d~ 

ACTION_IF FILE_EXISTS_IN_GAME ~7XsharJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XsharJ.d~
END ELSE BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XsharJ-Begin.d~
COMPILE ~BG1NPCSoA/dialogues/7XsharJ.d~
END

COMPILE ~BG1NPCSoA/dialogues/B7Xshar.d~ 

ACTION_IF FILE_EXISTS_IN_GAME ~KGSTO2.dlg~ BEGIN
COMPILE EVALUATE_BUFFER ~BG1NPCSoA/dialogues/MISC/KGSTO2sharteel.d~ USING ~BG1NPCSoA/tra/%LANGUAGE%/KGSTO2.tra~
END

COMPILE ~BG1NPCSoA/scripts/7xshar.BAF~

ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE1.cre~ BEGIN
  COPY_EXISTING ~7XCRE1.cre~ ~override~
    WRITE_EVALUATED_ASCII SCRIPT_OVERRIDE ~7XSHAR~ #8
  BUT_ONLY_IF_IT_CHANGES
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~override/bimoen2.dlg~ THEN BEGIN
  <<<<<<<< BG1NPCSoA/dialogues/MISC/BIMOEN2.d
  BEGIN BIMOEN2
  >>>>>>>>
  COMPILE ~BG1NPCSoA/dialogues/MISC/BIMOEN2.d~
END


//Giving Imoen a banter file if the Fixpack isn't installed
ACTION_IF NOT FILE_EXISTS_IN_GAME ~cdbehbla.pro~ //makes sure the fixpack isn't already installed
THEN BEGIN
ACTION_IF FILE_EXISTS_IN_GAME ~saradush.mve~ THEN BEGIN
  COPY_EXISTING ~interdia.2da~ ~override~
    SET_2DA_ENTRY 17 1 2 ~BIMOEN2~ // fixes ToB version
    BUT_ONLY_IF_IT_CHANGES
END ELSE BEGIN
  APPEND ~interdia.2da~ ~IMOEN       BIMOEN2~ // fixes SoA version
    UNLESS ~BIMOEN2~
END
END

APPEND ~pdialog.2da~
~7Xshar	7XsharP		7XsharJ		7XsharD  7Xsha25P 7Xsha25J 7Xsha25D 7Xsha25~
UNLESS ~7Xshar~


APPEND ~interdia.2da~
  ~7Xshar     B7Xshar     B7Xsh25~
  UNLESS ~7Xshar~

COPY ~BG1NPCSoA/cre/ARENA/7Xcre10.cre~ ~override/7Xcre10.cre~
SAY NAME1 @257
SAY NAME2 @257

COPY ~BG1NPCSoA/cre/ARENA/7Xcre11.cre~ ~override/7Xcre11.cre~
SAY NAME1 @258
SAY NAME2 @258
 SAY INITIAL_MEETING ~~ [arena1]
  SAY MORALE ~~ [arena2]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ [arena2]
  SAY BATTLE_CRY2 ~~ [arena1]
  SAY BATTLE_CRY3 ~~ [arena1]
  SAY BATTLE_CRY4 ~~ [arena1]
  SAY BATTLE_CRY5 ~~ [arena2]
  SAY DAMAGE ~~ 
  SAY DYING ~~ [arena1]
  SAY HURT ~~ [arena1]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [arena1]
  SAY SELECT_COMMON2 ~~ [arena1]
  SAY SELECT_COMMON3 ~~ 
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ [arena1]
  SAY SELECT_ACTION2 ~~ 
  SAY SELECT_ACTION3 ~~ 
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ 
  SAY SELECT_RARE2 ~~ 
  SAY CRITICAL_HIT ~~ [arena1]
  SAY CRITICAL_MISS ~~ [arena2]
  SAY TARGET_IMMUNE ~~ [arena1]
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [arena1]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~

COPY ~BG1NPCSoA/cre/ARENA/7Xcre12.cre~ ~override/7Xcre12.cre~
SAY NAME1 @261
SAY NAME2 @261
SAY INITIAL_MEETING ~~ [arena1]
  SAY MORALE ~~ [arena1]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ [arena2]
  SAY BATTLE_CRY2 ~~ [arena1]
  SAY BATTLE_CRY3 ~~ [arena1]
  SAY BATTLE_CRY4 ~~ [arena1]
  SAY BATTLE_CRY5 ~~ [arena1]
  SAY DAMAGE ~~ 
  SAY DYING ~~ [arena2]
  SAY HURT ~~ [arena1]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ 
  SAY SELECT_COMMON2 ~~ [arena1]
  SAY SELECT_COMMON3 ~~ 
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ [arena1]
  SAY SELECT_ACTION1 ~~ [arena1]
  SAY SELECT_ACTION2 ~~ 
  SAY SELECT_ACTION3 ~~ 
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ [arena1]
  SAY SELECT_RARE2 ~~ 
  SAY CRITICAL_HIT ~~ [arena1]
  SAY CRITICAL_MISS ~~ [arena2]
  SAY TARGET_IMMUNE ~~ [arena1]
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [arena1]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~

COPY ~BG1NPCSoA/cre/ARENA/7Xcre13.cre~ ~override/7Xcre13.cre~
SAY NAME1 @262
SAY NAME2 @262
SAY INITIAL_MEETING ~~ [arena1]
  SAY MORALE ~~ [arena1]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ [arena2]
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ [arena1]
  SAY BATTLE_CRY2 ~~ [arena1]
  SAY BATTLE_CRY3 ~~ [arena1]
  SAY BATTLE_CRY4 ~~ [arena1]
  SAY BATTLE_CRY5 ~~ [arena1]
  SAY DAMAGE ~~ 
  SAY DYING ~~ [arena2]
  SAY HURT ~~ [arena1]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [arena2]
  SAY SELECT_COMMON2 ~~ [arena2]
  SAY SELECT_COMMON3 ~~ [arena2]
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ [arena2]
  SAY SELECT_ACTION2 ~~ [arena2]
  SAY SELECT_ACTION3 ~~ [arena2]
  SAY SELECT_ACTION4  ~~ [arena2]
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ [arena2]
  SAY SELECT_RARE2 ~~ [arena2]
  SAY CRITICAL_HIT ~~ [arena2]
  SAY CRITICAL_MISS ~~ [arena1]
  SAY TARGET_IMMUNE ~~ [arena2]
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [arena1]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~

COPY ~BG1NPCSoA/cre/ARENA/7Xcre14.cre~ ~override/7Xcre14.cre~
SAY NAME1 @263
SAY NAME2 @263
SAY INITIAL_MEETING ~~ [arena2]
  SAY MORALE ~~ [arena1]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ [arena1]
  SAY BATTLE_CRY2 ~~ [arena2]
  SAY BATTLE_CRY3 ~~ [arena1]
  SAY BATTLE_CRY4 ~~ [arena1]
  SAY BATTLE_CRY5 ~~ [arena1]
  SAY DAMAGE ~~ 
  SAY DYING ~~ [arena2]
  SAY HURT ~~ [arena2]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [arena2]
  SAY SELECT_COMMON2 ~~ 
  SAY SELECT_COMMON3 ~~ 
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ [arena2]
  SAY SELECT_ACTION2 ~~ 
  SAY SELECT_ACTION3 ~~ 
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ 
  SAY SELECT_RARE2 ~~ 
  SAY CRITICAL_HIT ~~ [arena1]
  SAY CRITICAL_MISS ~~ [arena2]
  SAY TARGET_IMMUNE ~~ [arena2]
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [arena1]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~

COPY ~BG1NPCSoA/cre/ARENA/7Xcre15.cre~ ~override/7Xcre15.cre~
SAY NAME1 @264
SAY NAME2 @264
SAY INITIAL_MEETING ~~ [arena1]
  SAY MORALE ~~ [arena1]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ [arena2]
  SAY BATTLE_CRY2 ~~ [arena1]
  SAY BATTLE_CRY3 ~~ [arena1]
  SAY BATTLE_CRY4 ~~ [arena1]
  SAY BATTLE_CRY5 ~~ [arena2]
  SAY DAMAGE ~~ 
  SAY DYING ~~ [arena1]
  SAY HURT ~~ [arena1]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [arena2]
  SAY SELECT_COMMON2 ~~ [arena2]
  SAY SELECT_COMMON3 ~~ 
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ [arena2]
  SAY SELECT_ACTION2 ~~ [arena2]
  SAY SELECT_ACTION3 ~~ [arena2]
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ [arena2]
  SAY SELECT_RARE2 ~~ 
  SAY CRITICAL_HIT ~~ [arena1]
  SAY CRITICAL_MISS ~~ [arena2]
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [arena2]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~

COPY ~BG1NPCSoA/cre/ARENA/7Xcre16.cre~ ~override/7Xcre16.cre~
SAY NAME1 @265
SAY NAME2 @265
SAY INITIAL_MEETING ~~ [arena1]
  SAY MORALE ~~ [arena1]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ [arena1]
  SAY BATTLE_CRY2 ~~ [arena1]
  SAY BATTLE_CRY3 ~~ [arena2]
  SAY BATTLE_CRY4 ~~ [arena1]
  SAY BATTLE_CRY5 ~~ [arena2]
  SAY DAMAGE ~~ 
  SAY DYING ~~ [arena1]
  SAY HURT ~~ [arena1]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ 
  SAY SELECT_COMMON2 ~~ 
  SAY SELECT_COMMON3 ~~ 
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ 
  SAY SELECT_ACTION2 ~~ 
  SAY SELECT_ACTION3 ~~ 
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ 
  SAY SELECT_RARE2 ~~ 
  SAY CRITICAL_HIT ~~ [arena2]
  SAY CRITICAL_MISS ~~ [arena1]
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [arena1]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~

COPY ~BG1NPCSoA/cre/ARENA/7Xcre17.cre~ ~override/7Xcre17.cre~
SAY NAME1 @266
SAY NAME2 @266
SAY INITIAL_MEETING ~~ [arena1]
  SAY MORALE ~~ [arena1]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ [arena1]
  SAY BATTLE_CRY2 ~~ [arena2]
  SAY BATTLE_CRY3 ~~ [arena1]
  SAY BATTLE_CRY4 ~~ [arena2]
  SAY BATTLE_CRY5 ~~ [arena1]
  SAY DAMAGE ~~ 
  SAY DYING ~~ [arena1]
  SAY HURT ~~ [arena1]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ 
  SAY SELECT_COMMON2 ~~ 
  SAY SELECT_COMMON3 ~~ 
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ 
  SAY SELECT_ACTION2 ~~ 
  SAY SELECT_ACTION3 ~~ 
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ 
  SAY SELECT_RARE2 ~~ 
  SAY CRITICAL_HIT ~~ [arena1]
SAY CRITICAL_MISS ~~ [arena2]
SAY TARGET_IMMUNE ~~
SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [arena1]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~

COPY ~BG1NPCSoA/cre/ARENA/7Xcre18.cre~ ~override/7Xcre18.cre~
SAY NAME1 @267
SAY NAME2 @267

COPY ~BG1NPCSoA/cre/ARENA/7Xcre19.cre~ ~override/7Xcre19.cre~
SAY NAME1 @268
SAY NAME2 @268
SAY INITIAL_MEETING ~~ [arena1]
  SAY MORALE ~~ [arena1]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ [arena1]
  SAY BATTLE_CRY2 ~~ [arena2]
  SAY BATTLE_CRY3 ~~ [arena1]
  SAY BATTLE_CRY4 ~~ [arena2]
  SAY BATTLE_CRY5 ~~ [arena1]
  SAY DAMAGE ~~ 
  SAY DYING ~~ [arena1]
  SAY HURT ~~ [arena1]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ 
  SAY SELECT_COMMON2 ~~ 
  SAY SELECT_COMMON3 ~~ 
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ 
  SAY SELECT_ACTION2 ~~ 
  SAY SELECT_ACTION3 ~~ 
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ 
  SAY SELECT_RARE2 ~~ 
  SAY CRITICAL_HIT ~~ [arena1]
SAY CRITICAL_MISS ~~ [arena2]
SAY TARGET_IMMUNE ~~ [arena2]
SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [arena1]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~

COPY ~BG1NPCSoA/cre/ARENA/7Xcre20.cre~ ~override/7Xcre20.cre~
SAY NAME1 @269
SAY NAME2 @269

COMPILE ~BG1NPCSoA/dialogues/ARENA/ARENA1.d~ 
COMPILE ~BG1NPCSoA/dialogues/ARENA/ARENA2.d~ 
COMPILE ~BG1NPCSoA/dialogues/ARENA/BRUTAX.d~ 

COMPILE ~BG1NPCSoA/scripts/ARENA/ARENA1.BAF~
COMPILE ~BG1NPCSoA/scripts/ARENA/ARENA2.BAF~
COMPILE ~BG1NPCSoA/scripts/ARENA/ARENA3.BAF~
EXTEND_TOP ~Ar0406.bcs~ ~BG1NPCSoA/scripts/ARENA/AR0406.baf~

ACTION_IF FILE_EXISTS_IN_GAME ~ARBGX4.bcs~ BEGIN
EXTEND_TOP ~ARBGX4.bcs~~BG1NPCSoA/scripts/ARENA/ARBGX4.baf~
END


BEGIN @1903 DESIGNATED 4
GROUP ~Main Mod~
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~

REQUIRE_PREDICATE (NOT FILE_EXISTS_IN_GAME ~lk#yesl.cre~) AND
NOT (FILE_EXISTS_IN_GAME ~DYESLICK.CRE~) 
~Yeslick already found; skipping to next NPC~

// YESLICK

ACTION_IF FILE_EXISTS_IN_GAME ~YESLIC9.cre~ BEGIN
// The code that is needed to remove Yeslick from "The Darkest Day" mod and install Yeslick from this mod instead
LAF CLEAR_SCRIPT_BLOCKS INT_VAR reverse = 1 STR_VAR search_text = ~YESLICDD~ END
COPY_EXISTING ~AR0900.bcs~ ~override~
	DECOMPILE_AND_PATCH BEGIN
		SET start_offset = BUFFER_LENGTH - 1
		WHILE (start_offset >= 0) BEGIN
			LPF GET_SCRIPT_BLOCK INT_VAR reverse = 1 start_offset STR_VAR search_regexp = ~YESLIC9~ RET start_offset end_offset END
			PATCH_IF start_offset >= 0 BEGIN
				DELETE_BYTES start_offset (end_offset - start_offset)
			END
		END
	END
	BUT_ONLY_IF_IT_CHANGES

COPY_EXISTING ~pdialog.2da~ ~override~
	REPLACE_TEXTUALLY ~[ %TAB%%LNL%%WNL%%MNL%]YESLICDD.*$~ ~~

/*YESLICK BGT + "The Darkest Day" mod compatibility*/
ACTION_IF GAME_IS ~bgt~ BEGIN
	COPY_EXISTING ~AR0900.bcs~ ~override~
		DECOMPILE_AND_PATCH BEGIN
			SET start_offset = BUFFER_LENGTH - 1
			WHILE (start_offset >= 0) BEGIN
				LPF GET_SCRIPT_BLOCK INT_VAR reverse = 1 start_offset STR_VAR search_regexp = ~BP_YeslickBG1Check~ RET start_offset end_offset END
				PATCH_IF start_offset >= 0 BEGIN
					DELETE_BYTES start_offset (end_offset - start_offset)
				END
			END
		END
	BUT_ONLY_IF_IT_CHANGES

	OUTER_SPRINT ~aram00_bgt~ ~IF
    InParty("Yeslick")
    Global("MeetOldenFriends","GLOBAL",21)
THEN
  RESPONSE #100
    ActionOverride("Yeslick",LeaveParty())
    ActionOverride("Yeslick",ChangeAIScript("",DEFAULT))
    ActionOverride("Yeslick",ClearAllActions())
    ActionOverride("Yeslick",DestroySelf())
    SetGlobal("MeetOldenFriends","GLOBAL",22)
    Continue()
END~
	OUTER_SET ~strlen~ = STRING_LENGTH ~%aram00_bgt%~

	COPY_EXISTING ~aram00.bcs~ ~override~
		DECOMPILE_AND_PATCH BEGIN
			LPF GET_SCRIPT_BLOCK STR_VAR search_regexp = ~YeslickPartyBG1~ RET start_offset end_offset END
			PATCH_IF start_offset >= 0 BEGIN
				DELETE_BYTES start_offset (end_offset - start_offset)
				INSERT_BYTES start_offset strlen
				WRITE_ASCIIE start_offset ~%aram00_bgt%~
			END
		END
		BUT_ONLY_IF_IT_CHANGES
END

END


COPY_EXISTING ~sw1h01.itm~ ~override/7xbg1n.mrk~ // This file helps to determine if at least one component is installed - to disable the installation of the audio component and cross-banters if none of the main components is installed.
COPY_EXISTING ~sw1h01.itm~ ~override/FirstComp.mrk~ // For enable the installation of the ToB component is installed.

APPEND ~STATE.IDS~ ~0x80101FEF CD_STATE_NOTVALID~
UNLESS ~CD_STATE_NOTVALID~

COPY ~BG1NPCSoA/Cre/7Xcre2.cre~ ~override~
SAY NAME1 @45
SAY NAME2 @46
SAY BIO @47
SAY INITIAL_MEETING ~~ [Yeslicky]
  SAY MORALE ~~ [Yeslick!]
  SAY HAPPY @50
  SAY UNHAPPY_ANNOYED ~~ [Yeslick2]
  SAY UNHAPPY_SERIOUS @52
  SAY UNHAPPY_BREAKING @53
  SAY LEADER ~~[YeslickB]
  SAY TIRED ~~[Yeslickc]
  SAY BORED ~~[Yeslickd]
  SAY BATTLE_CRY1 ~~[YeslickA]
  SAY BATTLE_CRY2 ~~[Yeslick2]
  SAY BATTLE_CRY3 ~~[Yeslick9]
  SAY BATTLE_CRY4 ~~[YeslickA]
  SAY DAMAGE ~~[YeslickL]
  SAY DYING ~~[YeslickM]
  SAY HURT ~~[Yeslicke]
SAY AREA_FOREST ~~[YeslickR]
  SAY AREA_CITY ~~[Yeslicko]
  SAY AREA_DUNGEON ~~[YeslickP] 
SAY AREA_DAY ~~[YeslickR]
SAY AREA_NIGHT ~~[YeslickR]
  SAY SELECT_COMMON1 ~~ [Yeslickf]
  SAY SELECT_COMMON2 ~~ [Yeslickg]
  SAY SELECT_COMMON3 ~~ [Yeslickh]
  SAY SELECT_COMMON4 ~~ [Yeslick$]
  SAY SELECT_COMMON5 ~~ [Yeslicky]
  SAY SELECT_COMMON6 ~~ [YeslickN]
  SAY SELECT_ACTION1 ~~ [Yeslicki]
  SAY SELECT_ACTION2 ~~ [Yeslickj]
  SAY SELECT_ACTION3 ~~ [Yeslickk]
  SAY SELECT_ACTION4 ~~ [Yeslicks]
  SAY SELECT_ACTION5 ~~ [Yeslickt]
  SAY SELECT_ACTION6 ~~ [Yeslicku]
  SAY SELECT_ACTION7 ~~ [Yeslickv]
  SAY SELECT_RARE1 ~~ [Yeslickx]
  SAY SELECT_RARE2 ~~ [Yeslick!]
  SAY CRITICAL_HIT ~~ [Yeslickz]
  SAY CRITICAL_MISS ~~ [Yeslick1]
  SAY TARGET_IMMUNE ~~ [Yeslick2]
  SAY INVENTORY_FULL ~~ [Yeslick3]
  SAY PICKED_POCKET  ~~ [Yeslick4]
  SAY HIDDEN_IN_SHADOWS ~~ [Yeslick5]
  SAY SPELL_DISRUPTED ~~ [Yeslick6]
  SAY SET_A_TRAP ~~ [Yeslick7]
 SAY REACT_TO_DIE_GENERAL @85
  SAY INTERACTION3 ~~ [Yeslick_]
  SAY COMPLIMENT1 ~~ [Yeslick_]
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END

LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Yeslick" oggdec_path = "BG1NPCSoA/sounds" END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~IMOEN!.wav~ BEGIN
LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Imoen" oggdec_path = "BG1NPCSoA/sounds" END
END

COMPILE ~BG1NPCSoA/dialogues/7XYES.d~ 

ACTION_IF FILE_EXISTS_IN_GAME ~7XYESJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/B7XYES.d~
END ELSE BEGIN
COMPILE ~BG1NPCSoA/dialogues/B7XYES-Begin.d~
COMPILE ~BG1NPCSoA/dialogues/B7XYES.d~
END

COMPILE ~BG1NPCSoA/dialogues/YESLICK-QUEST/YDWARF1.d~ 
COMPILE ~BG1NPCSoA/dialogues/YESLICK-QUEST/YDWARF2.d~ 

ACTION_IF FILE_EXISTS_IN_GAME ~KGSTO2.dlg~ BEGIN
COMPILE EVALUATE_BUFFER ~BG1NPCSoA/dialogues/MISC/KGSTO2yeslick.d~ USING ~BG1NPCSoA/tra/%LANGUAGE%/KGSTO2.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~BG1X20.dlg~ BEGIN
COMPILE EVALUATE_BUFFER ~BG1NPCSoA/crossbanter/Water Gardens comments/GARDENS-yeslick.d~ USING ~BG1NPCSoA/tra/%LANGUAGE%/BG1X10.tra~
END

EXTEND_TOP ~Ar0020.bcs~ ~BG1NPCSoA/scripts/YESLICK-QUEST/AR0020.baf~
EXTEND_TOP ~Ar0400.bcs~ ~BG1NPCSoA/scripts/YESLICK-QUEST/AR0400.baf~
EXTEND_TOP ~Ar0500.bcs~ ~BG1NPCSoA/scripts/YESLICK-QUEST/AR0500.baf~
EXTEND_TOP ~Ar0800.bcs~ ~BG1NPCSoA/scripts/YESLICK-QUEST/AR0800.baf~
EXTEND_TOP ~Ar0900.bcs~ ~BG1NPCSoA/scripts/YESLICK-QUEST/AR0900.baf~
COMPILE ~BG1NPCSoA/scripts/7xYesl.BAF~

ACTION_IF NOT FILE_EXISTS_IN_GAME ~override/bimoen2.dlg~ THEN BEGIN
  <<<<<<<< BG1NPCSoA/dialogues/MISC/BIMOEN2.d
  BEGIN BIMOEN2
  >>>>>>>>
  COMPILE ~BG1NPCSoA/dialogues/MISC/BIMOEN2.d~
END


//Giving Imoen a banter file if the Fixpack isn't installed
ACTION_IF NOT FILE_EXISTS_IN_GAME ~cdbehbla.pro~ //makes sure the fixpack isn't already installed
THEN BEGIN
ACTION_IF FILE_EXISTS_IN_GAME ~saradush.mve~ THEN BEGIN
  COPY_EXISTING ~interdia.2da~ ~override~
    SET_2DA_ENTRY 17 1 2 ~BIMOEN2~ // fixes ToB version
    BUT_ONLY_IF_IT_CHANGES
END ELSE BEGIN
  APPEND ~interdia.2da~ ~IMOEN       BIMOEN2~ // fixes SoA version
    UNLESS ~BIMOEN2~
END
END

APPEND ~pdialog.2da~ // SOA 
~7XYES      7XYESP          7XYESJ          7XYESD  7XYE25P 7XYE25J 7XYE25D 7XYES25~
UNLESS ~7XYES~

APPEND ~interdia.2da~
  ~7XYES      B7XYES       B7XYE25~
  UNLESS ~7XYES~
  
ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE2.cre~ BEGIN
  COPY_EXISTING ~7XCRE2.cre~ ~override~
    WRITE_EVALUATED_ASCII SCRIPT_OVERRIDE ~7XYESL~ #8
  BUT_ONLY_IF_IT_CHANGES
END

COPY ~BG1NPCSoA/cre/YESLICK-QUEST/7Xcre22.cre~ ~override/7Xcre22.cre~
SAY NAME1 @271
SAY NAME2 @271

COPY ~BG1NPCSoA/cre/YESLICK-QUEST/7Xcre23.cre~ ~override/7Xcre23.cre~
SAY NAME1 @272
SAY NAME2 @272

COPY ~BG1NPCSoA/Items/YDWARF1.itm~ ~Override/YDWARF1.itm~
SAY NAME1 @273
SAY NAME2 @273
SAY UNIDENTIFIED_DESC @274
SAY DESC @275


BEGIN @1904 DESIGNATED 6
GROUP ~Main Mod~
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~

COPY_EXISTING ~sw1h01.itm~ ~override/7xbg1n.mrk~ // This file helps to determine if at least one component is installed - to disable the installation of the audio component and cross-banters if none of the main components is installed.
COPY_EXISTING ~sw1h01.itm~ ~override/FirstComp.mrk~ // For enable the installation of the ToB component is installed.

APPEND ~STATE.IDS~ ~0x80101FEF CD_STATE_NOTVALID~
UNLESS ~CD_STATE_NOTVALID~


// GARRICK

// Set the portrait for Garrick before joining to the group
ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN	
INCLUDE ~%MOD_FOLDER%/lib/standardEE.tph~		
	OUTER_SET s9total=0
	OUTER_SET rows_cnt_1=0
	COPY - ~%MOD_FOLDER%/portraits/garrick.tbl~  ~%MOD_FOLDER%/portraits/garrick.tbl~
		COUNT_2DA_ROWS 1 "rows_cnt_1"
			FOR( cntg=0; cntg<"%rows_cnt_1%"; cntg+=1 ) BEGIN
				READ_2DA_ENTRY cntg  0 2 "Crename"
				READ_2DA_ENTRY cntg  1 2 "Filename"
				INNER_ACTION BEGIN
					ACTION_IF FILE_EXISTS_IN_GAME ~%Crename%.cre~ THEN BEGIN
						OUTER_SET s9total+=1
						LAUNCH_ACTION_MACRO ~Addpic~ 
					END
				END
END
END
ELSE BEGIN
INCLUDE ~%MOD_FOLDER%/lib/standardold.tph~	
	OUTER_SET s9total=0
	OUTER_SET rows_cnt_1=0
	COPY - ~%MOD_FOLDER%/portraits/garrick.tbl~  ~%MOD_FOLDER%/portraits/garrick.tbl~
		COUNT_2DA_ROWS 1 "rows_cnt_1"
			FOR( cntg=0; cntg<"%rows_cnt_1%"; cntg+=1 ) BEGIN
				READ_2DA_ENTRY cntg  0 2 "Crename"
				READ_2DA_ENTRY cntg  1 2 "Filename"
				INNER_ACTION BEGIN
					ACTION_IF FILE_EXISTS_IN_GAME ~%Crename%.cre~ THEN BEGIN
						OUTER_SET s9total+=1
						LAUNCH_ACTION_MACRO ~Addpic~ 
					END
				END
END
END	

COPY ~BG1NPCSoA/Cre/7Xcre3.cre~ ~override/7Xcre3.cre~
SAY NAME1 @88
SAY NAME2 @88
SAY BIO @89
SAY INITIAL_MEETING ~~ [garrickx]
  SAY MORALE ~~ [garrickp]
  SAY HAPPY ~~ [garrickh]
  SAY UNHAPPY_ANNOYED @93
  SAY UNHAPPY_SERIOUS ~~ [garrick9]
  SAY UNHAPPY_BREAKING ~~ [garrick9]
  SAY LEADER ~~ [garrickb]
  SAY TIRED ~~ [garrickc]
  SAY BORED ~~ [garrickd]
  SAY BATTLE_CRY1 @98
  SAY BATTLE_CRY2 ~~ [garrickp]
  SAY BATTLE_CRY3 ~~ [garricka]
  SAY BATTLE_CRY4 ~~ [garrickp]
  SAY BATTLE_CRY5 ~~ [garrickp]
  SAY DAMAGE ~~ [garrickl]
  SAY DYING ~~ [garrickm]
  SAY HURT ~~ [garricke]
  SAY AREA_FOREST @103
  SAY AREA_CITY @104
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ [garrickq]
  SAY AREA_NIGHT ~~ [garrickr]
  SAY SELECT_COMMON1  ~~ [garrickf]
  SAY SELECT_COMMON2 ~~ [garrickg]
  SAY SELECT_COMMON3 ~~ [garricky]
  SAY SELECT_COMMON4 ~~ [garrickf]
  SAY SELECT_COMMON5 ~~ [garrick6]
  SAY SELECT_COMMON6 ~~ [garrick5]
  SAY SELECT_ACTION1 ~~ [garrickk]
  SAY SELECT_ACTION2 ~~ [garricki]
  SAY SELECT_ACTION3 @114
  SAY SELECT_ACTION4  ~~ [garrickf]
  SAY SELECT_ACTION5 ~~ [garrick8]
  SAY SELECT_ACTION6 ~~ [garricks]
  SAY SELECT_ACTION7 ~~ [garrickz]
  SAY SELECT_RARE1 ~~ [garricks]
  SAY SELECT_RARE2 ~~ [garrickf]
  SAY CRITICAL_HIT ~~ [garrickp]
  SAY CRITICAL_MISS ~~ 
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ [garrickv]
  SAY PICKED_POCKET ~~ [garrick4]
  SAY HIDDEN_IN_SHADOWS ~~ [garrickz]
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [garrickw]
  SAY INTERACTION3 ~~ [garricko]
  SAY COMPLIMENT1 ~~ [garricku]
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END

COPY ~BG1NPCSoA/cre/Garrick-QUEST/7Xcre7.cre~ ~override/7Xcre7.cre~
SAY NAME1 @208
SAY NAME2 @208
SAY INITIAL_MEETING ~~ 
  SAY MORALE ~~ 
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ 
  SAY BATTLE_CRY2 ~~ 
  SAY BATTLE_CRY3 ~~ 
  SAY BATTLE_CRY4 ~~ 
  SAY BATTLE_CRY5 ~~ 
  SAY DAMAGE ~~ 
  SAY DYING ~~ 
  SAY HURT ~~ 
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ 
  SAY SELECT_COMMON2 ~~ 
  SAY SELECT_COMMON3 ~~ 
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ 
  SAY SELECT_ACTION2 ~~ 
  SAY SELECT_ACTION3 ~~ 
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ 
  SAY SELECT_RARE2 ~~ 
  SAY CRITICAL_HIT ~~ 
  SAY CRITICAL_MISS ~~ 
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ 
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~


// Создаем персонажа-невидимку (для квеста Гаррика)
COPY_EXISTING ~COPGREET.CRE~ ~override/7xnekto.cre~ //используем существующий файл (портрет и имя уже прописаны)
	FOR ( i = 0xa4 ; i < 0x234 ; i = i + 0x4 ) BEGIN WRITE_LONG i "-1" END //удаляем все звуки на всякий случай
	WRITE_ASCII 0x248 ~7xnekto~ (40) //удаляем все скрипты и в override прописываем 7xnekto
	WRITE_ASCII 0x280 ~7xnekto~ (32) //script_name
	WRITE_ASCII 0x2cc ~7xnekto~ (8)  //dialog
	REMOVE_CRE_ITEMS //удаляем все предметы на всякий случай
	LPF ADD_CRE_EFFECT INT_VAR opcode=315 target=1 parameter2=1 timing=9 END //убираем анимацию
	LPF ADD_CRE_EFFECT INT_VAR opcode=287 target=1 timing=9 END //убираем круг под ногами

COPY ~BG1NPCSoA/cre/MISC/7Xbard1.cre~ ~override/7Xbard1.cre~
SAY NAME1 @1838
SAY NAME2 @1838

COPY ~BG1NPCSoA/cre/MISC/7Xgarib.cre~ ~override/7Xgarib.cre~
SAY NAME1 @1839
SAY NAME2 @1839

LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Garrick" oggdec_path = "BG1NPCSoA/sounds" END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~IMOEN!.wav~ BEGIN
LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Imoen" oggdec_path = "BG1NPCSoA/sounds" END
END

// We import the variable of the flirt with Garrick from BG1 to check its presence in the dialogue 
ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
APPEND ~VARIMPRT.2da~ ~6          P#GarrickFlirt~ 
END  

ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
   // If a EE-version is installed, change the journal entries to adapt it 
  ADD_JOURNAL @1808 @1809 @1810 @1811 USING ~%MOD_FOLDER%/tra/%LANGUAGE%/setup.tra~ 
END 
  

COMPILE ~BG1NPCSoA/scripts/7xGARR.BAF~
COMPILE ~BG1NPCSoA/scripts/7XGarD.BAF~
COMPILE ~BG1NPCSoA/scripts/misc/7Xnekto.BAF~
EXTEND_TOP ~Ar0511.bcs~ ~BG1NPCSoA/scripts/AR0511.baf~
EXTEND_TOP ~AR0313.bcs~ ~BG1NPCSoA/scripts/AR0313.baf~
EXTEND_TOP ~nalia.bcs~ ~BG1NPCSoA/scripts/misc/nalia.baf~
EXTEND_TOP ~baldur.bcs~ ~BG1NPCSoA/scripts/misc/baldur_garrick.baf~
EXTEND_TOP ~AR0406.bcs~ ~BG1NPCSoA/scripts/misc/AR0406.baf~
EXTEND_TOP ~AR0020.bcs~ ~BG1NPCSoA/scripts/misc/AR0020garrick.baf~
EXTEND_TOP ~AR0022.bcs~ ~BG1NPCSoA/scripts/misc/AR0022garrick.baf~

// Добавляем скрипт локации Пяти Графинов
COPY_EXISTING ~AR0509.are~ ~override~
	SPRINT ~scrp~ ~%SOURCE_RES%~ //сохранение в переменную имени локации
	READ_ASCII 0x94 are_script (8) NULL //сохранение в переменную имени скрипта локации
	PATCH_IF ( ~%are_script%~ STR_EQ ~~ ) OR // если имя скрипта пустое
	         ( ~%are_script%~ STR_EQ ~None~ ) BEGIN //или None
		WRITE_EVALUATED_ASCII 0x94 ~%scrp%~ (8) // то записывается в имя скрипта имя локации
		SPRINT are_script ~%scrp%~ // сохранение в переменную нового имени скрипта
	END
	BUT_ONLY_IF_IT_CHANGES

//если baf файл имеет такое же имя
ACTION_IF FILE_EXISTS_IN_GAME ~%are_script%.bcs~ BEGIN
	EXTEND_TOP ~%are_script%.bcs~ ~%MOD_FOLDER%/scripts/MISC/AR0509.baf~ EVALUATE_BUFFER //если скрипт существует, добавляем сверху или снизу
END ELSE BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/MISC/AR0509.baf~ EVALUATE_BUFFER //если не существует, то создаем новый
END


ACTION_IF NOT FILE_EXISTS_IN_GAME ~override/bimoen2.dlg~ THEN BEGIN
  <<<<<<<< BG1NPCSoA/dialogues/MISC/BIMOEN2.d
  BEGIN BIMOEN2
  >>>>>>>>
  COMPILE ~BG1NPCSoA/dialogues/MISC/BIMOEN2.d~
END


//Giving Imoen a banter file if the Fixpack isn't installed
ACTION_IF NOT FILE_EXISTS_IN_GAME ~cdbehbla.pro~ //makes sure the fixpack isn't already installed
THEN BEGIN
ACTION_IF FILE_EXISTS_IN_GAME ~saradush.mve~ THEN BEGIN
  COPY_EXISTING ~interdia.2da~ ~override~
    SET_2DA_ENTRY 17 1 2 ~BIMOEN2~ // fixes ToB version
    BUT_ONLY_IF_IT_CHANGES
END ELSE BEGIN
  APPEND ~interdia.2da~ ~IMOEN       BIMOEN2~ // fixes SoA version
    UNLESS ~BIMOEN2~
END
END

// add Wilson's banter file
ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
<<<<<<<< wilson_dialog.d
BEGIN %wilson_dialog%
>>>>>>>>
ACTION_IF NOT FILE_EXISTS_IN_GAME ~BWILSON.dlg~ BEGIN
	OUTER_SPRINT ~wilson_dialog~ ~BWILSON~
	COMPILE ~wilson_dialog.d~ EVALUATE_BUFFER
END

APPEND ~interdia.2da~ ~WILSON BWILSON BWILSO25~
               UNLESS ~WILSON~

COPY_EXISTING ~pdialog.2da~ ~override~
  REPLACE_TEXTUALLY ~^[ %TAB%]*WILSON[ %TAB%].+$~
                    ~WILSON                 WILSONP                WILSONJ                WILSOND                WILSO25P               WILSO25J               WILSO25D               WILSON25~
BUT_ONLY

END

APPEND ~pdialog.2da~
~7XGar	7XGarP		7XGarJ		7XGarD  7XGar25P 7XGar25J 7XGar25D 7XGar25~
UNLESS ~7XGar~


APPEND ~interdia.2da~
  ~7XGar     B7XGar       B7XGar25~
  UNLESS ~7XGar~
  
ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XkagaJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XkagaJ-begin.d~
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XsharJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XsharJ-Begin.d~
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XMONTJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XMONTJ-begin.d~
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XXZARJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XXZARJ-begin.d~
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XQUAYJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XQUAYJ-begin.d~
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XTIAXJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XTIAXJ-Begin.d~
END

COMPILE ~BG1NPCSoA/dialogues/Garrick-QUEST/GARRICK.D~
COMPILE ~BG1NPCSoA/dialogues/B7XGar.d~ EVALUATE_BUFFER

ACTION_IF FILE_EXISTS_IN_GAME ~7XGarJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XGar.d~
END ELSE BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XGar-Begin.d~
COMPILE ~BG1NPCSoA/dialogues/7XGar.d~
END

COMPILE ~BG1NPCSoA/dialogues/Garrick-QUEST/7XSILK.d~ 

ACTION_IF FILE_EXISTS_IN_GAME ~KGSTO2.dlg~ BEGIN
COMPILE EVALUATE_BUFFER ~BG1NPCSoA/dialogues/MISC/KGSTO2garrick.d~ USING ~BG1NPCSoA/tra/%LANGUAGE%/KGSTO2.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~BG1X20.dlg~ BEGIN
COMPILE EVALUATE_BUFFER ~BG1NPCSoA/crossbanter/Water Gardens comments/GARDENS-garrick.d~ USING ~BG1NPCSoA/tra/%LANGUAGE%/BG1X10.tra~
END  
  
    

COPY ~BG1NPCSoA/Items/BG1NPC7.itm~ ~Override/BG1NPC7.itm~
SAY NAME1 @421		
SAY NAME2 @421
SAY UNIDENTIFIED_DESC @421
SAY DESC @422  

COPY ~BG1NPCSoA/Items/ringnal.itm~ ~Override/ringnal.itm~
SAY NAME1 @1911
SAY NAME2 @1911
SAY UNIDENTIFIED_DESC @1911
SAY DESC @1912

BEGIN @1905 DESIGNATED 8
GROUP ~Main Mod~
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~

REQUIRE_PREDICATE (NOT FILE_EXISTS_IN_GAME ~l#2sdski.cre~) AND
NOT (FILE_EXISTS_IN_GAME ~1xSkie2.cre~) AND 
NOT (FILE_EXISTS_IN_GAME ~1xSkie3.cre~) 
~Skie already found; skipping to next NPC~

// SKIE

COPY_EXISTING ~sw1h01.itm~ ~override/7xbg1n.mrk~ // This file helps to determine if at least one component is installed - to disable the installation of the audio component and cross-banters if none of the main components is installed.
COPY_EXISTING ~sw1h01.itm~ ~override/FirstComp.mrk~ // For enable the installation of the ToB component is installed.

APPEND ~STATE.IDS~ ~0x80101FEF CD_STATE_NOTVALID~
UNLESS ~CD_STATE_NOTVALID~

COPY ~BG1NPCSoA/Cre/7Xcre4.cre~ ~override/7Xcre4.cre~
SAY NAME1 @123
SAY NAME2 @124
SAY BIO @125
SAY INITIAL_MEETING ~~ [skie5]
  SAY MORALE ~~ 
  SAY HAPPY ~~ [skie0]
  SAY UNHAPPY_ANNOYED ~~ [skiea]
  SAY UNHAPPY_SERIOUS ~~ [skie4]
  SAY UNHAPPY_BREAKING ~~ 
  SAY LEADER ~~ [skieb]
  SAY TIRED ~~ [skiec]
  SAY BORED ~~ [skied]
  SAY BATTLE_CRY1 ~~ [skiea]
  SAY BATTLE_CRY2 ~~ [skie8]
  SAY BATTLE_CRY3 ~~ [skiel] 
  SAY BATTLE_CRY4 ~~ [skiea]
  SAY BATTLE_CRY5 ~~ [skiel]
  SAY DAMAGE ~~ [skiee]
  SAY DYING ~~ [skiem]
  SAY HURT ~~ [skie8]  
  SAY AREA_FOREST ~~ [skien]
  SAY AREA_CITY ~~ [skien]
  SAY AREA_DUNGEON ~~ [skieN]
  SAY AREA_DAY ~~ [skieS]
  SAY AREA_NIGHT ~~ [skieH] 
  SAY SELECT_COMMON1  ~~ [skief]
  SAY SELECT_COMMON2 ~~ [skiei]
  SAY SELECT_COMMON3 ~~ [skieH]
  SAY SELECT_COMMON4 ~~ [skieK]
  SAY SELECT_COMMON5 ~~ [skieX] 
  SAY SELECT_COMMON6 ~~ [skief]
  SAY SELECT_ACTION1 ~~ [skiei] 
  SAY SELECT_ACTION2 ~~ [skiej]  
  SAY SELECT_ACTION3 ~~ [skieS] 
  SAY SELECT_ACTION4  ~~ [skiej]
  SAY SELECT_ACTION5 ~~ [skiet]
  SAY SELECT_ACTION6 ~~  [skieY]
  SAY SELECT_ACTION7 ~~ [skiev]
  SAY SELECT_RARE1 ~~ [skiex]
  SAY SELECT_RARE2 ~~ [skiey]
  SAY CRITICAL_HIT ~~ [skiez]
  SAY CRITICAL_MISS ~~ [skie1]
  SAY TARGET_IMMUNE ~~ [skie2]
  SAY INVENTORY_FULL ~~ [skie3]
  SAY PICKED_POCKET ~~ [skie4]
  SAY HIDDEN_IN_SHADOWS ~~ [skie5] 
  SAY SPELL_DISRUPTED ~~ [skie6]
  SAY SET_A_TRAP ~~
  SAY REACT_TO_DIE_GENERAL ~~ [skie7]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~ [skie0]
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END

LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Skie" oggdec_path = "BG1NPCSoA/sounds" END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~IMOEN!.wav~ BEGIN
LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Imoen" oggdec_path = "BG1NPCSoA/sounds" END
END

ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
COPY ~BG1NPCSoA/portraits/Skie/EE-portraits/~ ~override~
END ELSE BEGIN
COPY ~BG1NPCSoA/portraits/Skie/vanilla-portraits~ ~override~
END

COMPILE ~BG1NPCSoA/dialogues/7XSki.d~ 
COMPILE EVALUATE_BUFFER ~BG1NPCSoA/dialogues/7XSkiB.d~

ACTION_IF FILE_EXISTS_IN_GAME ~7XSkiJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XSkiJ.d~
END ELSE BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XSkiJ-Begin.d~
COMPILE ~BG1NPCSoA/dialogues/7XSkiJ.d~
END

ACTION_IF FILE_EXISTS_IN_GAME ~ETBNPC2.dlg~ BEGIN
OUTER_SET SkieKalandra = STATE_WHICH_SAYS 9 IN ~BG1NPCSoA\tra\%s\ETBNPC2.tra~ FROM ~ETBNPC2~
COMPILE EVALUATE_BUFFER ~BG1NPCSoA/dialogues/MISC/ETBNPC2skie.d~ USING ~BG1NPCSoA/tra/%LANGUAGE%/ETBNPC2.tra~
END

COMPILE EVALUATE_BUFFER ~BG1NPCSoA/scripts/7xskie.BAF~
EXTEND_TOP ~Ar0500.bcs~ ~BG1NPCSoA/scripts/AR0500_Skie.baf~

ACTION_IF NOT FILE_EXISTS_IN_GAME ~override/bimoen2.dlg~ THEN BEGIN
  <<<<<<<< BG1NPCSoA/dialogues/MISC/BIMOEN2.d
  BEGIN BIMOEN2
  >>>>>>>>
  COMPILE ~BG1NPCSoA/dialogues/MISC/BIMOEN2.d~
END


//Giving Imoen a banter file if the Fixpack isn't installed
ACTION_IF NOT FILE_EXISTS_IN_GAME ~cdbehbla.pro~ //makes sure the fixpack isn't already installed
THEN BEGIN
ACTION_IF FILE_EXISTS_IN_GAME ~saradush.mve~ THEN BEGIN
  COPY_EXISTING ~interdia.2da~ ~override~
    SET_2DA_ENTRY 17 1 2 ~BIMOEN2~ // fixes ToB version
    BUT_ONLY_IF_IT_CHANGES
END ELSE BEGIN
  APPEND ~interdia.2da~ ~IMOEN       BIMOEN2~ // fixes SoA version
    UNLESS ~BIMOEN2~
END
END

APPEND ~pdialog.2da~
~7XSki 7XSkiP 7XSkiJ 7XSkiD 7XSki25P 7XSki25J 7XSki25D 7XSki25~ 
UNLESS ~7XSki~


APPEND ~interdia.2da~
~7XSki 7XSkiB 7XSki25B~
UNLESS ~7XSki~

ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE4.cre~ BEGIN
  COPY_EXISTING ~7XCRE4.cre~ ~override~
    WRITE_EVALUATED_ASCII SCRIPT_OVERRIDE ~7XSKIE~ #8
  BUT_ONLY_IF_IT_CHANGES
END

COPY ~BG1NPCSoA/Items/SKIEx1.itm~ ~Override/SKIEx1.itm~
SAY NAME1 @276
SAY NAME2 @276
SAY UNIDENTIFIED_DESC @276
SAY DESC @277


// ELDOTH
ACTION_IF 
NOT FILE_EXISTS_IN_GAME ~M#Eldoth.cre~ AND
NOT FILE_EXISTS_IN_GAME ~RE_Eld.cre~
BEGIN

COPY ~BG1NPCSoA/Cre/7Xcre6.cre~ ~override/7Xcre6.cre~
SAY NAME1 @188
SAY NAME2 @189
SAY BIO @190
SAY INITIAL_MEETING ~~ 
  SAY MORALE ~~ 
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ [ELDOT12]
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ 
  SAY BORED @192
  SAY BATTLE_CRY1 ~~ 
  SAY BATTLE_CRY2 ~~ 
  SAY BATTLE_CRY3 ~~ 
  SAY BATTLE_CRY4 ~~ 
  SAY BATTLE_CRY5 ~~ 
  SAY DAMAGE ~~ [ELDOT34]
  SAY DYING ~~ [ELDOT37]
  SAY HURT ~~ 
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  @195
  SAY SELECT_COMMON2 @196
  SAY SELECT_COMMON3 @197 
  SAY SELECT_COMMON4 @198
  SAY SELECT_COMMON5 @199
  SAY SELECT_COMMON6 @200
  SAY SELECT_ACTION1 @201
  SAY SELECT_ACTION2 @202
  SAY SELECT_ACTION3 @203 
  SAY SELECT_ACTION4  ~~ [ELDOT24]
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ [ELDOT23]
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ 
  SAY SELECT_RARE2 ~~ 
  SAY CRITICAL_HIT ~~ 
  SAY CRITICAL_MISS ~~ 
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [ELDOT40]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END

LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Eldoth" oggdec_path = "BG1NPCSoA/sounds" END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~IMOEN!.wav~ BEGIN
LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Imoen" oggdec_path = "BG1NPCSoA/sounds" END
END

COMPILE ~BG1NPCSoA/dialogues/7XEldot.d~ 

ACTION_IF FILE_EXISTS_IN_GAME ~KGSTO2.dlg~ BEGIN
COMPILE EVALUATE_BUFFER ~BG1NPCSoA/dialogues/MISC/KGSTO2eldoth.d~ USING ~BG1NPCSoA/tra/%LANGUAGE%/KGSTO2.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~BG1X20.dlg~ BEGIN
COMPILE EVALUATE_BUFFER ~BG1NPCSoA/crossbanter/Water Gardens comments/GARDENS-eldoth.d~ USING ~BG1NPCSoA/tra/%LANGUAGE%/BG1X10.tra~
END

COMPILE ~BG1NPCSoA/scripts/7xELDO.BAF~
EXTEND_TOP ~Ar0800.bcs~ ~BG1NPCSoA/scripts/AR0800_Eldoth.baf~

APPEND ~pdialog.2da~
~7XEldot	7XEldoP		7XEldoJ		7XEldoD  7XEld25P 7XEld25J 7XEld25D 7XEld25~
UNLESS ~7XEldo~


APPEND ~interdia.2da~
  ~7XEldot     B7XEldo       B7XEld25~
  UNLESS ~7XEldot~

ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE6.cre~ BEGIN
  COPY_EXISTING ~7XCRE6.cre~ ~override~
    WRITE_EVALUATED_ASCII SCRIPT_OVERRIDE ~7XELDO~ #8
	WRITE_EVALUATED_ASCII SCRIPT_DEFAULT ~~ #8
  BUT_ONLY_IF_IT_CHANGES
END

COPY ~BG1NPCSoA/Items/BG1NPC9.itm~ ~Override/BG1NPC9.itm~
SAY NAME1 @426		
SAY NAME2 @426
SAY UNIDENTIFIED_DESC @426
SAY DESC @427
ACTION_IF GAME_IS ~bg2ee eet~ BEGIN
	APPEND ~item_use.2da~ ~AROW14     ELDOTH     10221      2          6254~ UNLESS ~AROW14     ELDOTH~
	APPEND ~item_use.2da~ ~AROW14     7XELDOT     10221      2          6254~ UNLESS ~AROW14     7XELDOT~
	APPEND ~item_use.2da~ ~BG1NPC9     ELDOTH     10221      2          6254~ UNLESS ~BG1NPC9     ELDOTH~
	APPEND ~item_use.2da~ ~BG1NPC9     7XELDOT     10221      2          6254~ UNLESS ~BG1NPC9     7XELDOT~
END

COPY ~BG1NPCSoA/Spells/spin116.SPL~ ~override/spin116.SPL~
SAY NAME1  @428
SAY UNIDENTIFIED_DESC @428

END ELSE BEGIN
  PRINT @207
END



BEGIN @1906 DESIGNATED 10
GROUP ~Main Mod~
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~
REQUIRE_PREDICATE (NOT FILE_EXISTS_IN_GAME ~o#bran.cre~) AND
NOT (FILE_EXISTS_IN_GAME ~_branwe5.cre~) AND // tutu Branwen
NOT (FILE_EXISTS_IN_GAME ~dl#bwn.cre~) AND 
NOT (FILE_EXISTS_IN_GAME ~wlbran0.cre~)
~Branwen already found; skipping to next NPC~

// BRANWEN

COPY_EXISTING ~sw1h01.itm~ ~override/7xbg1n.mrk~ // This file helps to determine if at least one component is installed - to disable the installation of the audio component and cross-banters if none of the main components is installed.
COPY_EXISTING ~sw1h01.itm~ ~override/FirstComp.mrk~ // For enable the installation of the ToB component is installed.

APPEND ~STATE.IDS~ ~0x80101FEF CD_STATE_NOTVALID~
UNLESS ~CD_STATE_NOTVALID~

COPY ~BG1NPCSoA/Cre/7Xcre5.cre~ ~override/7Xcre5.cre~
SAY NAME1 @158
SAY NAME2 @158
SAY BIO @159
SAY INITIAL_MEETING ~~ [branwen0]
  SAY MORALE ~~ 
  SAY HAPPY @161
  SAY UNHAPPY_ANNOYED @162
  SAY UNHAPPY_SERIOUS @163 
  SAY UNHAPPY_BREAKING @164
  SAY LEADER @165
  SAY TIRED ~~ [branwenc]
  SAY BORED @167
  SAY BATTLE_CRY1 @168
  SAY BATTLE_CRY2 @169
  SAY BATTLE_CRY3 ~~ [branwenz]
  SAY BATTLE_CRY4 ~~ [branwena]
  SAY BATTLE_CRY5 ~~ [branwena]
  SAY DAMAGE ~~ 
  SAY DYING ~~ [branwene]
  SAY HURT @173
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  @174
  SAY SELECT_COMMON2 @175
  SAY SELECT_COMMON3 @176
  SAY SELECT_COMMON4 @177
  SAY SELECT_COMMON5 @176
  SAY SELECT_COMMON6 @174 
  SAY SELECT_ACTION1 @178
  SAY SELECT_ACTION2 @179
  SAY SELECT_ACTION3 @180
  SAY SELECT_ACTION4  ~~ [branweng]
  SAY SELECT_ACTION5 ~~ [branwenz]
  SAY SELECT_ACTION6 ~~ [branwenm]
  SAY SELECT_ACTION7 ~~ [branwen5]
  SAY SELECT_RARE1 @177
  SAY SELECT_RARE2 ~~ [branweng]
  SAY CRITICAL_HIT ~~ [branwenz]
  SAY CRITICAL_MISS ~~ [branwenm]
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ [branwenq]
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL @185
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 @186

COPY ~BG1NPCSoA/cre/TRANZIG/7Xcre8.cre~ ~override/7Xcre8.cre~
SAY NAME1 @209
SAY NAME2 @209

LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Branwen" oggdec_path = "BG1NPCSoA/sounds" END

COMPILE ~BG1NPCSoA/dialogues/7XBRANB.d~ 
COMPILE ~BG1NPCSoA/dialogues/7XBRANJ.d~ 
COMPILE ~BG1NPCSoA/dialogues/7XBRAN.d~ 
COMPILE ~BG1NPCSoA/dialogues/TRANZIG/7XTRANZ.d~

ACTION_IF FILE_EXISTS_IN_GAME ~ETBNPC2.dlg~ BEGIN
OUTER_SET BranCalandra = STATE_WHICH_SAYS 76 IN ~BG1NPCSoA\tra\%s\etbnpc2.tra~ FROM ~ACOLYTE1~
COMPILE EVALUATE_BUFFER ~BG1NPCSoA/dialogues/MISC/ETBNPC2bran.d~ USING ~BG1NPCSoA/tra/%LANGUAGE%/etbnpc2.tra~
END

COMPILE ~BG1NPCSoA/scripts/7xbran.BAF~
EXTEND_TOP ~AR0701.bcs~ ~BG1NPCSoA/scripts/TRANZIG/AR0701.baf~
EXTEND_TOP ~Ar0900.bcs~ ~BG1NPCSoA/scripts/AR0900_Branwen.baf~


ACTION_IF NOT FILE_EXISTS_IN_GAME ~override/bimoen2.dlg~ THEN BEGIN
  <<<<<<<< BG1NPCSoA/dialogues/MISC/BIMOEN2.d
  BEGIN BIMOEN2
  >>>>>>>>
  COMPILE ~BG1NPCSoA/dialogues/MISC/BIMOEN2.d~
END


//Giving Imoen a banter file if the Fixpack isn't installed
ACTION_IF NOT FILE_EXISTS_IN_GAME ~cdbehbla.pro~ //makes sure the fixpack isn't already installed
THEN BEGIN
ACTION_IF FILE_EXISTS_IN_GAME ~saradush.mve~ THEN BEGIN
  COPY_EXISTING ~interdia.2da~ ~override~
    SET_2DA_ENTRY 17 1 2 ~BIMOEN2~ // fixes ToB version
    BUT_ONLY_IF_IT_CHANGES
END ELSE BEGIN
  APPEND ~interdia.2da~ ~IMOEN       BIMOEN2~ // fixes SoA version
    UNLESS ~BIMOEN2~
END
END

APPEND ~pdialog.2da~ // SOA 
~7XBRAN 7XBRANP 7XBRANJ 7XBRAND 7XBRA25P 7XBRA25J 7XBRA25D 7XBRA25~
UNLESS ~7XBRAN~


APPEND ~interdia.2da~
  ~7XBRAN      7XBRANB       B7XBRA25~
  UNLESS ~7XBRAN~

ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE5.cre~ BEGIN
  COPY_EXISTING ~7XCRE5.cre~ ~override~
    WRITE_EVALUATED_ASCII SCRIPT_OVERRIDE ~7XBRAN~ #8
  BUT_ONLY_IF_IT_CHANGES
END 

COPY ~BG1NPCSoA/Items/bgsx80.itm~ ~Override/bgsx80.itm~
SAY NAME1 @525
SAY NAME2 @525
SAY UNIDENTIFIED_DESC @525
SAY DESC @526

ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
COPY ~BG1NPCSoA/portraits/Branwen/EE-portraits/~ ~override~
END ELSE BEGIN
COPY ~BG1NPCSoA/portraits/Branwen/vanilla-portraits~ ~override~
END


////////////
BEGIN @1703 /*DESIGNATED 15*/ INSTALL_BY_DEFAULT
GROUP ~Main Mod~
REQUIRE_PREDICATE GAME_IS ~tob bgt bg2ee eet~ ~ToB Is Required to Install This Component~

REQUIRE_PREDICATE (FILE_EXISTS_IN_GAME ~FirstComp.mrk~) ~To install this component you must install Shar-Teel, Yeslick, Garrick, Skie or Branwen component~

APPEND ~STATE.IDS~ ~0x80101FEF CD_STATE_NOTVALID~
UNLESS ~CD_STATE_NOTVALID~
COMPILE ~BG1NPCSoA/dialogues/TOBBanter1.d~ // This file creates the ToB dialog files for the first component (compiled separately and earlier, otherwise dialogs with IF_FILE_EXISTS checking for the presence of these files will not work when compiling the dialogs themselves)
COMPILE ~BG1NPCSoA/dialogues/TOBBanter2.d~ USING ~BG1NPCSoA/tra/%LANGUAGE%/TOBBanter1.tra~ // The dialogs of the first component are created in this file.

ACTION_IF FILE_EXISTS_IN_GAME ~balth2.bcs~ BEGIN // Ascension compatibility 
	COMPILE ~BG1NPCSoA/dialogues/TOBBanter3.d~ USING ~BG1NPCSoA/tra/%LANGUAGE%/TOBBanter1.tra~ 
END



ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE5.cre~ BEGIN // Branwen in ToB
	COMPILE ~BG1NPCSoA/dialogues/TOBBanter4-Branwen.d~ USING ~BG1NPCSoA/tra/%LANGUAGE%/TOBBanter1.tra~ 
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE3.cre~ BEGIN // Garrick in ToB
	COMPILE ~BG1NPCSoA/dialogues/TOBBanter4-Garrick.d~ USING ~BG1NPCSoA/tra/%LANGUAGE%/TOBBanter1.tra~ 
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE1.cre~ BEGIN // Sharteel in ToB
	COMPILE ~BG1NPCSoA/dialogues/TOBBanter4-Sharteel.d~ USING ~BG1NPCSoA/tra/%LANGUAGE%/TOBBanter1.tra~ 
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE2.cre~ BEGIN // Yeslick in ToB
	COMPILE ~BG1NPCSoA/dialogues/TOBBanter4-Yeslick.d~ USING ~BG1NPCSoA/tra/%LANGUAGE%/TOBBanter1.tra~ 
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE4.cre~ BEGIN // Skie & Eldoth in ToB 
	COMPILE ~BG1NPCSoA/dialogues/TOBBanter4-Skie.d~ USING ~BG1NPCSoA/tra/%LANGUAGE%/TOBBanter1.tra~ 
END

// Shar-Teel's Epilogue
EXTEND_TOP ~AR6200.bcs~ ~BG1NPCSoA/epilogues/Shar-Teel/AR6200.baf~
COPY ~BG1NPCSoA/epilogues/Shar-Teel/SharEp.2da~ ~override/SharEp.2da~
REPLACE ~99999~ @8009

// Garrick's Epilogue

// patch Nalia's epilogue
    COPY_EXISTING ~ar6200.bcs~ ~override/ar6200.bcs~
        DECOMPILE_AND_PATCH
        BEGIN
            REPLACE_TEXTUALLY ~Global("NaliaBio","GLOBAL",0)~ ~Global("GarrickNaliaRomance","GLOBAL",0) Global("NaliaBio","GLOBAL",0)~
        END

EXTEND_TOP ~AR6200.bcs~ ~BG1NPCSoA/epilogues/Garrick/AR6200.baf~
COPY ~BG1NPCSoA/epilogues/Garrick/GarrEp1.2da~ ~override/GarrEp1.2da~
REPLACE ~99999~ @8010

COPY ~BG1NPCSoA/epilogues/Garrick/GarrEp2.2da~ ~override/GarrEp2.2da~
REPLACE ~99999~ @8017

COPY ~BG1NPCSoA/epilogues/Garrick/NaliaEp1.2da~ ~override/NaliaEp1.2da~
REPLACE ~99999~ @8016

// Yeslick's Epilogue
EXTEND_TOP ~AR6200.bcs~ ~BG1NPCSoA/epilogues/Yeslick/AR6200.baf~
COPY ~BG1NPCSoA/epilogues/Yeslick/YeslEp.2da~ ~override/YeslEp.2da~
REPLACE ~99999~ @8011

// Skie's Epilogue
EXTEND_TOP ~AR6200.bcs~ ~BG1NPCSoA/epilogues/Skie/AR6200.baf~
COPY ~BG1NPCSoA/epilogues/Skie/SkieEp.2da~ ~override/SkieEp.2da~
REPLACE ~99999~ @8012

// Branwen's Epilogue
EXTEND_TOP ~AR6200.bcs~ ~BG1NPCSoA/epilogues/Branwen/AR6200.baf~
COPY ~BG1NPCSoA/epilogues/Branwen/BranEp.2da~ ~override/BranEp.2da~
REPLACE ~99999~ @8013

// EET Fate Spirit Shar-Teel

ACTION_IF (GAME_IS ~eet~) BEGIN
INCLUDE ~EET/other/EET_functions.tph~ // functions from EET mod

// remove duplication in the call dialog with the option of the original EET
<<<<<<<< Shar_fix.baf
IF
	!Global("SharTeelSummoned","GLOBAL",2)
THEN
	RESPONSE #100
		SetGlobal("SharTeelSummoned","GLOBAL",2)
		Continue()
END
>>>>>>>>
EXTEND_BOTTOM ~AR4000.bcs~ ~Shar_fix.baf~

//// Create and install a missing ToB-script file to avoid installation errors and not to use a script from the BG1&SOA
ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/7Xshar.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/7Xshar.baf~
END ELSE BEGIN
<<<<<<<<7Xshar.baf
>>>>>>>>
	COMPILE ~7Xshar.baf~
END

ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/7Xsha25.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/7Xsha25.baf~ END
ELSE BEGIN
<<<<<<<<7Xsha25.baf
>>>>>>>>
COMPILE ~7Xsha25.baf~
END


LAF ~EET_NPC_TRANSITION~
INT_VAR
type = 2 // NPC is summon-able if met before
default_ToB = 1
STR_VAR
dv = "7Xshar" // death variable
override_SoA = "7Xshar" // override script (SoA)
override_ToB = "7Xsha25" // override script (ToB)
cre_ToB = "7XCRE1"
dialog_ToB = "7Xshar" // joining dialogue for ToB
traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/TOBBanter1.tra"
string = "@22"
stringPosDV = "Skie"
END
OUTER_SPRINT ~tob_override~ ~7Xsha25~
OUTER_SPRINT ~tob_var~ ~7XsharTOBSummon~
EXTEND_TOP ~7Xshar.bcs~ ~fix_tob_script.baf~ EVALUATE_BUFFER
END

// EET Fate Spirit Yeslick

ACTION_IF (GAME_IS ~eet~) BEGIN
INCLUDE ~EET/other/EET_functions.tph~ // functions from EET mod

// remove duplication in the call dialog with the option of the original EET
<<<<<<<< Yeslick_fix.baf
IF
	!Global("YeslickSummoned","GLOBAL",2)
THEN
	RESPONSE #100
		SetGlobal("YeslickSummoned","GLOBAL",2)
		Continue()
END
>>>>>>>>
EXTEND_BOTTOM ~AR4000.bcs~ ~Yeslick_fix.baf~

//// Create and install a missing ToB-script file to avoid installation errors and not to use a script from the BG1&SOA
ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/7XYESL.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/7XYESL.baf~
END ELSE BEGIN
<<<<<<<<7XYESL.baf
>>>>>>>>
	COMPILE ~7XYESL.baf~
END

ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/7XYES25.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/7XYES25.baf~ END
ELSE BEGIN
<<<<<<<<7XYES25.baf
>>>>>>>>
COMPILE ~7XYES25.baf~
END


LAF ~EET_NPC_TRANSITION~
INT_VAR
type = 2 // NPC is summon-able if met before
default_ToB = 1
STR_VAR
dv = "7XYES" // death variable
override_SoA = "7XYESL" // override script (SoA)
override_ToB = "7XYES25" // override script (ToB)
cre_ToB = "7XCRE2"
dialog_ToB = "7XYES" // joining dialogue for ToB
traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/TOBBanter1.tra"
string = "@24"
stringPosDV = "Yoshimo"
END
OUTER_SPRINT ~tob_override~ ~7XYES25~
OUTER_SPRINT ~tob_var~ ~YeslickTOBSummon~
EXTEND_TOP ~7XYESL.bcs~ ~fix_tob_script.baf~ EVALUATE_BUFFER
END


// Add the ToB Garrick script
COMPILE ~%MOD_FOLDER%/scripts/7XGar25.baf~
EXTEND_TOP ~AR4000.bcs~ ~BG1NPCSoA/scripts/misc/AR4000Gar.baf~
EXTEND_TOP ~AR4500.bcs~ ~BG1NPCSoA/scripts/misc/AR4500Gar.baf~


// EET Fate Spirit Garrick

ACTION_IF (GAME_IS ~eet~) BEGIN
INCLUDE ~EET/other/EET_functions.tph~ // functions from EET mod

// remove duplication in the call dialog with the option of the original EET
<<<<<<<< Garrick_fix.baf
IF
	!Global("GarrickSummoned","GLOBAL",2)
THEN
	RESPONSE #100
		SetGlobal("GarrickSummoned","GLOBAL",2)
		Continue()
END
>>>>>>>>
EXTEND_BOTTOM ~AR4000.bcs~ ~Garrick_fix.baf~


LAF ~EET_NPC_TRANSITION~
INT_VAR
type = 2 // NPC is summon-able if met before
default_ToB = 1
STR_VAR
dv = "7XGAR" // death variable
override_SoA = "7XGARR" // override script (SoA)
override_ToB = "7XGar25" // override script (ToB)
cre_ToB = "7XCRE3"
dialog_ToB = "7XGAR" // joining dialogue for ToB
traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/TOBBanter1.tra"
string = "@26"
stringPosDV = "Glint"
END
OUTER_SPRINT ~tob_override~ ~7XGar25~
OUTER_SPRINT ~tob_var~ ~GarrickTOBSummon~
EXTEND_TOP ~7XGARR.bcs~ ~fix_tob_script.baf~ EVALUATE_BUFFER
END


// EET Fate Spirit Eldoth

ACTION_IF (GAME_IS ~eet~) BEGIN
INCLUDE ~EET/other/EET_functions.tph~ // functions from EET mod

// remove duplication in the call dialog with the option of the original EET
<<<<<<<< Eldoth_fix.baf
IF
	!Global("EldothSummoned","GLOBAL",2)
THEN
	RESPONSE #100
		SetGlobal("EldothSummoned","GLOBAL",2)
		Continue()
END
>>>>>>>>
EXTEND_BOTTOM ~AR4000.bcs~ ~Eldoth_fix.baf~

//// Create and install a missing ToB-script file to avoid installation errors and not to use a script from the BG1&SOA
ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/7XELDO.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/7XELDO.baf~
END ELSE BEGIN
<<<<<<<<7XELDO.baf
>>>>>>>>
	COMPILE ~7XELDO.baf~
END

ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/7XEld25.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/7XEld25.baf~ END
ELSE BEGIN
<<<<<<<<7XEld25.baf
>>>>>>>>
COMPILE ~7XEld25.baf~
END


LAF ~EET_NPC_TRANSITION~
INT_VAR
type = 2 // NPC is summon-able if met before
default_ToB = 1
STR_VAR
dv = "7XELDOT" // death variable
override_SoA = "7XELDO" // override script (SoA)
override_ToB = "7XEld25" // override script (ToB)
cre_ToB = "7XCRE6"
dialog_ToB = "7XELDOT" // joining dialogue for ToB
traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/TOBBanter1.tra"
string = "@27"
stringPosDV = "Faldorn"
END
OUTER_SPRINT ~tob_override~ ~7XEld25~
OUTER_SPRINT ~tob_var~ ~EldothTOBSummon~
EXTEND_TOP ~7XELDO.bcs~ ~fix_tob_script.baf~ EVALUATE_BUFFER
END

// EET Fate Spirit Branwen

ACTION_IF (GAME_IS ~eet~) BEGIN
INCLUDE ~EET/other/EET_functions.tph~ // functions from EET mod

// remove duplication in the call dialog with the option of the original EET
<<<<<<<< Branwen_fix.baf
IF
	!Global("BranwenSummoned","GLOBAL",2)
THEN
	RESPONSE #100
		SetGlobal("BranwenSummoned","GLOBAL",2)
		Continue()
END
>>>>>>>>
EXTEND_BOTTOM ~AR4000.bcs~ ~Branwen_fix.baf~

//// Create and install a missing ToB-script file to avoid installation errors and not to use a script from the BG1&SOA
ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/7xbran.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/7xbran.baf~
END ELSE BEGIN
<<<<<<<<7xbran.baf
>>>>>>>>
	COMPILE ~7xbran.baf~
END

ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/7XBRA25.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/7XBRA25.baf~ END
ELSE BEGIN
<<<<<<<<7XBRA25.baf
>>>>>>>>
COMPILE ~7XBRA25.baf~
END


LAF ~EET_NPC_TRANSITION~
INT_VAR
type = 2 // NPC is summon-able if met before
default_ToB = 1
STR_VAR
dv = "7XBRAN" // death variable
override_SoA = "7xbran" // override script (SoA)
override_ToB = "7XBRA25" // override script (ToB)
cre_ToB = "7XCRE5"
dialog_ToB = "7XBRAN" // joining dialogue for ToB
traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/TOBBanter1.tra"
string = "@23"
stringPosDV = "Cernd"
END
OUTER_SPRINT ~tob_override~ ~7XBRA25~
OUTER_SPRINT ~tob_var~ ~BranwenTOBSummon~
EXTEND_TOP ~7xbran.bcs~ ~fix_tob_script.baf~ EVALUATE_BUFFER
END

// EET Fate Spirit Skie

ACTION_IF (GAME_IS ~eet~) BEGIN
INCLUDE ~EET/other/EET_functions.tph~ // functions from EET mod

// remove duplication in the call dialog with the option of the original EET
<<<<<<<< Skie_fix.baf
IF
	!Global("SkieSummoned","GLOBAL",2)
THEN
	RESPONSE #100
		SetGlobal("SkieSummoned","GLOBAL",2)
		Continue()
END
>>>>>>>>
EXTEND_BOTTOM ~AR4000.bcs~ ~Skie_fix.baf~

//// Create and install a missing ToB-script file to avoid installation errors and not to use a script from the BG1&SOA
ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/7xskie.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/7xskie.baf~
END ELSE BEGIN
<<<<<<<<7xskie.baf
>>>>>>>>
	COMPILE ~7xskie.baf~
END

ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/7XSki25.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/7XSki25.baf~ END
ELSE BEGIN
<<<<<<<<7XSki25.baf
>>>>>>>>
COMPILE ~7XSki25.baf~
END


LAF ~EET_NPC_TRANSITION~
INT_VAR
type = 2 // NPC is summon-able if met before
default_ToB = 1
STR_VAR
dv = "7XSKI" // death variable
override_SoA = "7xskie" // override script (SoA)
override_ToB = "7XSki25" // override script (ToB)
cre_ToB = "7XCRE4"
dialog_ToB = "7XSKI" // joining dialogue for ToB
traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/TOBBanter1.tra"
string = "@25"
stringPosDV = "Tiax"
END
OUTER_SPRINT ~tob_override~ ~7XSki25~
OUTER_SPRINT ~tob_var~ ~SkieTOBSummon~
EXTEND_TOP ~7xskie.bcs~ ~fix_tob_script.baf~ EVALUATE_BUFFER
END

COMPILE ~BG1NPCSoA/dialogues/MISC/BG1X38.d~
EXTEND_TOP ~AR5200.bcs~ ~BG1NPCSoA/scripts/MISC/AR5200.baf~


COPY ~BG1NPCSoA/cre/MISC/7XCRE89.cre~ ~override/7XCRE89.cre~

SAY NAME1 @1706
SAY NAME2 @1706
SAY INITIAL_MEETING ~~ 
  SAY MORALE ~~ 
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~
  SAY UNHAPPY_SERIOUS ~~
SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ [lanari1]
  SAY BATTLE_CRY2 ~~ [lanari2]
  SAY BATTLE_CRY3 ~~ [lanari1]
  SAY BATTLE_CRY4 ~~ [lanari2]
  SAY BATTLE_CRY5 ~~ [lanari7]
  SAY DAMAGE ~~ [lanari4]
  SAY DYING ~~ [lanari9]
  SAY HURT ~~
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~
  SAY SELECT_COMMON1 ~~ [lanari@]
  SAY SELECT_COMMON2 ~~
  SAY SELECT_COMMON3 ~~ 
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ [lanari6]
  SAY SELECT_ACTION1 ~~ [lanari7]
  SAY SELECT_ACTION2 ~~ [lanari2]
  SAY SELECT_ACTION3 ~~ [lanari6]
  SAY SELECT_ACTION4  ~~ [lanari@]
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~
  SAY SELECT_RARE1 ~~ [lanari@]
  SAY SELECT_RARE2 ~~
  SAY CRITICAL_HIT ~~ [lanari@]
  SAY CRITICAL_MISS ~~ [lanari#]
  SAY TARGET_IMMUNE ~~ [lanari#]
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~
  SAY REACT_TO_DIE_GENERAL ~~ 
  SAY INTERACTION3 ~~ [lanari7]
  SAY COMPLIMENT1 ~~ 


COPY ~BG1NPCSoA/cre/MISC/7XCRE90.cre~ ~override/7XCRE90.cre~
SAY NAME1 @1715
SAY NAME2 @1715
SAY INITIAL_MEETING ~~ [lanari!]
  SAY MORALE ~~ 
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~
  SAY UNHAPPY_SERIOUS ~~
SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ [lanari!]
  SAY BATTLE_CRY2 ~~ [lanari@]
  SAY BATTLE_CRY3 ~~ [lanari@]
  SAY BATTLE_CRY4 ~~ [lanari!]
  SAY BATTLE_CRY5 ~~ [lanari@]
  SAY DAMAGE ~~ 
  SAY DYING ~~ [lanari9]
  SAY HURT ~~
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~
  SAY SELECT_COMMON1 ~~ [lanari@]
  SAY SELECT_COMMON2 ~~
  SAY SELECT_COMMON3 ~~ 
  SAY SELECT_COMMON4 ~~ 
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ [lanari@]
  SAY SELECT_ACTION2 ~~ 
  SAY SELECT_ACTION3 ~~ 
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~
  SAY SELECT_RARE1 ~~
  SAY SELECT_RARE2 ~~
  SAY CRITICAL_HIT ~~ [lanari@]
  SAY CRITICAL_MISS ~~ [lanari#]
  SAY TARGET_IMMUNE ~~ [lanari#]
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~
  SAY REACT_TO_DIE_GENERAL ~~ 
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~

///
COPY ~BG1NPCSoA/cre/MISC/7XCRE91.cre~ ~override/7XCRE91.cre~
SAY NAME1 @1717
SAY NAME2 @1717

COPY ~BG1NPCSoA/cre/MISC/7XCRE92.cre~ ~override/7XCRE92.cre~
SAY NAME1 @1718
SAY NAME2 @1718

ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
COPY ~BG1NPCSoA/portraits/MAIN/EE-portraits/HF17S.BMP~ ~override/HF17S.BMP~
COPY ~BG1NPCSoA/portraits/MAIN/EE-portraits/ZOPANs.BMP~ ~override/ZOPANs.BMP~
END ELSE BEGIN
COPY ~BG1NPCSoA/portraits/MAIN/vanilla-portraits/HF17S.BMP~ ~override/HF17S.BMP~
COPY ~BG1NPCSoA/portraits/MAIN/vanilla-portraits/ZOPANs.BMP~ ~override/ZOPANs.BMP~
END

COMPILE ~BG1NPCSoA/dialogues/MISC/BG1X39.d~
COMPILE ~BG1NPCSoA/dialogues/MISC/BG1X40.d~

COPY ~BG1NPCSoA/Items/bgsx20.itm~ ~Override/bgsx20.itm~
SAY NAME1 @1719
SAY NAME2 @1719
SAY UNIDENTIFIED_DESC @1719
SAY DESC @1719

COPY ~BG1NPCSoA/cre/MISC/7XCRE93.cre~ ~override/7XCRE93.cre~
SAY NAME1 @1720
SAY NAME2 @1720

COPY ~BG1NPCSoA/store/BG1TOB1.sto~ ~override~
SAY NAME2 @1721

COMPILE ~BG1NPCSoA/dialogues/MISC/BG1X41.d~

COPY ~BG1NPCSoA/Items/TOB7X1.itm~ ~Override/TOB7X1.itm~
SAY NAME1 @1722
SAY NAME2 @1722
SAY UNIDENTIFIED_DESC @1722
SAY DESC @1722

COPY ~BG1NPCSoA/Spells/ASTRO.SPL~ ~Override/ASTRO.SPL~
SAY NAME1  @1722
 SAY UNIDENTIFIED_DESC @1723

COPY ~BG1NPCSoA/Items/TOB7X2.itm~ ~Override/TOB7X2.itm~
SAY NAME1 @1724
SAY NAME2 @1724
SAY UNIDENTIFIED_DESC @1724
SAY DESC @1724 

COPY ~BG1NPCSoA/Spells/POLSLAY.SPL~ ~Override/POLSLAY.SPL~
SAY NAME1  @1724
 SAY UNIDENTIFIED_DESC @1725


COPY ~BG1NPCSoA/Spells/WraithF.SPL~ ~Override/WraithF.SPL~
SAY NAME1  @491
 SAY UNIDENTIFIED_DESC @492

COPY ~BG1NPCSoA/Items/TOB7X3.itm~ ~Override/TOB7X3.itm~
SAY NAME1 @491
SAY NAME2 @491
SAY UNIDENTIFIED_DESC @491
SAY DESC @491 

EXTEND_TOP ~AR5500.bcs~ ~BG1NPCSoA/scripts/MISC/AR5500.baf~
EXTEND_TOP ~AR4500.bcs~ ~BG1NPCSoA/scripts/MISC/AR4500.baf~ 


/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

BEGIN @633 DESIGNATED 20
GROUP ~Main Mod~
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~
REQUIRE_PREDICATE ((NOT FILE_EXISTS_IN_GAME ~BDSafmam.cre~) AND
                   (NOT FILE_EXISTS_IN_GAME ~BDSafPir.CRE~)) AND
                  (NOT FILE_EXISTS_IN_GAME ~O#Coran.cre~) ~Coran or Safana already found; skipping to next NPC~

COPY_EXISTING ~sw1h01.itm~ ~override/7xbg1n.mrk~ // This file helps to determine if at least one component is installed - to disable the installation of the audio component and cross-banters if none of the main components is installed.

APPEND ~STATE.IDS~ ~0x80101FEF CD_STATE_NOTVALID~
UNLESS ~CD_STATE_NOTVALID~

// Set the portrait for Safana before joining to the group
ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN	
INCLUDE ~%MOD_FOLDER%/lib/standardEE.tph~		
	OUTER_SET s9total=0
	OUTER_SET rows_cnt_1=0
	COPY - ~%MOD_FOLDER%/portraits/C6SAFA.tbl~  ~%MOD_FOLDER%/portraits/C6SAFA.tbl~
		COUNT_2DA_ROWS 1 "rows_cnt_1"
			FOR( cntg=0; cntg<"%rows_cnt_1%"; cntg+=1 ) BEGIN
				READ_2DA_ENTRY cntg  0 2 "Crename"
				READ_2DA_ENTRY cntg  1 2 "Filename"
				INNER_ACTION BEGIN
					ACTION_IF FILE_EXISTS_IN_GAME ~%Crename%.cre~ THEN BEGIN
						OUTER_SET s9total+=1
						LAUNCH_ACTION_MACRO ~Addpic~ 
					END
				END
END
END
ELSE BEGIN
INCLUDE ~%MOD_FOLDER%/lib/standardold.tph~	
	OUTER_SET s9total=0
	OUTER_SET rows_cnt_1=0
	COPY - ~%MOD_FOLDER%/portraits/C6SAFA.tbl~  ~%MOD_FOLDER%/portraits/C6SAFA.tbl~
		COUNT_2DA_ROWS 1 "rows_cnt_1"
			FOR( cntg=0; cntg<"%rows_cnt_1%"; cntg+=1 ) BEGIN
				READ_2DA_ENTRY cntg  0 2 "Crename"
				READ_2DA_ENTRY cntg  1 2 "Filename"
				INNER_ACTION BEGIN
					ACTION_IF FILE_EXISTS_IN_GAME ~%Crename%.cre~ THEN BEGIN
						OUTER_SET s9total+=1
						LAUNCH_ACTION_MACRO ~Addpic~ 
					END
				END
END
END	

COPY ~BG1NPCSoA/Cre/7Xcre62.cre~ ~override/7Xcre62.cre~
SAY NAME1 @634
SAY NAME2 @634
SAY BIO @635
SAY INITIAL_MEETING ~~ [SAFANAF]
  SAY MORALE ~~ 
  SAY HAPPY ~~ [SAFANAR]
  SAY UNHAPPY_ANNOYED @638 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING @639
  SAY LEADER @640
  SAY TIRED @641
  SAY BORED @642
  SAY BATTLE_CRY1 ~~ 
  SAY BATTLE_CRY2 ~~ 
  SAY BATTLE_CRY3 ~~ 
  SAY BATTLE_CRY4 ~~ 
  SAY BATTLE_CRY5 ~~ 
  SAY DAMAGE ~~ [SAFANAE]
  SAY DYING ~~ [SAFANAM]
  SAY HURT ~~ [SAFANAL]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ [SAFANAO]
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ [SAFANAR]
  SAY SELECT_COMMON1  @647
  SAY SELECT_COMMON2 @648 
  SAY SELECT_COMMON3 ~~ 
  SAY SELECT_COMMON4 ~~ [SAFANAF]
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 @649
  SAY SELECT_ACTION2 ~~ [SAFANAJ]
  SAY SELECT_ACTION3 ~~ [SAFANAK]
  SAY SELECT_ACTION4  ~~ [SAFANAS]
  SAY SELECT_ACTION5 ~~ [SAFANAT]
  SAY SELECT_ACTION6 @654 
  SAY SELECT_ACTION7 @655 
  SAY SELECT_RARE1 ~~ [SAFANAD]
  SAY SELECT_RARE2 ~~ [SAFANAD]
  SAY CRITICAL_HIT ~~ 
  SAY CRITICAL_MISS ~~ 
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL @657
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END

// We import the variable of the romance with Safana from SoD to check its presence in the dialogue 
ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
APPEND ~VARIMPRT.2da~ ~5          BD_SAFANA_ROMANCEACTIVE~ 
END  
  

// Set the portrait for Coran before joining to the group
ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN	
INCLUDE ~%MOD_FOLDER%/lib/standardEE.tph~		
	OUTER_SET s9total=0
	OUTER_SET rows_cnt_1=0
	COPY - ~%MOD_FOLDER%/portraits/C6CORAN.tbl~  ~%MOD_FOLDER%/portraits/C6CORAN.tbl~
		COUNT_2DA_ROWS 1 "rows_cnt_1"
			FOR( cntg=0; cntg<"%rows_cnt_1%"; cntg+=1 ) BEGIN
				READ_2DA_ENTRY cntg  0 2 "Crename"
				READ_2DA_ENTRY cntg  1 2 "Filename"
				INNER_ACTION BEGIN
					ACTION_IF FILE_EXISTS_IN_GAME ~%Crename%.cre~ THEN BEGIN
						OUTER_SET s9total+=1
						LAUNCH_ACTION_MACRO ~Addpic~ 
					END
				END
END
END
ELSE BEGIN
INCLUDE ~%MOD_FOLDER%/lib/standardold.tph~	
	OUTER_SET s9total=0
	OUTER_SET rows_cnt_1=0
	COPY - ~%MOD_FOLDER%/portraits/C6CORAN.tbl~  ~%MOD_FOLDER%/portraits/C6CORAN.tbl~
		COUNT_2DA_ROWS 1 "rows_cnt_1"
			FOR( cntg=0; cntg<"%rows_cnt_1%"; cntg+=1 ) BEGIN
				READ_2DA_ENTRY cntg  0 2 "Crename"
				READ_2DA_ENTRY cntg  1 2 "Filename"
				INNER_ACTION BEGIN
					ACTION_IF FILE_EXISTS_IN_GAME ~%Crename%.cre~ THEN BEGIN
						OUTER_SET s9total+=1
						LAUNCH_ACTION_MACRO ~Addpic~ 
					END
				END
END
END	


COPY ~BG1NPCSoA/Cre/7Xcre63.cre~ ~override/7Xcre63.cre~
SAY NAME1 @658
SAY NAME2 @658
SAY BIO @659
SAY INITIAL_MEETING ~~ [CORAN+]
  SAY MORALE ~~ 
  SAY HAPPY @661
  SAY UNHAPPY_ANNOYED @662 
  SAY UNHAPPY_SERIOUS ~~ [coran33]
  SAY UNHAPPY_BREAKING ~~ [coran33]
  SAY LEADER @664
  SAY TIRED ~~ [CORANC]
  SAY BORED ~~ [CORAND]
  SAY BATTLE_CRY1 @667
  SAY BATTLE_CRY2 @668
  SAY BATTLE_CRY3 ~~ 
  SAY BATTLE_CRY4 ~~ 
  SAY BATTLE_CRY5 ~~ 
  SAY DAMAGE ~~ [CORANe]
  SAY DYING ~~ [CORANM]
  SAY HURT @671
  SAY AREA_FOREST ~~ [CORANQ]
  SAY AREA_CITY ~~ [CORANO]
  SAY AREA_DUNGEON ~~ [CORANQ]
  SAY AREA_DAY ~~ [CORANQ]
  SAY AREA_NIGHT ~~ [CORANr]
  SAY SELECT_COMMON1  @667
  SAY SELECT_COMMON2 @675
  SAY SELECT_COMMON3 @676
  SAY SELECT_COMMON4 @677
  SAY SELECT_COMMON5 ~~ [coranf]
  SAY SELECT_COMMON6 ~~ [CORANr]
  SAY SELECT_ACTION1 @679
  SAY SELECT_ACTION2 @680
  SAY SELECT_ACTION3 @681
  SAY SELECT_ACTION4  @682
  SAY SELECT_ACTION5 @683
  SAY SELECT_ACTION6 ~~ [CORAN26]
  SAY SELECT_ACTION7 ~~ [CORANi]
  SAY SELECT_RARE1 ~~ [coranf]
  SAY SELECT_RARE2 ~~ [CORAN26]
  SAY CRITICAL_HIT ~~ [CORAN20]
  SAY CRITICAL_MISS @687
  SAY TARGET_IMMUNE ~~ [CORAN6]
  SAY INVENTORY_FULL ~~ [CORAN20]
  SAY PICKED_POCKET @689
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ [CORAN6]
  SAY SET_A_TRAP ~~ [CORAN20]
  SAY REACT_TO_DIE_GENERAL @690
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END

LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Coran-Safana" oggdec_path = "BG1NPCSoA/sounds" END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~IMOEN!.wav~ BEGIN
LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Imoen" oggdec_path = "BG1NPCSoA/sounds" END
END

ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
   // If a EE-version is installed, change the journal entries to adapt it 
  ADD_JOURNAL @1774 @1775 @1804 @1807 USING ~%MOD_FOLDER%/tra/%LANGUAGE%/setup.tra~ 
END 

COPY ~BG1NPCSoA/Items/BG1NPC8.itm~ ~Override/BG1NPC8.itm~
SAY NAME1 @692		
SAY NAME2 @692
SAY UNIDENTIFIED_DESC @692
SAY DESC @693

COPY ~BG1NPCSoA/cre/Coran-Safana-Chronicles/7Xcre64.cre~ ~override/7Xcre64.cre~
SAY NAME1 @694
SAY NAME2 @694

COPY ~BG1NPCSoA/cre/Coran-Safana-Chronicles/7Xcre65.cre~ ~override/7Xcre65.cre~
SAY NAME1 @695
SAY NAME2 @695

ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
COPY ~BG1NPCSoA/portraits/Coran-Safana-Chronicles/EE-portraits~ ~override~
END ELSE BEGIN
COPY ~BG1NPCSoA/portraits/Coran-Safana-Chronicles/Vanilla-portraits~ ~override~
END

COPY ~BG1NPCSoA/BAM~ ~override~


COPY ~BG1NPCSoA/cre/Coran-Safana-Chronicles/7XCRE66.cre~ ~override/7XCRE66.cre~
SAY NAME1 @698
SAY NAME2 @698

COPY ~BG1NPCSoA/cre/Coran-Safana-Chronicles/7XCRE67.cre~ ~override/7XCRE67.cre~
SAY NAME1 @699
SAY NAME2 @699


COPY ~BG1NPCSoA/cre/Coran-Safana-Chronicles/7XCRE68.cre~ ~override/7XCRE68.cre~
SAY NAME1 @700
SAY NAME2 @700

COPY ~BG1NPCSoA/cre/Coran-Safana-Chronicles/7XCRE44.cre~ ~override/7XCRE44.cre~
SAY NAME1 @352
SAY NAME2 @352

COPY ~BG1NPCSoA/Items/bg1x23b.itm~ ~Override/bg1x23b.itm~
SAY NAME1 @353
SAY NAME2 @353
SAY UNIDENTIFIED_DESC @353
SAY DESC @353

COPY ~BG1NPCSoA/cre/Coran-Safana-Chronicles/7XCRE45.cre~ ~override/7XCRE45.cre~
SAY NAME1 @354
SAY NAME2 @354
SAY INITIAL_MEETING ~~ [BASIL01]
  SAY MORALE ~~ [BASIL01]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ [BASIL01]
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ [BASIL01]
  SAY BORED ~~ [BASIL01]
  SAY BATTLE_CRY1 ~~ [BASIL02]
  SAY BATTLE_CRY2 ~~ [BASIL01]
  SAY BATTLE_CRY3 ~~ [BASIL03]
  SAY BATTLE_CRY4 ~~ [BASIL02]
  SAY BATTLE_CRY5 ~~ [BASIL03]
  SAY DAMAGE ~~ [BASIL08]
  SAY DYING ~~ [BASIL10]
  SAY HURT ~~ [BASIL09]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [BASIL03]
  SAY SELECT_COMMON2 ~~ [BASIL01]
  SAY SELECT_COMMON3 ~~ [BASIL01]
  SAY SELECT_COMMON4 ~~ [BASIL01]
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ 
  SAY SELECT_ACTION2 ~~ 
  SAY SELECT_ACTION3 ~~ 
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ [BASIL01]
  SAY SELECT_RARE2 ~~ [BASIL01]
  SAY CRITICAL_HIT ~~ [BASIL03]
SAY CRITICAL_MISS ~~ [BASIL02]
SAY TARGET_IMMUNE ~~ [BASIL08]
SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [BASIL03]
  SAY INTERACTION3 ~~ [BASIL08]
  SAY COMPLIMENT1 ~~ [BASIL08]


COPY ~BG1NPCSoA/cre/Coran-Safana-Chronicles/7xcsqm.cre~ ~override/7xcsqm.cre~
SAY NAME1 @701
SAY NAME2 @701

COPY ~BG1NPCSoA/Items/PLATNUM.itm~ ~Override/PLATNUM.itm~
SAY NAME1 @303		
SAY NAME2 @303
SAY UNIDENTIFIED_DESC @303
SAY DESC @304

COPY ~BG1NPCSoA/Items/BG1NPC3.itm~ ~Override/BG1NPC3.itm~
SAY NAME1 @702
SAY NAME2 @702
SAY UNIDENTIFIED_DESC @702
SAY DESC @703

ACTION_IF NOT FILE_EXISTS_IN_GAME ~bdoffscr.cre~ BEGIN
COPY "%MOD_FOLDER%/cre/bdoffscr.cre" override
COPY "%MOD_FOLDER%/spells/bdoffscr.spl" override
END


COMPILE ~BG1NPCSoA/scripts/Coran-Safana-Chronicles/7xcoran.baf~
COMPILE ~BG1NPCSoA/scripts/Coran-Safana-Chronicles/7xsafa.baf~ EVALUATE_BUFFER
COMPILE ~BG1NPCSoA/scripts/Coran-Safana-Chronicles/7XSafaD.baf~
COMPILE ~BG1NPCSoA/scripts/Coran-Safana-Chronicles/7Xlanf.baf~
COPY ~BG1NPCSoA/scripts/Coran-Safana-Chronicles/bg1x22.bcs~ ~override/bg1x22.bcs~
EXTEND_TOP ~AR0709.bcs~ ~BG1NPCSoA/scripts/Coran-Safana-Chronicles/AR0709.baf~
COMPILE ~BG1NPCSoA/dialogues/Coran-Safana-Chronicles/c6coran.D~
EXTEND_TOP ~Ar0704.bcs~ ~BG1NPCSoA/scripts/Coran-Safana-Chronicles/AR0704.baf~
EXTEND_TOP ~Ar0408.bcs~ ~BG1NPCSoA/scripts/AR0408.baf~
EXTEND_TOP ~Ar0300.bcs~ ~BG1NPCSoA/scripts/Coran-Safana-Chronicles/AR0300.baf~
EXTEND_TOP ~Ar2600.bcs~ ~BG1NPCSoA/scripts/Coran-Safana-Chronicles/AR2600.baf~
COMPILE ~BG1NPCSoA/dialogues/7XCoran.d~

ACTION_IF FILE_EXISTS_IN_GAME ~7XCoranJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XCoranJ.d~
END ELSE BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XCoranJ-Begin.d~
COMPILE ~BG1NPCSoA/dialogues/7XCoranJ.d~
END


COMPILE ~BG1NPCSoA/dialogues/B7XSafa.d~
COMPILE ~BG1NPCSoA/dialogues/B7XCoran.d~
COMPILE ~BG1NPCSoA/dialogues/7XSafa.d~


ACTION_IF FILE_EXISTS_IN_GAME ~7XSafaJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XSafaJ.d~ EVALUATE_BUFFER
END ELSE BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XSafaJ-Begin.d~
COMPILE ~BG1NPCSoA/dialogues/7XSafaJ.d~ EVALUATE_BUFFER
END


COMPILE ~BG1NPCSoA/dialogues/Coran-Safana-Chronicles/BG1x27.d~
EXTEND_TOP ~Ar0020.bcs~ ~BG1NPCSoA/scripts/Coran-Safana-Chronicles/Ar0020.baf~
COMPILE ~BG1NPCSoA/dialogues/Coran-Safana-Chronicles/7xcsqm.d~
COMPILE ~BG1NPCSoA/dialogues/Coran-Safana-Chronicles/sqsah01.d~
COMPILE ~BG1NPCSoA/dialogues/Coran-Safana-Chronicles/BG1XLNF.d~

APPEND ~pdialog.2da~
~7XSafa	7XSafaP	7XSafaJ	7XSafaD  7XSaf25P 7XSaf25J 7XSaf25D 7XSaf25~
UNLESS ~7XSafa~
APPEND ~interdia.2da~
  ~7XSafa    B7XSafa       7XSaf25~
  UNLESS ~7XSafa~

APPEND ~pdialog.2da~
~7XCoran	7XCoranP 7XCoranJ	7XCoranD 7XCor25P 7XCor25J 7XCor25D 7XCora25~
UNLESS ~7XCoran~
APPEND ~interdia.2da~
  ~7XCoran     B7XCoran       B7XCor25~
  UNLESS ~7XCoran~


// Safana
ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE62.cre~ BEGIN
  COPY_EXISTING ~7XCRE62.cre~ ~override~
    WRITE_EVALUATED_ASCII SCRIPT_OVERRIDE ~7XSAFA~ #8
  BUT_ONLY_IF_IT_CHANGES
END

// Coran
ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE63.cre~ BEGIN
  COPY_EXISTING ~7XCRE63.cre~ ~override~
    WRITE_EVALUATED_ASCII SCRIPT_OVERRIDE ~7XCORAN~ #8
  BUT_ONLY_IF_IT_CHANGES
END


ACTION_IF NOT FILE_EXISTS_IN_GAME ~override/bimoen2.dlg~ THEN BEGIN
  <<<<<<<< BG1NPCSoA/dialogues/MISC/BIMOEN2.d
  BEGIN BIMOEN2
  >>>>>>>>
  COMPILE ~BG1NPCSoA/dialogues/MISC/BIMOEN2.d~
END



//Giving Imoen a banter file if the Fixpack isn't installed

ACTION_IF NOT FILE_EXISTS_IN_GAME ~cdbehbla.pro~ //makes sure the fixpack isn't already installed
THEN BEGIN
ACTION_IF FILE_EXISTS_IN_GAME ~saradush.mve~ THEN BEGIN
  COPY_EXISTING ~interdia.2da~ ~override~
    SET_2DA_ENTRY 17 1 2 ~BIMOEN2~ // fixes ToB version
    BUT_ONLY_IF_IT_CHANGES
END ELSE BEGIN
  APPEND ~interdia.2da~ ~IMOEN       BIMOEN2~ // fixes SoA version
    UNLESS ~BIMOEN2~
END
END

COMPILE ~BG1NPCSoA/dialogues/Coran-SafanaTOB.d~

// Coran's Epilogue
EXTEND_TOP ~AR6200.bcs~ ~BG1NPCSoA/epilogues/Coran/AR6200.baf~
COPY ~BG1NPCSoA/epilogues/Coran/CorEp.2da~ ~override/CorEp.2da~
REPLACE ~99999~ @8003

// Safana's Epilogue
EXTEND_TOP ~AR6200.bcs~ ~BG1NPCSoA/epilogues/Safana/AR6200.baf~
COPY ~BG1NPCSoA/epilogues/Safana/SafaEp.2da~ ~override/SafaEp.2da~
REPLACE ~99999~ @8004

// EET Fate Spirit Coran-Safana

ACTION_IF (GAME_IS ~eet~) BEGIN
INCLUDE ~EET/other/EET_functions.tph~ // functions from EET mod

// remove duplication in the call dialog with the option of the original EET
<<<<<<<< CORAN_fix.baf
IF
	!Global("CoranSummoned","GLOBAL",2)
THEN
	RESPONSE #100
		SetGlobal("CoranSummoned","GLOBAL",2)
		Continue()
END
>>>>>>>>
EXTEND_BOTTOM ~AR4000.bcs~ ~CORAN_fix.baf~

//// Create and install a missing ToB-script file to avoid installation errors and not to use a script from the BG1&SOA
ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/Coran-Safana-Chronicles/7XCora25.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/Coran-Safana-Chronicles/7XCora25.baf~ END
ELSE BEGIN
<<<<<<<<7XCora25.baf
>>>>>>>>
COMPILE ~7XCora25.baf~
END

LAF ~EET_NPC_TRANSITION~
INT_VAR
type = 2 // NPC is summon-able if met before
default_ToB = 1
STR_VAR
dv = "7XCORAN" // death variable 
override_SoA = "7XCORAN" // override script (SoA)
override_ToB = "7XCora25" // override script (ToB)
cre_ToB = "7XCRE63"
dialog_ToB = "7XCORAN" // joining dialogue for ToB
traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/Coran-SafanaTOB.tra"
string = "@7"
stringPosDV = "Corwin"
END
OUTER_SPRINT ~tob_override~ ~7XCora25~
OUTER_SPRINT ~tob_var~ ~CORANSummonedTOB~
EXTEND_TOP ~7XCORAN.bcs~ ~fix_tob_script.baf~ EVALUATE_BUFFER

// remove duplication in the call dialog with the option of the original EET
<<<<<<<< Safana_fix.baf
IF
	!Global("SafanaSummoned","GLOBAL",2)
THEN
	RESPONSE #100
		SetGlobal("SafanaSummoned","GLOBAL",2)
		Continue()
END
>>>>>>>>
EXTEND_BOTTOM ~AR4000.bcs~ ~Safana_fix.baf~

//// Create and install a missing ToB-script file to avoid installation errors and not to use a script from the BG1&SOA

ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/Coran-Safana-Chronicles/7XSaf25.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/Coran-Safana-Chronicles/7XSaf25.baf~ END
ELSE BEGIN
<<<<<<<<7XSaf25.baf
>>>>>>>>
COMPILE ~7XSaf25.baf~
END

LAF ~EET_NPC_TRANSITION~
INT_VAR
type = 2 // NPC is summon-able if met before
default_ToB = 1
STR_VAR
dv = "7XSAFA" // death variable 
override_SoA = "7XSAFA" // override script (SoA)
override_ToB = "7XSaf25" // override script (ToB)
cre_ToB = "7XCRE62"
dialog_ToB = "7XSafa" // joining dialogue for ToB
traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/Coran-SafanaTOB.tra"
string = "@6"
stringPosDV = "SharTeel"
END
OUTER_SPRINT ~tob_override~ ~7XSaf25~
OUTER_SPRINT ~tob_var~ ~SAFANASummonedTOB~
EXTEND_TOP ~7XSAFA.bcs~ ~fix_tob_script.baf~ EVALUATE_BUFFER
END


BEGIN @704 DESIGNATED 25
GROUP ~Main Mod~
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~
REQUIRE_PREDICATE (NOT FILE_EXISTS_IN_GAME ~ALORA09.CRE~) @744

COPY_EXISTING ~sw1h01.itm~ ~override/7xbg1n.mrk~

APPEND ~STATE.IDS~ ~0x80101FEF CD_STATE_NOTVALID~
UNLESS ~CD_STATE_NOTVALID~

COPY ~BG1NPCSoA/Cre/7XCRE69.cre~ ~override/7XCRE69.cre~
SAY NAME1 @706
SAY NAME2 @706
SAY BIO @705
SAY INITIAL_MEETING ~~ [alora3]
  SAY MORALE ~~ 
  SAY HAPPY @707 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER @708
  SAY TIRED ~~ [alorac]
  SAY BORED @710
  SAY BATTLE_CRY1 @711
  SAY BATTLE_CRY2 ~~ [alora8]
  SAY BATTLE_CRY3 ~~ [alora9] 
  SAY BATTLE_CRY4 ~~ [aloraa]
  SAY BATTLE_CRY5 ~~ [alora8]
  SAY DAMAGE ~~ [aloral]
  SAY DYING ~~ [aloram]
  SAY HURT ~~ [alorae]  
  SAY AREA_FOREST @718
  SAY AREA_CITY @719
  SAY AREA_DUNGEON ~~ [alorap]
  SAY AREA_DAY @721
  SAY AREA_NIGHT @722 
  SAY SELECT_COMMON1  @723
  SAY SELECT_COMMON2 @724
  SAY SELECT_COMMON3 @725
  SAY SELECT_COMMON4 ~~[alora_]
  SAY SELECT_COMMON5 ~~ [alora0] 
  SAY SELECT_COMMON6 ~~ [aloraf]
  SAY SELECT_ACTION1 ~~ [alorai] 
  SAY SELECT_ACTION2 ~~ [aloraj]  
  SAY SELECT_ACTION3 ~~ [alorai] 
  SAY SELECT_ACTION4  ~~ [aloraj]
  SAY SELECT_ACTION5 ~~ [alorat]
  SAY SELECT_ACTION6 ~~ [alorau] 
  SAY SELECT_ACTION7 @733
  SAY SELECT_RARE1 ~~ [alorax]
  SAY SELECT_RARE2 ~~ [aloray]
  SAY CRITICAL_HIT ~~ [aloraz]
  SAY CRITICAL_MISS ~~ [alora1]
  SAY TARGET_IMMUNE ~~ [alora2]
  SAY INVENTORY_FULL ~~ [alora3]
  SAY PICKED_POCKET @739
  SAY HIDDEN_IN_SHADOWS ~~ [alora5] 
  SAY SPELL_DISRUPTED ~~ [alora6]
  SAY SET_A_TRAP ~~ [alora7]
  SAY REACT_TO_DIE_GENERAL @743
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END

LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Alora" oggdec_path = "BG1NPCSoA/sounds" END

COMPILE ~BG1NPCSoA/scripts/7xAlor.baf~
COPY ~BG1NPCSoA/BAM~ ~override~


EXTEND_TOP ~AR0706.bcs~ ~BG1NPCSoA/scripts/AR0706.baf~


COMPILE ~BG1NPCSoA/dialogues/7XALORAB.d~
COMPILE ~BG1NPCSoA/dialogues/7XALORA.d~ 



APPEND ~pdialog.2da~
~7XAlora	7XAloraP 7XAloraJ 7XAloraD 7XAlo25P 7XAlo25J 7XAlo25D 7XAlor25~
UNLESS ~7XAlora~
APPEND ~interdia.2da~
  ~7XAlora     7XAloraB       B7XAlo25~
  UNLESS ~7XAlora~


// Alora
ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE69.cre~ BEGIN
  COPY_EXISTING ~7XCRE69.cre~ ~override~
    WRITE_EVALUATED_ASCII SCRIPT_OVERRIDE ~7XALOR~ #8
  BUT_ONLY_IF_IT_CHANGES
END




ACTION_IF NOT FILE_EXISTS_IN_GAME ~override/bimoen2.dlg~ THEN BEGIN
  <<<<<<<< BG1NPCSoA/dialogues/MISC/BIMOEN2.d
  BEGIN BIMOEN2
  >>>>>>>>
  COMPILE ~BG1NPCSoA/dialogues/MISC/BIMOEN2.d~
END


//Giving Imoen a banter file if the Fixpack isn't installed

ACTION_IF NOT FILE_EXISTS_IN_GAME ~cdbehbla.pro~ //makes sure the fixpack isn't already installed
  THEN BEGIN
  ACTION_IF FILE_EXISTS_IN_GAME ~saradush.mve~ THEN BEGIN
    COPY_EXISTING ~interdia.2da~ ~override~
      SET_2DA_ENTRY 17 1 2 ~BIMOEN2~ // fixes ToB version
      BUT_ONLY_IF_IT_CHANGES
  END ELSE BEGIN
    APPEND ~interdia.2da~ ~IMOEN       BIMOEN2~ // fixes SoA version
      UNLESS ~BIMOEN2~
  END
END

COMPILE ~BG1NPCSoA/dialogues/AloraTOB.d~

// Alora's epilogues

ACTION_IF NOT FILE_EXISTS_IN_GAME ~Eddekfhi.CRE~ BEGIN // check Edwin Romance mod install
EXTEND_TOP ~AR6200.bcs~ ~BG1NPCSoA/epilogues/Alora/AR6200.baf~
END ELSE BEGIN
EXTEND_TOP ~AR6200.bcs~ ~BG1NPCSoA/epilogues/Alora/AR6200ER.baf~
END

COPY ~BG1NPCSoA/epilogues/Alora/Alor1Ep.2da~ ~override/Alor1Ep.2da~
REPLACE ~99999~ @8014

COPY ~BG1NPCSoA/epilogues/Alora/Alor2Ep.2da~ ~override/Alor2Ep.2da~
REPLACE ~99999~ @8015

// EET Fate Spirit Alora

ACTION_IF (GAME_IS ~eet~) BEGIN
INCLUDE ~EET/other/EET_functions.tph~ // functions from EET mod

// remove duplication in the call dialog with the option of the original EET
<<<<<<<< ALORA_fix.baf
IF
	!Global("AloraSummoned","GLOBAL",2)
THEN
	RESPONSE #100
		SetGlobal("AloraSummoned","GLOBAL",2)
		Continue()
END
>>>>>>>>
EXTEND_BOTTOM ~AR4000.bcs~ ~ALORA_fix.baf~

//// Create and install a missing ToB-script file to avoid installation errors and not to use a script from the BG1&SOA
ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/7XALOR.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/7XALOR.baf~
END ELSE BEGIN
<<<<<<<<7XALOR.baf
>>>>>>>>
	COMPILE ~7XALOR.baf~
END

ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/MISC/7XAlor25.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/MISC/7XAlor25.baf~ END
ELSE BEGIN
<<<<<<<<7XAlor25.baf
>>>>>>>>
COMPILE ~7XAlor25.baf~
END

LAF ~EET_NPC_TRANSITION~
INT_VAR
type = 2 // NPC is summon-able if met before
default_ToB = 1
STR_VAR
dv = "7XALORA" // death variable in 
override_SoA = "7XALOR" // override script (SoA)
override_ToB = "7XAlor25" // override script (ToB)
cre_ToB = "7XCRE69"
dialog_ToB = "7XALORA" // joining dialogue for ToB
traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/AloraTOB.tra"
string = "@0"
stringPosDV = "Anomen"
END
OUTER_SPRINT ~tob_override~ ~7XAlor25~
OUTER_SPRINT ~tob_var~ ~AloraSummonedToB~
EXTEND_TOP ~7XALOR.bcs~ ~fix_tob_script.baf~ EVALUATE_BUFFER
END

ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
COPY ~BG1NPCSoA/portraits/Alora/EE-portraits/~ ~override~
END ELSE BEGIN
COPY ~BG1NPCSoA/portraits/Alora/vanilla-portraits~ ~override~
END




BEGIN @796 DESIGNATED 30
GROUP ~Main Mod~
SUBCOMPONENT @797
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~

COPY_EXISTING ~sw1h01.itm~ ~override/7xbg1n.mrk~

APPEND ~STATE.IDS~ ~0x80101FEF CD_STATE_NOTVALID~
UNLESS ~CD_STATE_NOTVALID~

// add Wilson dialog

ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN

<<<<<<<< wilson_dialog.d
BEGIN %wilson_dialog%
>>>>>>>>
ACTION_IF NOT FILE_EXISTS_IN_GAME ~BWILSON.dlg~ BEGIN
	OUTER_SPRINT ~wilson_dialog~ ~BWILSON~
	COMPILE ~wilson_dialog.d~ EVALUATE_BUFFER
END

APPEND ~interdia.2da~ ~WILSON BWILSON BWILSO25~
               UNLESS ~WILSON~

COPY_EXISTING ~pdialog.2da~ ~override~
  REPLACE_TEXTUALLY ~^[ %TAB%]*WILSON[ %TAB%].+$~
                    ~WILSON                 WILSONP                WILSONJ                WILSOND                WILSO25P               WILSO25J               WILSO25D               WILSON25~
BUT_ONLY

END

ACTION_IF FILE_EXISTS_IN_GAME ~KAGAIN11.cre~ BEGIN
// The code that is needed to remove Kagain from "The Darkest Day" mod and install Kagain from this mod instead
LAF CLEAR_SCRIPT_BLOCKS INT_VAR reverse = 1 STR_VAR search_text = ~KAGAINDD~ END
COPY_EXISTING ~AR0020.bcs~ ~override~
	DECOMPILE_AND_PATCH BEGIN
		SET start_offset = BUFFER_LENGTH - 1
		WHILE (start_offset >= 0) BEGIN
			LPF GET_SCRIPT_BLOCK INT_VAR reverse = 1 start_offset STR_VAR search_regexp = ~KAGAIN11~ RET start_offset end_offset END
			PATCH_IF start_offset >= 0 BEGIN
				DELETE_BYTES start_offset (end_offset - start_offset)
			END
		END
	END
	BUT_ONLY_IF_IT_CHANGES

COPY_EXISTING ~pdialog.2da~ ~override~
	REPLACE_TEXTUALLY ~[ %TAB%%LNL%%WNL%%MNL%]KAGAINDD.*$~ ~~

/*KAGAIN BGT + "The Darkest Day" mod compatibility*/
ACTION_IF GAME_IS ~bgt~ BEGIN
	COPY_EXISTING ~AR0020.bcs~ ~override~
		DECOMPILE_AND_PATCH BEGIN
			SET start_offset = BUFFER_LENGTH - 1
			WHILE (start_offset >= 0) BEGIN
				LPF GET_SCRIPT_BLOCK INT_VAR reverse = 1 start_offset STR_VAR search_regexp = ~BP_KagainBG1Check~ RET start_offset end_offset END
				PATCH_IF start_offset >= 0 BEGIN
					DELETE_BYTES start_offset (end_offset - start_offset)
				END
			END
		END
	BUT_ONLY_IF_IT_CHANGES

	OUTER_SPRINT ~aram00_bgt~ ~IF
    InParty("Kagain")
    Global("MeetOldenFriends","GLOBAL",22)
THEN
  RESPONSE #100
    ActionOverride("Kagain",LeaveParty())
    ActionOverride("Kagain",ChangeAIScript("",DEFAULT))
    ActionOverride("Kagain",ClearAllActions())
    ActionOverride("Kagain",DestroySelf())
    SetGlobal("MeetOldenFriends","GLOBAL",23)
    Continue()
END~
	OUTER_SET ~strlen~ = STRING_LENGTH ~%aram00_bgt%~

	COPY_EXISTING ~aram00.bcs~ ~override~
		DECOMPILE_AND_PATCH BEGIN
			LPF GET_SCRIPT_BLOCK STR_VAR search_regexp = ~KagainPartyBG1~ RET start_offset end_offset END
			PATCH_IF start_offset >= 0 BEGIN
				DELETE_BYTES start_offset (end_offset - start_offset)
				INSERT_BYTES start_offset strlen
				WRITE_ASCIIE start_offset ~%aram00_bgt%~
			END
		END
		BUT_ONLY_IF_IT_CHANGES
END

END
	
COPY ~BG1NPCSoA/Cre/7XCRE71.cre~ ~override/7XCRE71.cre~
SAY NAME1 @798
SAY NAME2 @799
SAY BIO @800
 SAY INITIAL_MEETING ~~ [KAGAIN4]
  SAY MORALE ~~ 
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED @802
  SAY UNHAPPY_SERIOUS @802
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER @803
  SAY TIRED @804
  SAY BORED ~~ [KAGAIND]
  SAY BATTLE_CRY1 ~~ [KAGAINA]
  SAY BATTLE_CRY2 ~~ [KAGAINK]
  SAY BATTLE_CRY3 ~~ [KAGAIN8]
  SAY BATTLE_CRY4 ~~ [KAGAINK]
  SAY BATTLE_CRY5 ~~ [KAGAIN8]
  SAY DAMAGE ~~ [KAGAINL]
  SAY DYING ~~ [KAGAINM]
  SAY HURT @811
  SAY AREA_FOREST ~~ [KAGAINN]
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [KAGAING]
  SAY SELECT_COMMON2 @814
  SAY SELECT_COMMON3 @815
  SAY SELECT_COMMON4 ~~ [KAGAING]
  SAY SELECT_COMMON5 @816
  SAY SELECT_COMMON6 @815
  SAY SELECT_ACTION1 @817
  SAY SELECT_ACTION2 @818
  SAY SELECT_ACTION3 @819 
  SAY SELECT_ACTION4  @817
  SAY SELECT_ACTION5 @818
  SAY SELECT_ACTION6 @819 
  SAY SELECT_ACTION7 @817
  SAY SELECT_RARE1 @820
  SAY SELECT_RARE2 @817
  SAY CRITICAL_HIT ~~ 
  SAY CRITICAL_MISS ~~ 
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET @821
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [KAGAIN!]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END

LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Kagain" oggdec_path = "BG1NPCSoA/sounds" END

ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
COPY ~BG1NPCSoA/portraits/Kagain/EE-portraits/~ ~override~
END ELSE BEGIN
COPY ~BG1NPCSoA/portraits/Kagain/vanilla-portraits~ ~override~
END

COPY ~BG1NPCSoA/Items/PLATNUM.itm~ ~Override/PLATNUM.itm~
SAY NAME1 @303		
SAY NAME2 @303
SAY UNIDENTIFIED_DESC @303
SAY DESC @823

COPY ~BG1NPCSoA/Items/DEPO1.itm~ ~Override/DEPO1.itm~
SAY NAME1 @824
SAY NAME2 @825
SAY UNIDENTIFIED_DESC @824
SAY DESC @826

COPY ~BG1NPCSoA/Items/DEPO2.itm~ ~Override/DEPO2.itm~
SAY NAME1 @827
SAY NAME2 @828
SAY UNIDENTIFIED_DESC @827
SAY DESC @829

COPY ~BG1NPCSoA/Items/DEPO3.itm~ ~Override/DEPO3.itm~
SAY NAME1 @366
SAY NAME2 @830
SAY UNIDENTIFIED_DESC @366
SAY DESC @831

COPY ~BG1NPCSoA/Items/DEPO4.itm~ ~Override/DEPO4.itm~
SAY NAME1 @827
SAY NAME2 @832
SAY UNIDENTIFIED_DESC @827
SAY DESC @833

COPY ~BG1NPCSoA/Items/DEPO5.itm~ ~Override/DEPO5.itm~
SAY NAME1 @283
SAY NAME2 @834
SAY UNIDENTIFIED_DESC @283
SAY DESC @835

COPY ~BG1NPCSoA/Items/DEPO6.itm~ ~Override/DEPO6.itm~
SAY NAME1 @283
SAY NAME2 @836
SAY UNIDENTIFIED_DESC @283
SAY DESC @837

COPY ~BG1NPCSoA/Items/DEPO7.itm~ ~Override/DEPO7.itm~
SAY NAME1 @824
SAY NAME2 @838
SAY UNIDENTIFIED_DESC @824
SAY DESC @839

COPY ~BG1NPCSoA/Items/DEPO8.itm~ ~Override/DEPO8.itm~
SAY NAME1 @840
SAY NAME2 @840
SAY UNIDENTIFIED_DESC @840
SAY DESC @841

COPY ~BG1NPCSoA/Items/DEPO9.itm~ ~Override/DEPO9.itm~
SAY NAME1 @366
SAY NAME2 @842
SAY UNIDENTIFIED_DESC @366
SAY DESC @843


COPY ~BG1NPCSoA/Items/DEPO10.itm~ ~Override/DEPO10.itm~
SAY NAME1 @382
SAY NAME2 @844
SAY UNIDENTIFIED_DESC @382
SAY DESC @845

COPY ~BG1NPCSoA/Items/DEPO11.itm~ ~Override/DEPO11.itm~
SAY NAME1 @369
SAY NAME2 @846
SAY UNIDENTIFIED_DESC @369
SAY DESC @847


COPY ~BG1NPCSoA/Items/DEPO12.itm~ ~Override/DEPO12.itm~
SAY NAME1 @369
SAY NAME2 @848
SAY UNIDENTIFIED_DESC @369
SAY DESC @849

COPY ~BG1NPCSoA/Items/DEPO13.itm~ ~Override/DEPO13.itm~
SAY NAME1 @369
SAY NAME2 @850
SAY UNIDENTIFIED_DESC @369
SAY DESC @851

COPY ~BG1NPCSoA/Items/DEPO14.itm~ ~Override/DEPO14.itm~
SAY NAME1 @827
SAY NAME2 @852
SAY UNIDENTIFIED_DESC @827
SAY DESC @853

COPY ~BG1NPCSoA/Items/DEPO15.itm~ ~Override/DEPO15.itm~
SAY NAME1 @827
SAY NAME2 @854
SAY UNIDENTIFIED_DESC @827
SAY DESC @855

COPY ~BG1NPCSoA/Items/DEPO16.itm~ ~Override/DEPO16.itm~
SAY NAME1 @856
SAY NAME2 @857
SAY UNIDENTIFIED_DESC @856
SAY DESC @858

COPY ~BG1NPCSoA/Items/DEPO17.itm~ ~Override/DEPO17.itm~
SAY NAME1 @827
SAY NAME2 @859
SAY UNIDENTIFIED_DESC @827
SAY DESC @860



COPY ~BG1NPCSoA/Items/DEPO19.itm~ ~Override/DEPO19.itm~
SAY NAME1 @861
SAY NAME2 @862
SAY UNIDENTIFIED_DESC @861
SAY DESC @863

COPY ~BG1NPCSoA/Items/DEPO20.itm~ ~Override/DEPO20.itm~
SAY NAME1 @366
SAY NAME2 @864
SAY UNIDENTIFIED_DESC @366
SAY DESC @865

COPY ~BG1NPCSoA/Items/DEPO21.itm~ ~Override/DEPO21.itm~
SAY NAME1 @382
SAY NAME2 @866
SAY UNIDENTIFIED_DESC @382
SAY DESC @867

COPY ~BG1NPCSoA/Items/DEPO22.itm~ ~Override/DEPO22.itm~
SAY NAME1 @868
SAY NAME2 @868
SAY UNIDENTIFIED_DESC @868
SAY DESC @869

COPY ~BG1NPCSoA/Items/DEPO23.itm~ ~Override/DEPO23.itm~
SAY NAME1 @870
SAY NAME2 @871
SAY UNIDENTIFIED_DESC @870
SAY DESC @872

COPY ~BG1NPCSoA/Items/DEPO24.itm~ ~Override/DEPO24.itm~
SAY NAME1 @382
SAY NAME2 @873
SAY UNIDENTIFIED_DESC @382
SAY DESC @874

COPY ~BG1NPCSoA/Items/DEPO25.itm~ ~Override/DEPO25.itm~
SAY NAME1 @875
SAY NAME2 @875
SAY UNIDENTIFIED_DESC @875
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@876" END

COPY ~BG1NPCSoA/Items/DEPO26.itm~ ~Override/DEPO26.itm~
SAY NAME1 @877
SAY NAME2 @877
SAY UNIDENTIFIED_DESC @877
SAY DESC @878

COPY ~BG1NPCSoA/Items/DEPO27.itm~ ~Override/DEPO27.itm~
SAY NAME1 @879
SAY NAME2 @879
SAY UNIDENTIFIED_DESC @879
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@880" END


COPY ~BG1NPCSoA/Items/DEPO28.itm~ ~Override/DEPO28.itm~
SAY NAME1 @881
SAY NAME2 @881
SAY UNIDENTIFIED_DESC @881
SAY DESC @882

COPY ~BG1NPCSoA/Items/DEPO29.itm~ ~Override/DEPO29.itm~
SAY NAME1 @883
SAY NAME2 @883
SAY UNIDENTIFIED_DESC @883
SAY DESC @884

COPY ~BG1NPCSoA/Items/DEPO30.itm~ ~Override/DEPO30.itm~
SAY NAME1 @885
SAY NAME2 @885
SAY UNIDENTIFIED_DESC @885
SAY DESC @886


COPY ~BG1NPCSoA/Items/DEPO31.itm~ ~Override/DEPO31.itm~
SAY NAME1 @369
SAY NAME2 @887
SAY UNIDENTIFIED_DESC @887
SAY DESC @888

COPY ~BG1NPCSoA/Items/DEPO32.itm~ ~Override/DEPO32.itm~
SAY NAME1 @827
SAY NAME2 @889
SAY UNIDENTIFIED_DESC @827
SAY DESC @890

COPY ~BG1NPCSoA/Items/DEPO33.itm~ ~Override/DEPO33.itm~
SAY NAME1 @891
SAY NAME2 @892
SAY UNIDENTIFIED_DESC @891
SAY DESC @893

COPY ~BG1NPCSoA/Items/DEPO34.itm~ ~Override/DEPO34.itm~
SAY NAME1 @891
SAY NAME2 @894
SAY UNIDENTIFIED_DESC @891
SAY DESC @895

COPY ~BG1NPCSoA/Items/DEPO35.itm~ ~Override/DEPO35.itm~
SAY NAME1 @870
SAY NAME2 @896
SAY UNIDENTIFIED_DESC @870
SAY DESC @897


COPY ~BG1NPCSoA/Items/DEPO36.itm~ ~Override/DEPO36.itm~
SAY NAME1 @250
SAY NAME2 @898
SAY UNIDENTIFIED_DESC @250
SAY DESC @899

COPY ~BG1NPCSoA/Items/DEPO37.itm~ ~Override/DEPO37.itm~
SAY NAME1 @382
SAY NAME2 @900
SAY UNIDENTIFIED_DESC @382
SAY DESC @901

COPY ~BG1NPCSoA/Items/DEPO38.itm~ ~Override/DEPO38.itm~
SAY NAME1 @366
SAY NAME2 @902
SAY UNIDENTIFIED_DESC @366
SAY DESC @903

COPY ~BG1NPCSoA/Items/DEPO39.itm~ ~Override/DEPO39.itm~
SAY NAME1 @366
SAY NAME2 @904
SAY UNIDENTIFIED_DESC @904
SAY DESC @905

COPY ~BG1NPCSoA/Items/DEPO40.itm~ ~Override/DEPO40.itm~
SAY NAME1 @906
SAY NAME2 @907
SAY UNIDENTIFIED_DESC @906
SAY DESC @908


COPY ~BG1NPCSoA/Items/DEPO41.itm~ ~Override/DEPO41.itm~
SAY NAME1 @827
SAY NAME2 @909
SAY UNIDENTIFIED_DESC @827
SAY DESC @910

COPY ~BG1NPCSoA/Items/DEPO42.itm~ ~Override/DEPO42.itm~
SAY NAME1 @382
SAY NAME2 @911
SAY UNIDENTIFIED_DESC @382
SAY DESC @912


COPY ~BG1NPCSoA/Items/DEPO43.itm~ ~Override/DEPO43.itm~
SAY NAME1 @891
SAY NAME2 @913
SAY UNIDENTIFIED_DESC @891
SAY DESC @914

COPY ~BG1NPCSoA/Items/DEPO44.itm~ ~Override/DEPO44.itm~
SAY NAME1 @915
SAY NAME2 @916
SAY UNIDENTIFIED_DESC @917
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@918" END


COPY ~BG1NPCSoA/Items/DEPO45.itm~ ~Override/DEPO45.itm~
SAY NAME1 @248
SAY NAME2 @248
SAY UNIDENTIFIED_DESC @248
SAY DESC @249


COPY ~BG1NPCSoA/Items/DEPO46.itm~ ~Override/DEPO46.itm~
SAY NAME1 @870
SAY NAME2 @919
SAY UNIDENTIFIED_DESC @870
SAY DESC @920


COPY ~BG1NPCSoA/Items/DEPO47.itm~ ~Override/DEPO47.itm~
SAY NAME1 @921
SAY NAME2 @922
SAY UNIDENTIFIED_DESC @921
SAY DESC @923


COPY ~BG1NPCSoA/Items/DEPO48.itm~ ~Override/DEPO48.itm~
SAY NAME1 @924
SAY NAME2 @925
SAY UNIDENTIFIED_DESC @924
SAY DESC @926

COPY ~BG1NPCSoA/Items/DEPO49.itm~ ~Override/DEPO49.itm~
SAY NAME1 @927
SAY NAME2 @928
SAY UNIDENTIFIED_DESC @927
SAY DESC @929


COPY ~BG1NPCSoA/Items/DEPO50.itm~ ~Override/DEPO50.itm~
SAY NAME1 @283
SAY NAME2 @930
SAY UNIDENTIFIED_DESC @283
SAY DESC @931



COPY ~BG1NPCSoA/Items/DEPO51.itm~ ~Override/DEPO51.itm~
SAY NAME1 @891
SAY NAME2 @932
SAY UNIDENTIFIED_DESC @891
SAY DESC @933

COPY ~BG1NPCSoA/Items/DEPO52.itm~ ~Override/DEPO52.itm~
SAY NAME1 @283
SAY NAME2 @934
SAY UNIDENTIFIED_DESC @283
SAY DESC @935

COPY ~BG1NPCSoA/Items/DEPO53.itm~ ~Override/DEPO53.itm~
SAY NAME1 @936
SAY NAME2 @937
SAY UNIDENTIFIED_DESC @936
SAY DESC @938

COPY ~BG1NPCSoA/Items/DEPO54.itm~ ~Override/DEPO54.itm~
SAY NAME1 @939
SAY NAME2 @940
SAY UNIDENTIFIED_DESC @939
SAY DESC @941

COPY ~BG1NPCSoA/Items/DEPO55.itm~ ~Override/DEPO55.itm~
SAY NAME1 @921
SAY NAME2 @942
SAY UNIDENTIFIED_DESC @921
SAY DESC @943

COPY ~BG1NPCSoA/Items/DEPO56.itm~ ~Override/DEPO56.itm~
SAY NAME1 @944
SAY NAME2 @945
SAY UNIDENTIFIED_DESC @944
SAY DESC @946

COPY ~BG1NPCSoA/Items/DEPO57.itm~ ~Override/DEPO57.itm~
SAY NAME1 @947
SAY NAME2 @947
SAY UNIDENTIFIED_DESC @947
SAY DESC @948


COPY ~BG1NPCSoA/Items/DEPO58.itm~ ~Override/DEPO58.itm~
SAY NAME1 @949
SAY NAME2 @950
SAY UNIDENTIFIED_DESC @949
SAY DESC @951


COPY ~BG1NPCSoA/Items/DEPO59.itm~ ~Override/DEPO59.itm~
SAY NAME1 @827
SAY NAME2 @952
SAY UNIDENTIFIED_DESC @827
SAY DESC @953

COPY ~BG1NPCSoA/Items/DEPO60.itm~ ~Override/DEPO60.itm~
SAY NAME1 @891
SAY NAME2 @954
SAY UNIDENTIFIED_DESC @955
SAY DESC @956

COPY ~BG1NPCSoA/Items/DEPO61.itm~ ~Override/DEPO61.itm~
SAY NAME1 @921
SAY NAME2 @957
SAY UNIDENTIFIED_DESC @921
SAY DESC @958

COPY ~BG1NPCSoA/Items/DEPO62.itm~ ~Override/DEPO62.itm~
SAY NAME1 @411
SAY NAME2 @959
SAY UNIDENTIFIED_DESC @411
SAY DESC @960


COPY ~BG1NPCSoA/Items/DEPO63.itm~ ~Override/DEPO63.itm~
SAY NAME1 @827
SAY NAME2 @961
SAY UNIDENTIFIED_DESC @827
SAY DESC @962

COPY ~BG1NPCSoA/Items/DEPO64.itm~ ~Override/DEPO64.itm~
SAY NAME1 @411
SAY NAME2 @963
SAY UNIDENTIFIED_DESC @411
SAY DESC @964


COPY ~BG1NPCSoA/Items/DEPO65.itm~ ~Override/DEPO65.itm~
SAY NAME1 @827
SAY NAME2 @965
SAY UNIDENTIFIED_DESC @827
SAY DESC @966

COPY ~BG1NPCSoA/Items/DEPO66.itm~ ~Override/DEPO66.itm~
SAY NAME1 @366
SAY NAME2 @967
SAY UNIDENTIFIED_DESC @366
SAY DESC @968

COPY ~BG1NPCSoA/Items/DEPO67.itm~ ~Override/DEPO67.itm~
SAY NAME1 @969
SAY NAME2 @970
SAY UNIDENTIFIED_DESC @969
SAY DESC @971

COPY ~BG1NPCSoA/Items/DEPO68.itm~ ~Override/DEPO68.itm~
SAY NAME1 @969
SAY NAME2 @972
SAY UNIDENTIFIED_DESC @969
SAY DESC @973

COPY ~BG1NPCSoA/Items/DEPO69.itm~ ~Override/DEPO69.itm~
SAY NAME1 @974
SAY NAME2 @974
SAY UNIDENTIFIED_DESC @974
SAY DESC @975

COPY ~BG1NPCSoA/Items/DEPO70.itm~ ~Override/DEPO70.itm~
SAY NAME1 @939
SAY NAME2 @976
SAY UNIDENTIFIED_DESC @939
SAY DESC @977


COPY ~BG1NPCSoA/Items/DEPO71.itm~ ~Override/DEPO71.itm~
SAY NAME1 @411
SAY NAME2 @978
SAY UNIDENTIFIED_DESC @411
SAY DESC @979

COPY ~BG1NPCSoA/Items/DEPO72.itm~ ~Override/DEPO72.itm~
SAY NAME1 @891
SAY NAME2 @980
SAY UNIDENTIFIED_DESC @980
SAY DESC @981

COPY ~BG1NPCSoA/Spells/DEPO72.SPL~ ~override/DEPO72.SPL~
SAY NAME1  @982
 SAY UNIDENTIFIED_DESC @982

COPY ~BG1NPCSoA/Items/DEPO73.itm~ ~Override/DEPO73.itm~
SAY NAME1 @411
SAY NAME2 @983
SAY UNIDENTIFIED_DESC @411
SAY DESC @984

COPY ~BG1NPCSoA/Items/DEPO74.itm~ ~Override/DEPO74.itm~
SAY NAME1 @927
SAY NAME2 @985
SAY UNIDENTIFIED_DESC @927
SAY DESC @986

COPY ~BG1NPCSoA/Items/DEPO75.itm~ ~Override/DEPO75.itm~
SAY NAME1 @987
SAY NAME2 @987
SAY UNIDENTIFIED_DESC @987
SAY DESC @988

COPY ~BG1NPCSoA/Items/DEPO76.itm~ ~Override/DEPO76.itm~
SAY NAME1 @366
SAY NAME2 @989
SAY UNIDENTIFIED_DESC @366
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@990" END

COPY ~BG1NPCSoA/Items/DEPO77.itm~ ~Override/DEPO77.itm~
SAY NAME1 @283
SAY NAME2 @991
SAY UNIDENTIFIED_DESC @283
SAY DESC @992

COPY ~BG1NPCSoA/Items/DEPO78.itm~ ~Override/DEPO78.itm~
SAY NAME1 @283
SAY NAME2 @993
SAY UNIDENTIFIED_DESC @283
SAY DESC @994


COPY ~BG1NPCSoA/Items/DEPO79.itm~ ~Override/DEPO79.itm~
SAY NAME1 @366
SAY NAME2 @995
SAY UNIDENTIFIED_DESC @366
SAY DESC @996

COPY ~BG1NPCSoA/Items/DEPO80.itm~ ~Override/DEPO80.itm~
SAY NAME1 @366
SAY NAME2 @997
SAY UNIDENTIFIED_DESC @366
SAY DESC @998

COPY ~BG1NPCSoA/Items/DEPO81.itm~ ~Override/DEPO81.itm~
SAY NAME1 @366
SAY NAME2 @999
SAY UNIDENTIFIED_DESC @366
SAY DESC @1000


COPY ~BG1NPCSoA/Items/DEPO82.itm~ ~Override/DEPO82.itm~
SAY NAME1 @827
SAY NAME2 @1001
SAY UNIDENTIFIED_DESC @827
SAY DESC @1002


COPY ~BG1NPCSoA/Items/DEPO83.itm~ ~Override/DEPO83.itm~
SAY NAME1 @891
SAY NAME2 @1003
SAY UNIDENTIFIED_DESC @891
SAY DESC @1004


COPY ~BG1NPCSoA/Items/DEPO84.itm~ ~Override/DEPO84.itm~
SAY NAME1 @827
SAY NAME2 @1005
SAY UNIDENTIFIED_DESC @827
SAY DESC @1006

COPY ~BG1NPCSoA/Items/DEPO85.itm~ ~Override/DEPO85.itm~
SAY NAME1 @891
SAY NAME2 @1007
SAY UNIDENTIFIED_DESC @891
SAY DESC @1008

COPY ~BG1NPCSoA/Items/DEPO86.itm~ ~Override/DEPO86.itm~
SAY NAME1 @944
SAY NAME2 @1009
SAY UNIDENTIFIED_DESC @944
SAY DESC @1010


COPY ~BG1NPCSoA/Items/DEPO87.itm~ ~Override/DEPO87.itm~
SAY NAME1 @411
SAY NAME2 @1011
SAY UNIDENTIFIED_DESC @411
SAY DESC @1012

COPY ~BG1NPCSoA/Items/DEPO88.itm~ ~Override/DEPO88.itm~
SAY NAME1 @891
SAY NAME2 @1013
SAY UNIDENTIFIED_DESC @891
SAY DESC @1014

COPY ~BG1NPCSoA/Items/DEPO89.itm~ ~Override/DEPO89.itm~
SAY NAME1 @363
SAY NAME2 @1015
SAY UNIDENTIFIED_DESC @363
SAY DESC @1016

COPY ~BG1NPCSoA/Items/DEPO90.itm~ ~Override/DEPO90.itm~
SAY NAME1 @1017
SAY NAME2 @1018
SAY UNIDENTIFIED_DESC @1017
SAY DESC @1019

COPY ~BG1NPCSoA/Items/DEPO91.itm~ ~Override/DEPO91.itm~
SAY NAME1 @891
SAY NAME2 @1020
SAY UNIDENTIFIED_DESC @891
SAY DESC @1021

COPY ~BG1NPCSoA/Items/DEPO92.itm~ ~Override/DEPO92.itm~
SAY NAME1 @891
SAY NAME2 @1022
SAY UNIDENTIFIED_DESC @891
SAY DESC @1023

COPY ~BG1NPCSoA/Items/DEPO93.itm~ ~Override/DEPO93.itm~
SAY NAME1 @382
SAY NAME2 @1024
SAY UNIDENTIFIED_DESC @382
SAY DESC @1025

COPY ~BG1NPCSoA/Items/DEPO94.itm~ ~Override/DEPO94.itm~
SAY NAME1 @891
SAY NAME2 @1026
SAY UNIDENTIFIED_DESC @891
SAY DESC @1027

COPY ~BG1NPCSoA/Items/DEPO95.itm~ ~Override/DEPO95.itm~
SAY NAME1 @283
SAY NAME2 @1028
SAY UNIDENTIFIED_DESC @283
SAY DESC @1029


COPY ~BG1NPCSoA/Items/DEPO96.itm~ ~Override/DEPO96.itm~
SAY NAME1 @366
SAY NAME2 @1030
SAY UNIDENTIFIED_DESC @366
SAY DESC @1031


COPY ~BG1NPCSoA/Items/DEPO97.itm~ ~Override/DEPO97.itm~
SAY NAME1 @1032
SAY NAME2 @1033
SAY UNIDENTIFIED_DESC @1032
SAY DESC @1034
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "axe" END

COPY ~BG1NPCSoA/Items/DEPO98.itm~ ~Override/DEPO98.itm~
SAY NAME1 @1035
SAY NAME2 @1036
SAY UNIDENTIFIED_DESC @1035
SAY DESC @1037
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "arrow" END

COPY ~BG1NPCSoA/Items/DEPO99.itm~ ~Override/DEPO99.itm~
SAY NAME1 @1038
SAY NAME2 @1039
SAY UNIDENTIFIED_DESC @1038
SAY DESC @1040

COPY ~BG1NPCSoA/Items/DEPO100.itm~ ~Override/DEPO100.itm~
SAY NAME1 @1032
SAY NAME2 @1041
SAY UNIDENTIFIED_DESC @1032
SAY DESC @1042
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "axe" END

COPY ~BG1NPCSoA/Items/DEPO101.itm~ ~Override/DEPO101.itm~
SAY NAME1 @283
SAY NAME2 @1043
SAY UNIDENTIFIED_DESC @283
SAY DESC @1044

COPY ~BG1NPCSoA/Items/DEPO102.itm~ ~Override/DEPO102.itm~
SAY NAME1 @1045
SAY NAME2 @1046
SAY UNIDENTIFIED_DESC @1045
SAY DESC @1047


COPY ~BG1NPCSoA/Items/DEPO103.itm~ ~Override/DEPO103.itm~
SAY NAME1 @411
SAY NAME2 @1048
SAY UNIDENTIFIED_DESC @411
SAY DESC @1049

COPY ~BG1NPCSoA/Items/DEPO104.itm~ ~Override/DEPO104.itm~
SAY NAME1 @411
SAY NAME2 @1050
SAY UNIDENTIFIED_DESC @411
SAY DESC @1051


COPY ~BG1NPCSoA/Items/DEPO105.itm~ ~Override/DEPO105.itm~
SAY NAME1 @1052
SAY NAME2 @1053
SAY UNIDENTIFIED_DESC @1052
SAY DESC @1054


COPY ~BG1NPCSoA/Items/DEPO106.itm~ ~Override/DEPO106.itm~
SAY NAME1 @924
SAY NAME2 @1055
SAY UNIDENTIFIED_DESC @924
SAY DESC @1056


COPY ~BG1NPCSoA/Items/DEPO107.itm~ ~Override/DEPO107.itm~
SAY NAME1 @411
SAY NAME2 @1057
SAY UNIDENTIFIED_DESC @411
SAY DESC @1058

COPY ~BG1NPCSoA/Items/DEPO108.itm~ ~Override/DEPO108.itm~
SAY NAME1 @293
SAY NAME2 @1059
SAY UNIDENTIFIED_DESC @293
SAY DESC @1060
READ_BYTE 0x21 use
LPF GET_BIT INT_VAR number = use nth_bit = 5 RET bit_value END
PATCH_IF ( NOT bit_value ) BEGIN WRITE_BYTE 0x21 ( use + 32 ) END
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "arrow" END


COPY ~BG1NPCSoA/Items/DEPO109.itm~ ~Override/DEPO109.itm~
SAY NAME1 @1061
SAY NAME2 @1062
SAY UNIDENTIFIED_DESC @1061
SAY DESC @1063


COPY ~BG1NPCSoA/Items/DEPO110.itm~ ~Override/DEPO110.itm~
SAY NAME1 @366
SAY NAME2 @1064
SAY UNIDENTIFIED_DESC @366
SAY DESC @1065


COPY ~BG1NPCSoA/Items/DEPO111.itm~ ~Override/DEPO111.itm~
SAY NAME1 @283
SAY NAME2 @1066
SAY UNIDENTIFIED_DESC @283
SAY DESC @1067



COPY ~BG1NPCSoA/Items/DEPO112.itm~ ~Override/DEPO112.itm~
SAY NAME1 @1068
SAY NAME2 @1069
SAY UNIDENTIFIED_DESC @1068
SAY DESC @1070


COPY ~BG1NPCSoA/Items/DEPO113.itm~ ~Override/DEPO113.itm~
SAY NAME1 @366
SAY NAME2 @1071
SAY UNIDENTIFIED_DESC @366
SAY DESC @1072
WRITE_BYTE 0x31 91


COPY ~BG1NPCSoA/Items/DEPO114.itm~ ~Override/DEPO114.itm~
SAY NAME1 @969
SAY NAME2 @1073
SAY UNIDENTIFIED_DESC @969
SAY DESC @1074





COPY ~BG1NPCSoA/Items/DEPO115.itm~ ~Override/DEPO115.itm~
SAY NAME1 @924
SAY NAME2 @1075
SAY UNIDENTIFIED_DESC @924
SAY DESC @1076

COPY ~BG1NPCSoA/Items/DEPO116.itm~ ~Override/DEPO116.itm~
SAY NAME1 @1077
SAY NAME2 @1078
SAY UNIDENTIFIED_DESC @1077
SAY DESC @1079

COPY ~BG1NPCSoA/Items/DEPO117.itm~ ~Override/DEPO117.itm~
SAY NAME1 @1077
SAY NAME2 @1080
SAY UNIDENTIFIED_DESC @1077
SAY DESC @1081



COPY ~BG1NPCSoA/Items/ETBITM5.itm~ ~Override/ETBITM5.itm~
SAY NAME1 @293
SAY NAME2 @294
SAY UNIDENTIFIED_DESC @293
SAY DESC @295

COPY ~BG1NPCSoA/Items/ETBITM6.itm~ ~Override/ETBITM6.itm~
SAY NAME1 @296
SAY NAME2 @297
SAY UNIDENTIFIED_DESC @296
SAY DESC @298


COPY ~BG1NPCSoA/Items/DEPO118.itm~ ~Override/DEPO118.itm~
SAY NAME1 @293
SAY NAME2 @1082
SAY UNIDENTIFIED_DESC @293
SAY DESC @1083
READ_BYTE 0x21 use
LPF GET_BIT INT_VAR number = use nth_bit = 5 RET bit_value END
PATCH_IF ( NOT bit_value ) BEGIN WRITE_BYTE 0x21 ( use + 32 ) END
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "arrow" END


COPY ~BG1NPCSoA/Items/DEPO119.itm~ ~Override/DEPO119.itm~
SAY NAME1 @1084
SAY NAME2 @1085
SAY UNIDENTIFIED_DESC @1084
SAY DESC @1086


COPY ~BG1NPCSoA/Items/DEPO120.itm~ ~Override/DEPO120.itm~
SAY NAME1 @283
SAY NAME2 @1087
SAY UNIDENTIFIED_DESC @283
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1088" END


COPY ~BG1NPCSoA/Items/DEPO121.itm~ ~Override/DEPO121.itm~
SAY NAME1 @283
SAY NAME2 @1089
SAY UNIDENTIFIED_DESC @283
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1090" END

COPY ~BG1NPCSoA/Items/DEPO122.itm~ ~Override/DEPO122.itm~
SAY NAME1 @1032
SAY NAME2 @1091
SAY UNIDENTIFIED_DESC @1032
SAY DESC @1092
READ_BYTE 0x21 use
LPF GET_BIT INT_VAR number = use nth_bit = 5 RET bit_value END
PATCH_IF ( NOT bit_value ) BEGIN WRITE_BYTE 0x21 ( use + 32 ) END
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "axe" END

COPY ~BG1NPCSoA/Items/DEPO123.itm~ ~Override/DEPO123.itm~
SAY NAME1 @366
SAY NAME2 @1093
SAY UNIDENTIFIED_DESC @366
SAY DESC @1094

COPY ~BG1NPCSoA/Items/DEPO124.itm~ ~Override/DEPO124.itm~
SAY NAME1 @1095
SAY NAME2 @1096
SAY UNIDENTIFIED_DESC @1095
SAY DESC @1097

COPY ~BG1NPCSoA/Items/DEPO125.itm~ ~Override/DEPO125.itm~
SAY NAME1 @827
SAY NAME2 @1098
SAY UNIDENTIFIED_DESC @827
SAY DESC @1099


COPY ~BG1NPCSoA/Items/DEPO126.itm~ ~Override/DEPO126.itm~
SAY NAME1 @827
SAY NAME2 @1100
SAY UNIDENTIFIED_DESC @827
SAY DESC @1101


COPY ~BG1NPCSoA/Items/DEPO127.itm~ ~Override/DEPO127.itm~
SAY NAME1 @1102
SAY NAME2 @1103
SAY UNIDENTIFIED_DESC @1102
SAY DESC @1104



COPY ~BG1NPCSoA/Items/DEPO128.itm~ ~Override/DEPO128.itm~
SAY NAME1 @1102
SAY NAME2 @1105
SAY UNIDENTIFIED_DESC @1102
SAY DESC @1106

COPY ~BG1NPCSoA/Items/DEPO129.itm~ ~Override/DEPO129.itm~
SAY NAME1 @1107
SAY NAME2 @1108
SAY UNIDENTIFIED_DESC @1107
SAY DESC @1109

COPY ~BG1NPCSoA/Items/DEPO130.itm~ ~Override/DEPO130.itm~
SAY NAME1 @1045
SAY NAME2 @1110
SAY UNIDENTIFIED_DESC @1045
SAY DESC @1111


COPY ~BG1NPCSoA/Items/DEPO131.itm~ ~Override/DEPO131.itm~
SAY NAME1 @1112
SAY NAME2 @1113
SAY UNIDENTIFIED_DESC @1112
SAY DESC @1114

COPY ~BG1NPCSoA/Items/DEPO132.itm~ ~Override/DEPO132.itm~
SAY NAME1 @1115
SAY NAME2 @1115
SAY UNIDENTIFIED_DESC @1115
SAY DESC @1116

COPY ~BG1NPCSoA/Items/DEPO133.itm~ ~Override/DEPO133.itm~
SAY NAME1 @242
SAY NAME2 @1117
SAY UNIDENTIFIED_DESC @242
SAY DESC @1118


COPY ~BG1NPCSoA/Items/DEPO134.itm~ ~Override/DEPO134.itm~
SAY NAME1 @1119
SAY NAME2 @1120
SAY UNIDENTIFIED_DESC @1119
SAY DESC @1121


COPY ~BG1NPCSoA/Items/DEPO135.itm~ ~Override/DEPO135.itm~
SAY NAME1 @411
SAY NAME2 @412
SAY UNIDENTIFIED_DESC @412
SAY DESC @413


COPY ~BG1NPCSoA/Items/DEPO136.itm~ ~Override/DEPO136.itm~
SAY NAME1 @1122
SAY NAME2 @1122
SAY UNIDENTIFIED_DESC @1122
SAY DESC @1123

COPY ~BG1NPCSoA/Items/DEPO137.itm~ ~Override/DEPO137.itm~
SAY NAME1 @1124
SAY NAME2 @1124
SAY UNIDENTIFIED_DESC @1124
SAY DESC @1125

COPY ~BG1NPCSoA/Items/DEPO138.itm~ ~Override/DEPO138.itm~
SAY NAME1 @827
SAY NAME2 @1126
SAY UNIDENTIFIED_DESC @827
SAY DESC @1127

COPY ~BG1NPCSoA/Items/DEPO139.itm~ ~Override/DEPO139.itm~
SAY NAME1 @827
SAY NAME2 @1128
SAY UNIDENTIFIED_DESC @827
SAY DESC @1129

COPY ~BG1NPCSoA/Items/DEPO140.itm~ ~Override/DEPO140.itm~
SAY NAME1 @827
SAY NAME2 @1130
SAY UNIDENTIFIED_DESC @827
SAY DESC @1131



COPY ~BG1NPCSoA/Items/DEPO141.itm~ ~Override/DEPO141.itm~
SAY NAME1 @1077
SAY NAME2 @1132
SAY UNIDENTIFIED_DESC @1077
SAY DESC @1133

COPY ~BG1NPCSoA/Items/DEPO142.itm~ ~Override/DEPO142.itm~
SAY NAME1 @1134
SAY NAME2 @1135
SAY UNIDENTIFIED_DESC @1134
SAY DESC @1136

COPY ~BG1NPCSoA/Items/DEPO143.itm~ ~Override/DEPO143.itm~
SAY NAME1 @891
SAY NAME2 @1137
SAY UNIDENTIFIED_DESC @891
SAY DESC @1138

COPY ~BG1NPCSoA/Items/DEPO144.itm~ ~Override/DEPO144.itm~
SAY NAME1 @891
SAY NAME2 @1139
SAY UNIDENTIFIED_DESC @891
SAY DESC @1140



COPY ~BG1NPCSoA/Items/DEPO145.itm~ ~Override/DEPO145.itm~
SAY NAME1 @891
SAY NAME2 @1141
SAY UNIDENTIFIED_DESC @891
SAY DESC @1142



COPY ~BG1NPCSoA/Items/DEPO146.itm~ ~Override/DEPO146.itm~
SAY NAME1 @1077
SAY NAME2 @1143
SAY UNIDENTIFIED_DESC @1077
SAY DESC @1144

COPY ~BG1NPCSoA/Items/DEPO147.itm~ ~Override/DEPO147.itm~
SAY NAME1 @1107
SAY NAME2 @1145
SAY UNIDENTIFIED_DESC @1107
SAY DESC @1146
WRITE_BYTE 0x31 93

COPY ~BG1NPCSoA/Items/DEPO148.itm~ ~Override/DEPO148.itm~
SAY NAME1 @924
SAY NAME2 @1147
SAY UNIDENTIFIED_DESC @924
SAY DESC @1148

COPY ~BG1NPCSoA/Items/DEPO149.itm~ ~Override/DEPO149.itm~
SAY NAME1 @891
SAY NAME2 @1149
SAY UNIDENTIFIED_DESC @891
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1150" END

COPY ~BG1NPCSoA/Items/DEPO148.itm~ ~Override/DEPO148.itm~
SAY NAME1 @924
SAY NAME2 @1147
SAY UNIDENTIFIED_DESC @924
SAY DESC @1148

COPY ~BG1NPCSoA/Items/DEPO150.itm~ ~Override/DEPO150.itm~
SAY NAME1 @1077
SAY NAME2 @1151
SAY UNIDENTIFIED_DESC @1077
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1152" END

COPY ~BG1NPCSoA/Items/DEPO151.itm~ ~Override/DEPO151.itm~
SAY NAME1 @1107
SAY NAME2 @1153
SAY UNIDENTIFIED_DESC @1107
SAY DESC @1154

COPY ~BG1NPCSoA/Items/DEPO152.itm~ ~Override/DEPO152.itm~
SAY NAME1 @1107
SAY NAME2 @1155
SAY UNIDENTIFIED_DESC @1107
SAY DESC @1156

COPY ~BG1NPCSoA/Items/DEPO153.itm~ ~Override/DEPO153.itm~
SAY NAME1 @1157
SAY NAME2 @1157
SAY UNIDENTIFIED_DESC @1157
SAY DESC @1158

COPY ~BG1NPCSoA/Items/DEPO154.itm~ ~Override/DEPO154.itm~
SAY NAME1 @1159
SAY NAME2 @1160
SAY UNIDENTIFIED_DESC @1159
SAY DESC @1161

COPY ~BG1NPCSoA/Items/DEPO155.itm~ ~Override/DEPO155.itm~
SAY NAME1 @939
SAY NAME2 @1162
SAY UNIDENTIFIED_DESC @939
SAY DESC @1163

COPY ~BG1NPCSoA/Items/DEPO156.itm~ ~Override/DEPO156.itm~
SAY NAME1 @382
SAY NAME2 @1164
SAY UNIDENTIFIED_DESC @382
SAY DESC @1165

COPY ~BG1NPCSoA/Items/DEPO157.itm~ ~Override/DEPO157.itm~
SAY NAME1 @827
SAY NAME2 @1166
SAY UNIDENTIFIED_DESC @827
SAY DESC @1166


COPY ~BG1NPCSoA/Items/DEPO158.itm~ ~Override/DEPO158.itm~
SAY NAME1 @827
SAY NAME2 @1167
SAY UNIDENTIFIED_DESC @827
SAY DESC @1167


COPY ~BG1NPCSoA/Items/DEPO159.itm~ ~Override/DEPO159.itm~
SAY NAME1 @969
SAY NAME2 @1168
SAY UNIDENTIFIED_DESC @969
SAY DESC @1168


COPY ~BG1NPCSoA/Items/DEPO160.itm~ ~Override/DEPO160.itm~
SAY NAME1 @827
SAY NAME2 @1169
SAY UNIDENTIFIED_DESC @827
SAY DESC @1170

COPY ~BG1NPCSoA/Items/DEPO161.itm~ ~Override/DEPO161.itm~
SAY NAME1 @969
SAY NAME2 @1171
SAY UNIDENTIFIED_DESC @969
SAY DESC @1172


COPY ~BG1NPCSoA/Items/DEPO162.itm~ ~Override/DEPO162.itm~
SAY NAME1 @286
SAY NAME2 @1173
SAY UNIDENTIFIED_DESC @286
SAY DESC @1173

COPY ~BG1NPCSoA/Items/DEPO163.itm~ ~Override/DEPO163.itm~
SAY NAME1 @411
SAY NAME2 @1174
SAY UNIDENTIFIED_DESC @411
SAY DESC @1175

COPY ~BG1NPCSoA/Items/DEPO164.itm~ ~Override/DEPO164.itm~
SAY NAME1 @411
SAY NAME2 @1176
SAY UNIDENTIFIED_DESC @411
SAY DESC @1177

COPY ~BG1NPCSoA/Items/DEPO165.itm~ ~Override/DEPO165.itm~
SAY NAME1 @411
SAY NAME2 @1178
SAY UNIDENTIFIED_DESC @411
SAY DESC @1179


COPY ~BG1NPCSoA/Items/DEPO166.itm~ ~Override/DEPO166.itm~
SAY NAME1 @1180
SAY NAME2 @1181
SAY UNIDENTIFIED_DESC @1180
SAY DESC @1181

COPY ~BG1NPCSoA/Items/DEPO167.itm~ ~Override/DEPO167.itm~
SAY NAME1 @1032
SAY NAME2 @1182
SAY UNIDENTIFIED_DESC @1032
SAY DESC @1183
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "axe" END

COPY ~BG1NPCSoA/Items/DEPO168.itm~ ~Override/DEPO168.itm~
SAY NAME1 @245
SAY NAME2 @1184
SAY UNIDENTIFIED_DESC @245
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1185" END
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "scimitar" END


COPY ~BG1NPCSoA/Items/DEPO169.itm~ ~Override/DEPO169.itm~
SAY NAME1 @827
SAY NAME2 @1186
SAY UNIDENTIFIED_DESC @827
SAY DESC @1187


COPY ~BG1NPCSoA/Items/DEPO170.itm~ ~Override/DEPO170.itm~
SAY NAME1 @1180
SAY NAME2 @1188
SAY UNIDENTIFIED_DESC @1180
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1189" END


COPY ~BG1NPCSoA/Items/DEPO171.itm~ ~Override/DEPO171.itm~
SAY NAME1 @283
SAY NAME2 @1190
SAY UNIDENTIFIED_DESC @283
SAY DESC @1191

COPY ~BG1NPCSoA/Items/DEPO172.itm~ ~Override/DEPO172.itm~
SAY NAME1 @283
SAY NAME2 @1192
SAY UNIDENTIFIED_DESC @283
SAY DESC @1193


COPY ~BG1NPCSoA/Items/DEPO173.itm~ ~Override/DEPO173.itm~
SAY NAME1 @411
SAY NAME2 @1194
SAY UNIDENTIFIED_DESC @411
SAY DESC @1195

COPY ~BG1NPCSoA/Items/DEPO174.itm~ ~Override/DEPO174.itm~
SAY NAME1 @921
SAY NAME2 @1196
SAY UNIDENTIFIED_DESC @1196
SAY DESC @1196

COPY ~BG1NPCSoA/Items/DEPO175.itm~ ~Override/DEPO175.itm~
SAY NAME1 @1107
SAY NAME2 @1197
SAY UNIDENTIFIED_DESC @1107
SAY DESC @1197

COPY ~BG1NPCSoA/Items/DEPO176.itm~ ~Override/DEPO176.itm~
SAY NAME1 @915
SAY NAME2 @1198
SAY UNIDENTIFIED_DESC @915
SAY DESC @1198

COPY ~BG1NPCSoA/Items/DEPO177.itm~ ~Override/DEPO177.itm~
SAY NAME1 @891
SAY NAME2 @1199
SAY UNIDENTIFIED_DESC @891
SAY DESC @1200



COPY ~BG1NPCSoA/Items/DEPO178.itm~ ~Override/DEPO178.itm~
SAY NAME1 @234
SAY NAME2 @1201
SAY UNIDENTIFIED_DESC @234
SAY DESC @1202


COPY ~BG1NPCSoA/Items/DEPO179.itm~ ~Override/DEPO179.itm~
SAY NAME1 @1203
SAY NAME2 @1204
SAY UNIDENTIFIED_DESC @1203
SAY DESC @1204


COPY ~BG1NPCSoA/Items/DEPO180.itm~ ~Override/DEPO180.itm~
SAY NAME1 @283
SAY NAME2 @1205
SAY UNIDENTIFIED_DESC @283
SAY DESC @1206


COPY ~BG1NPCSoA/Items/DEPO181.itm~ ~Override/DEPO181.itm~
SAY NAME1 @366
SAY NAME2 @1207
SAY UNIDENTIFIED_DESC @366
SAY DESC @1208

COPY ~BG1NPCSoA/Items/DEPO182.itm~ ~Override/DEPO182.itm~
SAY NAME1 @1209
SAY NAME2 @1210
SAY UNIDENTIFIED_DESC @1209
SAY DESC @1211

COPY ~BG1NPCSoA/Items/DEPO183.itm~ ~Override/DEPO183.itm~
SAY NAME1 @1084
SAY NAME2 @1212
SAY UNIDENTIFIED_DESC @1084
SAY DESC @1213

COPY ~BG1NPCSoA/Items/DEPO184.itm~ ~Override/DEPO184.itm~
SAY NAME1 @1209
SAY NAME2 @1214
SAY UNIDENTIFIED_DESC @1209
SAY DESC @1215

COPY ~BG1NPCSoA/Items/DEPO185.itm~ ~Override/DEPO185.itm~
SAY NAME1 @283
SAY NAME2 @1216
SAY UNIDENTIFIED_DESC @283
SAY DESC @1217

COPY ~BG1NPCSoA/Items/DEPO186.itm~ ~Override/DEPO186.itm~
SAY NAME1 @1045
SAY NAME2 @1218
SAY UNIDENTIFIED_DESC @1045
SAY DESC @1219

COPY ~BG1NPCSoA/Items/DEPO187.itm~ ~Override/DEPO187.itm~
SAY NAME1 @1045
SAY NAME2 @1220
SAY UNIDENTIFIED_DESC @1045
SAY DESC @1221


COPY ~BG1NPCSoA/Items/DEPO188.itm~ ~Override/DEPO188.itm~
SAY NAME1 @1222
SAY NAME2 @1223
SAY UNIDENTIFIED_DESC @1222
SAY DESC @1223

COPY ~BG1NPCSoA/Items/DEPO189.itm~ ~Override/DEPO189.itm~
SAY NAME1 @366
SAY NAME2 @409
SAY UNIDENTIFIED_DESC @366
SAY DESC @410

COPY ~BG1NPCSoA/Items/DEPO190.itm~ ~Override/DEPO190.itm~
SAY NAME1 @283
SAY NAME2 @1224
SAY UNIDENTIFIED_DESC @283
SAY DESC @1225

COPY ~BG1NPCSoA/Items/DEPO191.itm~ ~Override/DEPO191.itm~
SAY NAME1 @1226
SAY NAME2 @1227
SAY UNIDENTIFIED_DESC @1226
SAY DESC @1228

COPY ~BG1NPCSoA/Items/DEPO192.itm~ ~Override/DEPO192.itm~
SAY NAME1 @949
SAY NAME2 @1229
SAY UNIDENTIFIED_DESC @949
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1230" END

COPY ~BG1NPCSoA/Items/DEPO193.itm~ ~Override/DEPO193.itm~
SAY NAME1 @891
SAY NAME2 @1231
SAY UNIDENTIFIED_DESC @891
SAY DESC @1232



COPY ~BG1NPCSoA/Items/DEPO194.itm~ ~Override/DEPO194.itm~
SAY NAME1 @283
SAY NAME2 @1233
SAY UNIDENTIFIED_DESC @283
SAY DESC @1234


COPY ~BG1NPCSoA/Items/DEPO195.itm~ ~Override/DEPO195.itm~
SAY NAME1 @792
SAY NAME2 @1235
SAY UNIDENTIFIED_DESC @792
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1236" END

COPY ~BG1NPCSoA/Items/DEPO196.itm~ ~Override/DEPO196.itm~
SAY NAME1 @1237
SAY NAME2 @1237
SAY UNIDENTIFIED_DESC @1237
SAY DESC @1237

COPY ~BG1NPCSoA/Items/DEPO197.itm~ ~Override/DEPO197.itm~
SAY NAME1 @924
SAY NAME2 @1238
SAY UNIDENTIFIED_DESC @924
SAY DESC @1239


COPY ~BG1NPCSoA/Items/DEPO198.itm~ ~Override/DEPO198.itm~
SAY NAME1 @1240
SAY NAME2 @1240
SAY UNIDENTIFIED_DESC @1240
SAY DESC @1241

COPY ~BG1NPCSoA/Items/DEPO199.itm~ ~Override/DEPO199.itm~
SAY NAME1 @1242
SAY NAME2 @1243
SAY UNIDENTIFIED_DESC @1242
SAY DESC @1243


COPY ~BG1NPCSoA/Items/DEPO200.itm~ ~Override/DEPO200.itm~
SAY NAME1 @1244
SAY NAME2 @1244
SAY UNIDENTIFIED_DESC @1244
SAY DESC @1245

COPY ~BG1NPCSoA/Items/DEPO201.itm~ ~Override/DEPO201.itm~
SAY NAME1 @1246
SAY NAME2 @1247
SAY UNIDENTIFIED_DESC @1246
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1248" END

COPY ~BG1NPCSoA/Items/DEPO202.itm~ ~Override/DEPO202.itm~
SAY NAME1 @936
SAY NAME2 @1249
SAY UNIDENTIFIED_DESC @936
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1250" END


COPY ~BG1NPCSoA/Items/DEPO203.itm~ ~Override/DEPO203.itm~
SAY NAME1 @1251
SAY NAME2 @1251
SAY UNIDENTIFIED_DESC @1251
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1252" END


COPY ~BG1NPCSoA/Items/DEPO204.itm~ ~Override/DEPO204.itm~
SAY NAME1 @245
SAY NAME2 @1253
SAY UNIDENTIFIED_DESC @245
SAY DESC @1254


COPY ~BG1NPCSoA/Items/DEPO205.itm~ ~Override/DEPO205.itm~
SAY NAME1 @245
SAY NAME2 @1255
SAY UNIDENTIFIED_DESC @245
SAY DESC @1256


COPY ~BG1NPCSoA/Items/DEPO206.itm~ ~Override/DEPO206.itm~
SAY NAME1 @1257
SAY NAME2 @1257
SAY UNIDENTIFIED_DESC @1257
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1258" END


COPY ~BG1NPCSoA/Items/DEPO207.itm~ ~Override/DEPO207.itm~
SAY NAME1 @1246
SAY NAME2 @1259
SAY UNIDENTIFIED_DESC @1246
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1260" END

COPY ~BG1NPCSoA/Items/DEPO208.itm~ ~Override/DEPO208.itm~
SAY NAME1 @1261
SAY NAME2 @1261
SAY UNIDENTIFIED_DESC @1261
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1262" END

COPY ~BG1NPCSoA/Items/DEPO209.itm~ ~Override/DEPO209.itm~
SAY NAME1 @1263
SAY NAME2 @1264
SAY UNIDENTIFIED_DESC @1263
SAY DESC @1265

COPY ~BG1NPCSoA/Items/DEPO210.itm~ ~Override/DEPO210.itm~
SAY NAME1 @366
SAY NAME2 @1266
SAY UNIDENTIFIED_DESC @366
SAY DESC @1267


COPY ~BG1NPCSoA/Items/DEPO211.itm~ ~Override/DEPO211.itm~
SAY NAME1 @242
SAY NAME2 @407
SAY UNIDENTIFIED_DESC @242
SAY DESC @408

COPY ~BG1NPCSoA/Items/DEPO212.itm~ ~Override/DEPO212.itm~
SAY NAME1 @414
SAY NAME2 @415
SAY UNIDENTIFIED_DESC @414
SAY DESC @416

COPY ~BG1NPCSoA/Items/DEPO213.itm~ ~Override/DEPO213.itm~
SAY NAME1 @1268
SAY NAME2 @1268
SAY UNIDENTIFIED_DESC @1268
SAY DESC @1268

COPY ~BG1NPCSoA/Items/DEPO214.itm~ ~Override/DEPO214.itm~
SAY NAME1 @969
SAY NAME2 @1269
SAY UNIDENTIFIED_DESC @969
SAY DESC @1269


COPY ~BG1NPCSoA/Items/DEPO215.itm~ ~Override/DEPO215.itm~
SAY NAME1 @1270
SAY NAME2 @1271
SAY UNIDENTIFIED_DESC @1270
SAY DESC @1271

COPY ~BG1NPCSoA/Items/DEPO216.itm~ ~Override/DEPO216.itm~
SAY NAME1 @1270
SAY NAME2 @1272
SAY UNIDENTIFIED_DESC @1270
SAY DESC @1272

COPY ~BG1NPCSoA/Items/DEPO217.itm~ ~Override/DEPO217.itm~
SAY NAME1 @1270
SAY NAME2 @1273
SAY UNIDENTIFIED_DESC @1270
SAY DESC @1273

COPY ~BG1NPCSoA/Items/DEPO218.itm~ ~Override/DEPO218.itm~
SAY NAME1 @824
SAY NAME2 @1274
SAY UNIDENTIFIED_DESC @824
SAY DESC @1275

COPY ~BG1NPCSoA/Items/DEPO219.itm~ ~Override/DEPO219.itm~
SAY NAME1 @414
SAY NAME2 @1276
SAY UNIDENTIFIED_DESC @414
SAY DESC @1277

COPY ~BG1NPCSoA/Items/DEPO220.itm~ ~Override/DEPO220.itm~
SAY NAME1 @827
SAY NAME2 @1278
SAY UNIDENTIFIED_DESC @827
SAY DESC @1279

COPY ~BG1NPCSoA/Items/DEPO221.itm~ ~Override/DEPO221.itm~
SAY NAME1 @1280
SAY NAME2 @1280
SAY UNIDENTIFIED_DESC @1280
SAY DESC @1281


COPY ~BG1NPCSoA/Items/DEPO222.itm~ ~Override/DEPO222.itm~
SAY NAME1 @1282
SAY NAME2 @1282
SAY UNIDENTIFIED_DESC @1282
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1283" END

COPY ~BG1NPCSoA/Items/DEPO223.itm~ ~Override/DEPO223.itm~
SAY NAME1 @827
SAY NAME2 @1284
SAY UNIDENTIFIED_DESC @827
SAY DESC @1285

COPY ~BG1NPCSoA/Items/DEPO224.itm~ ~Override/DEPO224.itm~
SAY NAME1 @411
SAY NAME2 @1286
SAY UNIDENTIFIED_DESC @411
SAY DESC @1287

COPY ~BG1NPCSoA/Items/DEPO225.itm~ ~Override/DEPO225.itm~
SAY NAME1 @1288
SAY NAME2 @1288
SAY UNIDENTIFIED_DESC @1288
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1289" END
READ_BYTE 0x21 use
LPF GET_BIT INT_VAR number = use nth_bit = 5 RET bit_value END
PATCH_IF ( NOT bit_value ) BEGIN WRITE_BYTE 0x21 ( use + 32 ) END
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "arrow" END

COPY ~BG1NPCSoA/Items/DEPO226.itm~ ~Override/DEPO226.itm~
SAY NAME1 @1290
SAY NAME2 @1290
SAY UNIDENTIFIED_DESC @1290
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1291" END

COPY ~BG1NPCSoA/Items/DEPO227.itm~ ~Override/DEPO227.itm~
SAY NAME1 @1292
SAY NAME2 @1292
SAY UNIDENTIFIED_DESC @1292
SAY DESC @1293

COPY ~BG1NPCSoA/Items/DEPO228.itm~ ~Override/DEPO228.itm~
SAY NAME1 @1294
SAY NAME2 @1294
SAY UNIDENTIFIED_DESC @1294
SAY DESC @1294

COPY ~BG1NPCSoA/Items/DEPO229.itm~ ~Override/DEPO229.itm~
SAY NAME1 @1295
SAY NAME2 @1295
SAY UNIDENTIFIED_DESC @1295
SAY DESC @1295

COPY ~BG1NPCSoA/Items/DEPO230.itm~ ~Override/DEPO230.itm~
SAY NAME1 @1296
SAY NAME2 @1296
SAY UNIDENTIFIED_DESC @1296
SAY DESC @1297

COPY ~BG1NPCSoA/Items/DEPO231.itm~ ~Override/DEPO231.itm~
SAY NAME1 @1298
SAY NAME2 @1298
SAY UNIDENTIFIED_DESC @1298
SAY DESC @1299

COPY ~BG1NPCSoA/Items/DEPO232.itm~ ~Override/DEPO232.itm~
SAY NAME1 @1300
SAY NAME2 @1300
SAY UNIDENTIFIED_DESC @1300
SAY DESC @1301

COPY ~BG1NPCSoA/Items/DEPO233.itm~ ~Override/DEPO233.itm~
SAY NAME1 @1302
SAY NAME2 @1302
SAY UNIDENTIFIED_DESC @1302
SAY DESC @1302

COPY ~BG1NPCSoA/Items/DEPO234.itm~ ~Override/DEPO234.itm~
SAY NAME1 @1303
SAY NAME2 @1303
SAY UNIDENTIFIED_DESC @1303
SAY DESC @1304

COPY ~BG1NPCSoA/Items/DEPO235.itm~ ~Override/DEPO235.itm~
SAY NAME1 @1305
SAY NAME2 @1305
SAY UNIDENTIFIED_DESC @1305
SAY DESC @1306

COPY ~BG1NPCSoA/Items/DEPO236.itm~ ~Override/DEPO236.itm~
SAY NAME1 @1307
SAY NAME2 @1307
SAY UNIDENTIFIED_DESC @1307
SAY DESC @1308

COPY ~BG1NPCSoA/Items/DEPO237.itm~ ~Override/DEPO237.itm~
SAY NAME1 @1309
SAY NAME2 @1309
SAY UNIDENTIFIED_DESC @1309
SAY DESC @1310

COPY ~BG1NPCSoA/Items/DEPO238.itm~ ~Override/DEPO238.itm~
SAY NAME1 @1311
SAY NAME2 @1311
SAY UNIDENTIFIED_DESC @1311
SAY DESC @1312

COPY ~BG1NPCSoA/Items/DEPO239.itm~ ~Override/DEPO239.itm~
SAY NAME1 @1313
SAY NAME2 @1313
SAY UNIDENTIFIED_DESC @1313
SAY DESC @1314

COPY ~BG1NPCSoA/Items/DEPO240.itm~ ~Override/DEPO240.itm~
SAY NAME1 @1315
SAY NAME2 @1315
SAY UNIDENTIFIED_DESC @1315
SAY DESC @1316

COPY ~BG1NPCSoA/Items/DEPO241.itm~ ~Override/DEPO241.itm~
SAY NAME1 @1317
SAY NAME2 @1317
SAY UNIDENTIFIED_DESC @1317
SAY DESC @1318
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "scimitar" END

COPY ~BG1NPCSoA/Items/DEPO242.itm~ ~Override/DEPO242.itm~
SAY NAME1 @1319
SAY NAME2 @1319
SAY UNIDENTIFIED_DESC @1319
SAY DESC @1320

COPY ~BG1NPCSoA/Items/DEPO243.itm~ ~Override/DEPO243.itm~
SAY NAME1 @1321
SAY NAME2 @1321
SAY UNIDENTIFIED_DESC @1321
SAY DESC @1322

COPY ~BG1NPCSoA/Items/DEPO244.itm~ ~Override/DEPO244.itm~
SAY NAME1 @1323
SAY NAME2 @1323
SAY UNIDENTIFIED_DESC @1323
SAY DESC @1324

COPY ~BG1NPCSoA/Items/DEPO245.itm~ ~Override/DEPO245.itm~
SAY NAME1 @1325
SAY NAME2 @1325
SAY UNIDENTIFIED_DESC @1325
SAY DESC @1326

COPY ~BG1NPCSoA/Items/DEPO246.itm~ ~Override/DEPO246.itm~
SAY NAME1 @1327
SAY NAME2 @1327
SAY UNIDENTIFIED_DESC @1327
SAY DESC @1328

COPY ~BG1NPCSoA/Items/DEPO247.itm~ ~Override/DEPO247.itm~
SAY NAME1 @1329
SAY NAME2 @1329
SAY UNIDENTIFIED_DESC @1329
SAY DESC @1330

COPY ~BG1NPCSoA/Items/DEPO248.itm~ ~Override/DEPO248.itm~
SAY NAME1 @1331
SAY NAME2 @1331
SAY UNIDENTIFIED_DESC @1331
SAY DESC @1332

COPY ~BG1NPCSoA/Items/DEPO249.itm~ ~Override/DEPO249.itm~
SAY NAME1 @1333
SAY NAME2 @1333
SAY UNIDENTIFIED_DESC @1333
SAY DESC @1333

COPY ~BG1NPCSoA/Items/DEPO250.itm~ ~Override/DEPO250.itm~
SAY NAME1 @1334
SAY NAME2 @1334
SAY UNIDENTIFIED_DESC @1334
SAY DESC @1335
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "axe" END

COPY ~BG1NPCSoA/Items/DEPO251.itm~ ~Override/DEPO251.itm~
SAY NAME1 @1336
SAY NAME2 @1336
SAY UNIDENTIFIED_DESC @1336
SAY DESC @1337


COPY ~BG1NPCSoA/Items/DEPO252.itm~ ~Override/DEPO252.itm~
SAY NAME1 @1338
SAY NAME2 @1338
SAY UNIDENTIFIED_DESC @1338
SAY DESC @1339

COPY ~BG1NPCSoA/Items/DEPO253.itm~ ~Override/DEPO253.itm~
SAY NAME1 @1340
SAY NAME2 @1340
SAY UNIDENTIFIED_DESC @1340
SAY DESC @1340

COPY ~BG1NPCSoA/Items/DEPO254.itm~ ~Override/DEPO254.itm~
SAY NAME1 @1341
SAY NAME2 @1341
SAY UNIDENTIFIED_DESC @1341
SAY DESC @1341

COPY ~BG1NPCSoA/Items/DEPO255.itm~ ~Override/DEPO255.itm~
SAY NAME1 @1342
SAY NAME2 @1342
SAY UNIDENTIFIED_DESC @1342
SAY DESC @1342


COPY ~BG1NPCSoA/Items/DEPO256.itm~ ~Override/DEPO256.itm~
SAY NAME1 @1343
SAY NAME2 @1343
SAY UNIDENTIFIED_DESC @1343
SAY DESC @1343

COPY ~BG1NPCSoA/Items/DEPO257.itm~ ~Override/DEPO257.itm~
SAY NAME1 @1344
SAY NAME2 @1344
SAY UNIDENTIFIED_DESC @1344
SAY DESC @1345

COPY ~BG1NPCSoA/Items/DEPO258.itm~ ~Override/DEPO258.itm~
SAY NAME1 @1346
SAY NAME2 @1346
SAY UNIDENTIFIED_DESC @1346
SAY DESC @1347

COPY ~BG1NPCSoA/Items/DEPO259.itm~ ~Override/DEPO259.itm~
SAY NAME1 @1348
SAY NAME2 @1348
SAY UNIDENTIFIED_DESC @1348
SAY DESC @1349

COPY ~BG1NPCSoA/Items/DEPO260.itm~ ~Override/DEPO260.itm~
SAY NAME1 @1350
SAY NAME2 @1350
SAY UNIDENTIFIED_DESC @1350
SAY DESC @1351

COPY ~BG1NPCSoA/Items/DEPO261.itm~ ~Override/DEPO261.itm~
SAY NAME1 @1352
SAY NAME2 @1352
SAY UNIDENTIFIED_DESC @1352
SAY DESC @1353

COPY ~BG1NPCSoA/Items/DEPO262.itm~ ~Override/DEPO262.itm~
SAY NAME1 @1354
SAY NAME2 @1354
SAY UNIDENTIFIED_DESC @1354
SAY DESC @1355
LPF SCIMITAR_AXE_USABILITY STR_VAR itype = "scimitar" END


COPY ~BG1NPCSoA/Items/DEPO263.itm~ ~Override/DEPO263.itm~
SAY NAME1 @1356
SAY NAME2 @1356
SAY UNIDENTIFIED_DESC @1356
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1357" END

COPY ~BG1NPCSoA/Items/DEPO264.itm~ ~Override/DEPO264.itm~
SAY NAME1 @1358
SAY NAME2 @1358
SAY UNIDENTIFIED_DESC @1358
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1359" END

COPY ~BG1NPCSoA/Items/DEPO265.itm~ ~Override/DEPO265.itm~
SAY NAME1 @1360
SAY NAME2 @1360
SAY UNIDENTIFIED_DESC @1360
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1361" END

COPY ~BG1NPCSoA/Items/DEPO266.itm~ ~Override/DEPO266.itm~
SAY NAME1 @1362
SAY NAME2 @1362
SAY UNIDENTIFIED_DESC @1362
SAY DESC @1363


COPY ~BG1NPCSoA/Items/DEPO267.itm~ ~Override/DEPO267.itm~
SAY NAME1 @1364
SAY NAME2 @1364
SAY UNIDENTIFIED_DESC @1364
SAY DESC @1365


COPY ~BG1NPCSoA/Items/DEPO268.itm~ ~Override/DEPO268.itm~
SAY NAME1 @1366
SAY NAME2 @1366
SAY UNIDENTIFIED_DESC @1366
SAY DESC @1367

COPY ~BG1NPCSoA/Items/DEPO269.itm~ ~Override/DEPO269.itm~
SAY NAME1 @1368
SAY NAME2 @1368
SAY UNIDENTIFIED_DESC @1368
SAY DESC @1369

COPY ~BG1NPCSoA/Items/DEPO270.itm~ ~Override/DEPO270.itm~
SAY NAME1 @1370
SAY NAME2 @1370
SAY UNIDENTIFIED_DESC @1370
SAY DESC @1371

COPY ~BG1NPCSoA/Items/DEPO271.itm~ ~Override/DEPO271.itm~
SAY NAME1 @1372
SAY NAME2 @1372
SAY UNIDENTIFIED_DESC @1372
SAY DESC @1373

COPY ~BG1NPCSoA/Items/DEPO272.itm~ ~Override/DEPO272.itm~
SAY NAME1 @1374
SAY NAME2 @1374
SAY UNIDENTIFIED_DESC @1374
SAY DESC @1375

COPY ~BG1NPCSoA/Items/DEPO273.itm~ ~Override/DEPO273.itm~
SAY NAME1 @1376
SAY NAME2 @1376
SAY UNIDENTIFIED_DESC @1376
SAY DESC @1376

COPY ~BG1NPCSoA/Items/DEPO274.itm~ ~Override/DEPO274.itm~
SAY NAME1 @1377
SAY NAME2 @1377
SAY UNIDENTIFIED_DESC @1377
SAY DESC @1378

COPY ~BG1NPCSoA/Items/DEPO275.itm~ ~Override/DEPO275.itm~
SAY NAME1 @1379
SAY NAME2 @1379
SAY UNIDENTIFIED_DESC @1379
SAY DESC @1380

COPY ~BG1NPCSoA/Items/DEPO276.itm~ ~Override/DEPO276.itm~
SAY NAME1 @1381
SAY NAME2 @1381
SAY UNIDENTIFIED_DESC @1381
SAY DESC @1381

COPY ~BG1NPCSoA/Items/DEPO277.itm~ ~Override/DEPO277.itm~
SAY NAME1 @792
SAY NAME2 @1382
SAY UNIDENTIFIED_DESC @792
SAY DESC @1382

COPY ~BG1NPCSoA/Items/DEPO278.itm~ ~Override/DEPO278.itm~
SAY NAME1 @1383
SAY NAME2 @1383
SAY UNIDENTIFIED_DESC @1383
SAY DESC @1383

COPY ~BG1NPCSoA/Items/DEPO279.itm~ ~Override/DEPO279.itm~
SAY NAME1 @1384
SAY NAME2 @1384
SAY UNIDENTIFIED_DESC @1384
SAY DESC @1384

COPY ~BG1NPCSoA/Items/DEPO280.itm~ ~Override/DEPO280.itm~
SAY NAME1 @1385
SAY NAME2 @1385
SAY UNIDENTIFIED_DESC @1385
SAY DESC @1385

COPY ~BG1NPCSoA/Items/DEPO281.itm~ ~Override/DEPO281.itm~
SAY NAME1 @1386
SAY NAME2 @1386
SAY UNIDENTIFIED_DESC @1386
SAY DESC @1386

COPY ~BG1NPCSoA/Items/DEPO282.itm~ ~Override/DEPO282.itm~
SAY NAME1 @1387
SAY NAME2 @1387
SAY UNIDENTIFIED_DESC @1387
SAY DESC @1387

COPY ~BG1NPCSoA/Items/DEPO283.itm~ ~Override/DEPO283.itm~
SAY NAME1 @1388
SAY NAME2 @1388
SAY UNIDENTIFIED_DESC @1388
SAY DESC @1388

COPY ~BG1NPCSoA/Items/DEPO284.itm~ ~Override/DEPO284.itm~
SAY NAME1 @429
SAY NAME2 @429
SAY UNIDENTIFIED_DESC @429
SAY DESC @429

COPY ~BG1NPCSoA/Spells/squirrel.SPL~ ~Override/squirrel.SPL~
SAY NAME1 @429
 SAY UNIDENTIFIED_DESC @430

COPY ~BG1NPCSoA/Items/DEPO285.itm~ ~Override/DEPO285.itm~
SAY NAME1 @1389
SAY NAME2 @1389
SAY UNIDENTIFIED_DESC @1389
SAY DESC @1390

COPY ~BG1NPCSoA/Items/DEPO286.itm~ ~Override/DEPO286.itm~
SAY NAME1 @1391
SAY NAME2 @1391
SAY UNIDENTIFIED_DESC @1391
SAY DESC @1391

COPY ~BG1NPCSoA/Items/DEPO287.itm~ ~Override/DEPO287.itm~
SAY NAME1 @1392
SAY NAME2 @1392
SAY UNIDENTIFIED_DESC @1392
SAY DESC @1393

COPY ~BG1NPCSoA/Items/DEPO288.itm~ ~Override/DEPO288.itm~
SAY NAME1 @1394
SAY NAME2 @1394
SAY UNIDENTIFIED_DESC @1394
SAY DESC @1394

COPY ~BG1NPCSoA/Items/DEPO289.itm~ ~Override/DEPO289.itm~
SAY NAME1 @1395
SAY NAME2 @1395
SAY UNIDENTIFIED_DESC @1395
SAY DESC @1395

COPY ~BG1NPCSoA/Items/DEPO290.itm~ ~Override/DEPO290.itm~
SAY NAME1 @1396
SAY NAME2 @1396
SAY UNIDENTIFIED_DESC @1396
SAY DESC @1396

COPY ~BG1NPCSoA/Items/DEPO291.itm~ ~Override/DEPO291.itm~
SAY NAME1 @1397
SAY NAME2 @1397
SAY UNIDENTIFIED_DESC @1397
SAY DESC @1397

COPY ~BG1NPCSoA/Items/DEPO292.itm~ ~Override/DEPO292.itm~
SAY NAME1 @1398
SAY NAME2 @1398
SAY UNIDENTIFIED_DESC @1398
SAY DESC @1398

COPY ~BG1NPCSoA/Items/DEPO293.itm~ ~Override/DEPO293.itm~
SAY NAME1 @1399
SAY NAME2 @1399
SAY UNIDENTIFIED_DESC @1399
SAY DESC @1400

COPY ~BG1NPCSoA/Items/DEPO294.itm~ ~Override/DEPO294.itm~
SAY NAME1 @1401
SAY NAME2 @1401
SAY UNIDENTIFIED_DESC @1401
SAY DESC @1402

COPY ~BG1NPCSoA/Items/DEPO295.itm~ ~Override/DEPO295.itm~
SAY NAME1 @1403
SAY NAME2 @1403
SAY UNIDENTIFIED_DESC @1403
SAY DESC @1403

COPY ~BG1NPCSoA/Items/DEPO296.itm~ ~Override/DEPO296.itm~
SAY NAME1 @1404
SAY NAME2 @1404
SAY UNIDENTIFIED_DESC @1404
SAY DESC @1404

COPY ~BG1NPCSoA/Items/DEPO297.itm~ ~Override/DEPO297.itm~
SAY NAME1 @1405
SAY NAME2 @1405
SAY UNIDENTIFIED_DESC @1405
SAY DESC @1405


COPY ~BG1NPCSoA/Items/DEPO298.itm~ ~Override/DEPO298.itm~
SAY NAME1 @1406
SAY NAME2 @1406
SAY UNIDENTIFIED_DESC @1406
SAY DESC @1406

COPY ~BG1NPCSoA/Items/DEPO299.itm~ ~Override/DEPO299.itm~
SAY NAME1 @1407
SAY NAME2 @1407
SAY UNIDENTIFIED_DESC @1407
SAY DESC @1407

COPY ~BG1NPCSoA/Items/DEPO300.itm~ ~Override/DEPO300.itm~
SAY NAME1 @1408
SAY NAME2 @1408
SAY UNIDENTIFIED_DESC @1408
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1409" END

COPY ~BG1NPCSoA/Items/BGSX25.itm~ ~Override/BGSX25.itm~
SAY NAME1 @437
SAY NAME2 @437
SAY UNIDENTIFIED_DESC @437
SAY DESC @437



COPY ~BG1NPCSoA/Items/bgsx109.itm~ ~OVERRIDE/bgsx109.itm~
SAY NAME1 @1410
SAY NAME2 @1411
SAY UNIDENTIFIED_DESC @1410
SAY DESC @1411


COPY ~BG1NPCSoA/Items/bgsx110.itm~ ~OVERRIDE/bgsx110.itm~
SAY NAME1 @242
SAY NAME2 @1412
SAY UNIDENTIFIED_DESC @1413
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1414" END

COPY ~BG1NPCSoA/Items/bgsx111.itm~ ~OVERRIDE/bgsx111.itm~
SAY NAME1 @921
SAY NAME2 @1415
SAY UNIDENTIFIED_DESC @921
SAY DESC @1416

COPY ~BG1NPCSoA/Items/bgsx112.itm~ ~OVERRIDE/bgsx112.itm~
SAY NAME1 @927
SAY NAME2 @1417
SAY UNIDENTIFIED_DESC @927
SAY DESC @1417

COPY ~BG1NPCSoA/Items/bgsx113.itm~ ~OVERRIDE/bgsx113.itm~
SAY NAME1 @414
SAY NAME2 @1418
SAY UNIDENTIFIED_DESC @414
SAY DESC @1419

COPY ~BG1NPCSoA/Items/bgsx114.itm~ ~OVERRIDE/bgsx114.itm~
SAY NAME1 @369
SAY NAME2 @1420
SAY UNIDENTIFIED_DESC @369
SAY DESC @1421

COPY ~BG1NPCSoA/Items/bgsx115.itm~ ~OVERRIDE/bgsx115.itm~
SAY NAME1 @382
SAY NAME2 @1422
SAY UNIDENTIFIED_DESC @382
SAY DESC @1423

COPY ~BG1NPCSoA/Items/bgsx116.itm~ ~OVERRIDE/bgsx116.itm~
SAY NAME1 @1424
SAY NAME2 @1424
SAY UNIDENTIFIED_DESC @1424
SAY DESC @1425

COPY ~BG1NPCSoA/store/BG1NPC5.sto~ ~override~
SAY NAME2 @1426
//////////////////////////////////////////////////////////////////////////////////////////////

COPY ~BG1NPCSoA/BAM~ ~override~

COPY ~BG1NPCSoA/Items/bgnpc2.itm~ ~Override/bgnpc2.itm~
SAY NAME1 @1427
SAY NAME2 @1427
SAY UNIDENTIFIED_DESC @1427
SAY DESC @1428

COPY ~BG1NPCSoA/cre/KAGAIN'S-KORNER/KGSTO1.CRE~ ~override/KGSTO1.cre~
SAY NAME1 @1429
SAY NAME2 @1429

COPY ~BG1NPCSoA/cre/KAGAIN'S-KORNER/KGSTO3.CRE~ ~override/KGSTO3.cre~
SAY NAME1 @1430
SAY NAME2 @1430

COPY ~BG1NPCSoA/cre/KAGAIN'S-KORNER/KGSTO4.CRE~ ~override/KGSTO4.cre~
SAY NAME1 @1431
SAY NAME2 @1431

COPY ~BG1NPCSoA/store/BG1NPC.sto~ ~override~
SAY NAME2 @1432

COPY ~BG1NPCSoA/store/BG1NPC8.sto~ ~override~
SAY NAME2 @1433

COPY ~BG1NPCSoA/cre/MISC/7Xcre95.cre~ ~override/7Xcre95.cre~
SAY NAME1 @1434
SAY NAME2 @1434

COPY ~BG1NPCSoA/cre/MISC/7Xcre96.cre~ ~override/7Xcre96.cre~
SAY NAME1 @1435
SAY NAME2 @1435

COMPILE ~BG1NPCSoA/dialogues/MISC/BG1X42.d~
COMPILE ~BG1NPCSoA/scripts/7XKAGA.BAF~
COPY ~BG1NPCSoA/dialogues/KAGAIN'S-KORNER/AELOTUS.DLG~ ~override/AELOTUS.DLG~
COMPILE ~BG1NPCSoA/dialogues/7Xkaga.d~ 

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XkagaJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XkagaJ-begin.d~
END

COMPILE ~BG1NPCSoA/dialogues/7XkagaB.d~
COMPILE ~BG1NPCSoA/dialogues/KAGAIN'S-KORNER/kgsto1.d~ 
COMPILE ~BG1NPCSoA/dialogues/KAGAIN'S-KORNER/kgsto3.d~ 
COMPILE ~BG1NPCSoA/dialogues/KAGAIN'S-KORNER/kgsto4.d~ 
COMPILE ~BG1NPCSoA/dialogues/KAGAIN'S-KORNER/kgsto6.d~
EXTEND_TOP ~AR0700.bcs~ ~BG1NPCSoA/scripts/KAGAIN'S-KORNER/AR0700.baf~

APPEND ~pdialog.2da~
~7Xkaga	7XkagaP		7XkagaJ		7XkagaD 7Xkag25P 7Xkag25J 7Xkag25D 7Xkag25~
UNLESS ~7Xkaga~
APPEND ~interdia.2da~
  ~7Xkaga     7XkagaB       B7Xkag25~
  UNLESS ~7Xkaga~


// Kagain
  COPY_EXISTING ~7XCRE71.cre~ ~override~
    WRITE_EVALUATED_ASCII SCRIPT_OVERRIDE ~7XKAGA~ #8
  BUT_ONLY_IF_IT_CHANGES

ACTION_IF NOT FILE_EXISTS_IN_GAME ~override/bimoen2.dlg~ THEN BEGIN
  <<<<<<<< BG1NPCSoA/dialogues/MISC/BIMOEN2.d
  BEGIN BIMOEN2
  >>>>>>>>
  COMPILE ~BG1NPCSoA/dialogues/MISC/BIMOEN2.d~
END


//Giving Imoen a banter file if the Fixpack isn't installed

ACTION_IF NOT FILE_EXISTS_IN_GAME ~cdbehbla.pro~ //makes sure the fixpack isn't already installed
THEN BEGIN
ACTION_IF FILE_EXISTS_IN_GAME ~saradush.mve~ THEN BEGIN
  COPY_EXISTING ~interdia.2da~ ~override~
    SET_2DA_ENTRY 17 1 2 ~BIMOEN2~ // fixes ToB version
    BUT_ONLY_IF_IT_CHANGES
END ELSE BEGIN
  APPEND ~interdia.2da~ ~IMOEN       BIMOEN2~ // fixes SoA version
    UNLESS ~BIMOEN2~
END


//// Create and install a missing ToB-script file to avoid installation errors and not to use a script from the BG1&SOA
ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/7Xkaga.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/7Xkaga.baf~
END ELSE BEGIN
<<<<<<<<7Xkaga.baf
>>>>>>>>
	COMPILE ~7Xkaga.baf~
END

ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/7Xkag25.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/7Xkag25.baf~ END
ELSE BEGIN
<<<<<<<<7Xkag25.baf
>>>>>>>>
COMPILE ~7Xkag25.baf~
END


LAF ~EET_NPC_TRANSITION~
INT_VAR
type = 2 // NPC is summon-able if met before
default_ToB = 1
STR_VAR
dv = "7XCRE71" // death variable
override_SoA = "7Xkaga" // override script (SoA)
override_ToB = "7Xkag25" // override script (ToB)
cre_ToB = "7XCRE71"
dialog_ToB = "7Xkaga" // joining dialogue for ToB
traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/KagainTOB.tra"
string = "@0"
stringPosDV = "Keldorn"
END
OUTER_SPRINT ~tob_override~ ~7Xkag25~
OUTER_SPRINT ~tob_var~ ~KagainSummonedToB~
EXTEND_TOP ~7Xkaga.bcs~ ~fix_tob_script.baf~ EVALUATE_BUFFER
END


BEGIN @1436 DESIGNATED 35
GROUP ~Main Mod~
SUBCOMPONENT @797
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~

COPY_EXISTING ~sw1h01.itm~ ~override/7xbg1n.mrk~ // This file helps to determine if at least one component is installed - to disable the installation of the audio component and cross-banters if none of the main components is installed.

APPEND ~STATE.IDS~ ~0x80101FEF CD_STATE_NOTVALID~
UNLESS ~CD_STATE_NOTVALID~

// add Wilson dialog
ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN

<<<<<<<< wilson_dialog.d
BEGIN %wilson_dialog%
>>>>>>>>

ACTION_IF NOT FILE_EXISTS_IN_GAME ~BWILSON.dlg~ BEGIN
	OUTER_SPRINT ~wilson_dialog~ ~BWILSON~
	COMPILE ~wilson_dialog.d~ EVALUATE_BUFFER
END

APPEND ~interdia.2da~ ~WILSON BWILSON BWILSO25~
               UNLESS ~WILSON~

COPY_EXISTING ~pdialog.2da~ ~override~
  REPLACE_TEXTUALLY ~^[ %TAB%]*WILSON[ %TAB%].+$~
                    ~WILSON                 WILSONP                WILSONJ                WILSOND                WILSO25P               WILSO25J               WILSO25D               WILSON25~
BUT_ONLY
END

ACTION_IF FILE_EXISTS_IN_GAME ~KAGAIN11.cre~ BEGIN
// The code that is needed to remove Kagain from "The Darkest Day" mod and install Kagain from this mod instead
LAF CLEAR_SCRIPT_BLOCKS INT_VAR reverse = 1 STR_VAR search_text = ~KAGAINDD~ END
COPY_EXISTING ~AR0020.bcs~ ~override~
	DECOMPILE_AND_PATCH BEGIN
		SET start_offset = BUFFER_LENGTH - 1
		WHILE (start_offset >= 0) BEGIN
			LPF GET_SCRIPT_BLOCK INT_VAR reverse = 1 start_offset STR_VAR search_regexp = ~KAGAIN11~ RET start_offset end_offset END
			PATCH_IF start_offset >= 0 BEGIN
				DELETE_BYTES start_offset (end_offset - start_offset)
			END
		END
	END
	BUT_ONLY_IF_IT_CHANGES

COPY_EXISTING ~pdialog.2da~ ~override~
	REPLACE_TEXTUALLY ~[ %TAB%%LNL%%WNL%%MNL%]KAGAINDD.*$~ ~~

/*KAGAIN BGT + "The Darkest Day" mod compatibility*/
ACTION_IF GAME_IS ~bgt~ BEGIN
	COPY_EXISTING ~AR0020.bcs~ ~override~
		DECOMPILE_AND_PATCH BEGIN
			SET start_offset = BUFFER_LENGTH - 1
			WHILE (start_offset >= 0) BEGIN
				LPF GET_SCRIPT_BLOCK INT_VAR reverse = 1 start_offset STR_VAR search_regexp = ~BP_KagainBG1Check~ RET start_offset end_offset END
				PATCH_IF start_offset >= 0 BEGIN
					DELETE_BYTES start_offset (end_offset - start_offset)
				END
			END
		END
	BUT_ONLY_IF_IT_CHANGES

	OUTER_SPRINT ~aram00_bgt~ ~IF
    InParty("Kagain")
    Global("MeetOldenFriends","GLOBAL",22)
THEN
  RESPONSE #100
    ActionOverride("Kagain",LeaveParty())
    ActionOverride("Kagain",ChangeAIScript("",DEFAULT))
    ActionOverride("Kagain",ClearAllActions())
    ActionOverride("Kagain",DestroySelf())
    SetGlobal("MeetOldenFriends","GLOBAL",23)
    Continue()
END~
	OUTER_SET ~strlen~ = STRING_LENGTH ~%aram00_bgt%~

	COPY_EXISTING ~aram00.bcs~ ~override~
		DECOMPILE_AND_PATCH BEGIN
			LPF GET_SCRIPT_BLOCK STR_VAR search_regexp = ~KagainPartyBG1~ RET start_offset end_offset END
			PATCH_IF start_offset >= 0 BEGIN
				DELETE_BYTES start_offset (end_offset - start_offset)
				INSERT_BYTES start_offset strlen
				WRITE_ASCIIE start_offset ~%aram00_bgt%~
			END
		END
		BUT_ONLY_IF_IT_CHANGES
END

END

COPY ~BG1NPCSoA/Cre/7XCRE71.cre~ ~override/7XCRE71.cre~
SAY NAME1 @798
SAY NAME2 @799
SAY BIO @800
 SAY INITIAL_MEETING ~~ [KAGAIN4]
  SAY MORALE ~~ 
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED @802
  SAY UNHAPPY_SERIOUS @802
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER @803
  SAY TIRED @804
  SAY BORED ~~ [KAGAIND]
  SAY BATTLE_CRY1 ~~ [KAGAINA]
  SAY BATTLE_CRY2 ~~ [KAGAINK]
  SAY BATTLE_CRY3 ~~ [KAGAIN8]
  SAY BATTLE_CRY4 ~~ [KAGAINK]
  SAY BATTLE_CRY5 ~~ [KAGAIN8]
  SAY DAMAGE ~~ [KAGAINL]
  SAY DYING ~~ [KAGAINM]
  SAY HURT @811
  SAY AREA_FOREST ~~ [KAGAINN]
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [KAGAING]
  SAY SELECT_COMMON2 @814
  SAY SELECT_COMMON3 @815
  SAY SELECT_COMMON4 ~~ [KAGAING]
  SAY SELECT_COMMON5 @816
  SAY SELECT_COMMON6 @815
  SAY SELECT_ACTION1 @817
  SAY SELECT_ACTION2 @818
  SAY SELECT_ACTION3 @819 
  SAY SELECT_ACTION4  @817
  SAY SELECT_ACTION5 @818
  SAY SELECT_ACTION6 @819 
  SAY SELECT_ACTION7 @817
  SAY SELECT_RARE1 @820
  SAY SELECT_RARE2 @817
  SAY CRITICAL_HIT ~~ 
  SAY CRITICAL_MISS ~~ 
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET @821
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [KAGAIN!]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END
LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Kagain" oggdec_path = "BG1NPCSoA/sounds" END

ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
COPY ~BG1NPCSoA/portraits/Kagain/EE-portraits/~ ~override~
END ELSE BEGIN
COPY ~BG1NPCSoA/portraits/Kagain/vanilla-portraits~ ~override~
END

COPY ~BG1NPCSoA/Items/PLATNUM.itm~ ~Override/PLATNUM.itm~
SAY NAME1 @303		
SAY NAME2 @303
SAY UNIDENTIFIED_DESC @303
SAY DESC @823

COPY ~BG1NPCSoA/BAM~ ~override~

COPY ~BG1NPCSoA/Items/bgnpc2.itm~ ~Override/bgnpc2.itm~
SAY NAME1 @1427
SAY NAME2 @1427
SAY UNIDENTIFIED_DESC @1427
SAY DESC @1428

COPY ~BG1NPCSoA/cre/KAGAIN'S-KORNER/KGSTO1.CRE~ ~override/KGSTO1.cre~
SAY NAME1 @1429
SAY NAME2 @1429

COPY ~BG1NPCSoA/cre/KAGAIN'S-KORNER/KGSTO3.CRE~ ~override/KGSTO3.cre~
SAY NAME1 @1430
SAY NAME2 @1430

COPY ~BG1NPCSoA/cre/KAGAIN'S-KORNER/KGSTO4.CRE~ ~override/KGSTO4.cre~
SAY NAME1 @1431
SAY NAME2 @1431

COPY ~BG1NPCSoA/store/BG1NPCZ.sto~ ~override/BG1NPC.sto~
SAY NAME2 @1432

COPY ~BG1NPCSoA/store/BG1NPC5.sto~ ~override/BG1NPC5.sto~
SAY NAME2 @1426

COPY ~BG1NPCSoA/store/BG1NPC8.sto~ ~override/BG1NPC8.sto~
SAY NAME2 @1433

COPY ~BG1NPCSoA/cre/MISC/7Xcre95.cre~ ~override/7Xcre95.cre~
SAY NAME1 @1434
SAY NAME2 @1434

COPY ~BG1NPCSoA/cre/MISC/7Xcre96.cre~ ~override/7Xcre96.cre~
SAY NAME1 @1435
SAY NAME2 @1435

COMPILE ~BG1NPCSoA/dialogues/MISC/BG1X42.d~
COMPILE ~BG1NPCSoA/scripts/7XKAGA.BAF~
COPY ~BG1NPCSoA/dialogues/KAGAIN'S-KORNER/AELOTUS.DLG~ ~override/AELOTUS.DLG~
COMPILE ~BG1NPCSoA/dialogues/7Xkaga.d~ 

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XkagaJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XkagaJ-begin.d~
END

COMPILE ~BG1NPCSoA/dialogues/7XkagaB.d~
COMPILE ~BG1NPCSoA/dialogues/KAGAIN'S-KORNER/kgsto1.d~ 
COMPILE ~BG1NPCSoA/dialogues/KAGAIN'S-KORNER/kgsto3.d~ 
COMPILE ~BG1NPCSoA/dialogues/KAGAIN'S-KORNER/kgsto4.d~ 
COMPILE ~BG1NPCSoA/dialogues/KAGAIN'S-KORNER/kgsto6.d~
EXTEND_TOP ~AR0700.bcs~ ~BG1NPCSoA/scripts/KAGAIN'S-KORNER/AR0700.baf~

APPEND ~pdialog.2da~
~7Xkaga	7XkagaP		7XkagaJ		7XkagaD 7Xkag25P 7Xkag25J 7Xkag25D 7Xkag25~
UNLESS ~7Xkaga~
APPEND ~interdia.2da~
  ~7Xkaga     7XkagaB       B7Xkag25~
  UNLESS ~7Xkaga~


// Kagain
  COPY_EXISTING ~7XCRE71.cre~ ~override~
    WRITE_EVALUATED_ASCII SCRIPT_OVERRIDE ~7XKAGA~ #8
  BUT_ONLY_IF_IT_CHANGES

ACTION_IF NOT FILE_EXISTS_IN_GAME ~override/bimoen2.dlg~ THEN BEGIN
  <<<<<<<< BG1NPCSoA/dialogues/MISC/BIMOEN2.d
  BEGIN BIMOEN2
  >>>>>>>>
  COMPILE ~BG1NPCSoA/dialogues/MISC/BIMOEN2.d~
END

//Giving Imoen a banter file if the Fixpack isn't installed

ACTION_IF NOT FILE_EXISTS_IN_GAME ~cdbehbla.pro~ //makes sure the fixpack isn't already installed
THEN BEGIN
ACTION_IF FILE_EXISTS_IN_GAME ~saradush.mve~ THEN BEGIN
  COPY_EXISTING ~interdia.2da~ ~override~
    SET_2DA_ENTRY 17 1 2 ~BIMOEN2~ // fixes ToB version
    BUT_ONLY_IF_IT_CHANGES
END ELSE BEGIN
  APPEND ~interdia.2da~ ~IMOEN       BIMOEN2~ // fixes SoA version
    UNLESS ~BIMOEN2~
END
END

COMPILE ~BG1NPCSoA/dialogues/KagainTOB.d~

// Kagain's Epilogue
EXTEND_TOP ~AR6200.bcs~ ~BG1NPCSoA/epilogues/Kagain/AR6200.baf~

COPY ~BG1NPCSoA/epilogues/Kagain/KagaEp.2da~ ~override/KagaEp.2da~
REPLACE ~99999~ @8008

// EET Fate Spirit Kagain

ACTION_IF (GAME_IS ~eet~) BEGIN
INCLUDE ~EET/other/EET_functions.tph~ // functions from EET mod

// remove duplication in the call dialog with the option of the original EET
<<<<<<<< Kagain_fix.baf
IF
	!Global("KagainSummoned","GLOBAL",2)
THEN
	RESPONSE #100
		SetGlobal("KagainSummoned","GLOBAL",2)
		Continue()
END
>>>>>>>>
EXTEND_BOTTOM ~AR4000.bcs~ ~Kagain_fix.baf~

//// Create and install a missing ToB-script file to avoid installation errors and not to use a script from the BG1&SOA
ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/7Xkaga.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/7Xkaga.baf~
END ELSE BEGIN
<<<<<<<<7Xkaga.baf
>>>>>>>>
	COMPILE ~7Xkaga.baf~
END

ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/7Xkag25.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/7Xkag25.baf~ END
ELSE BEGIN
<<<<<<<<7Xkag25.baf
>>>>>>>>
COMPILE ~7Xkag25.baf~
END


LAF ~EET_NPC_TRANSITION~
INT_VAR
type = 2 // NPC is summon-able if met before
default_ToB = 1
STR_VAR
dv = "7XCRE71" // death variable
override_SoA = "7Xkaga" // override script (SoA)
override_ToB = "7Xkag25" // override script (ToB)
cre_ToB = "7XCRE71"
dialog_ToB = "7Xkaga" // joining dialogue for ToB
traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/KagainTOB.tra"
string = "@0"
stringPosDV = "Keldorn"
END
OUTER_SPRINT ~tob_override~ ~7Xkag25~
OUTER_SPRINT ~tob_var~ ~KagainSummonedToB~
EXTEND_TOP ~7Xkaga.bcs~ ~fix_tob_script.baf~ EVALUATE_BUFFER
END

/////////////////////////////////

BEGIN @1437 DESIGNATED 40
GROUP ~Main Mod~
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~

COPY_EXISTING ~sw1h01.itm~ ~override/7xbg1n.mrk~ // This file helps to determine if at least one component is installed - to disable the installation of the audio component and cross-banters if none of the main components is installed.

APPEND ~STATE.IDS~ ~0x80101FEF CD_STATE_NOTVALID~
UNLESS ~CD_STATE_NOTVALID~


// add Wilson dialog
ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN

<<<<<<<< wilson_dialog.d
BEGIN %wilson_dialog%
>>>>>>>>
ACTION_IF NOT FILE_EXISTS_IN_GAME ~BWILSON.dlg~ BEGIN
	OUTER_SPRINT ~wilson_dialog~ ~BWILSON~
	COMPILE ~wilson_dialog.d~ EVALUATE_BUFFER
END

APPEND ~interdia.2da~ ~WILSON BWILSON BWILSO25~
               UNLESS ~WILSON~

COPY_EXISTING ~pdialog.2da~ ~override~
  REPLACE_TEXTUALLY ~^[ %TAB%]*WILSON[ %TAB%].+$~
                    ~WILSON                 WILSONP                WILSONJ                WILSOND                WILSO25P               WILSO25J               WILSO25D               WILSON25~
BUT_ONLY
END


// Set the portrait for Faldorn before joining to the group
ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN	
INCLUDE ~%MOD_FOLDER%/lib/standardEE.tph~		
	OUTER_SET s9total=0
	OUTER_SET rows_cnt_1=0
	COPY - ~%MOD_FOLDER%/portraits/cefaldor.tbl~  ~%MOD_FOLDER%/portraits/cefaldor.tbl~
		COUNT_2DA_ROWS 1 "rows_cnt_1"
			FOR( cntg=0; cntg<"%rows_cnt_1%"; cntg+=1 ) BEGIN
				READ_2DA_ENTRY cntg  0 2 "Crename"
				READ_2DA_ENTRY cntg  1 2 "Filename"
				INNER_ACTION BEGIN
					ACTION_IF FILE_EXISTS_IN_GAME ~%Crename%.cre~ THEN BEGIN
						OUTER_SET s9total+=1
						LAUNCH_ACTION_MACRO ~Addpic~ 
					END
				END
END
END
ELSE BEGIN
INCLUDE ~%MOD_FOLDER%/lib/standardold.tph~	
	OUTER_SET s9total=0
	OUTER_SET rows_cnt_1=0
	COPY - ~%MOD_FOLDER%/portraits/cefaldor.tbl~  ~%MOD_FOLDER%/portraits/cefaldor.tbl~
		COUNT_2DA_ROWS 1 "rows_cnt_1"
			FOR( cntg=0; cntg<"%rows_cnt_1%"; cntg+=1 ) BEGIN
				READ_2DA_ENTRY cntg  0 2 "Crename"
				READ_2DA_ENTRY cntg  1 2 "Filename"
				INNER_ACTION BEGIN
					ACTION_IF FILE_EXISTS_IN_GAME ~%Crename%.cre~ THEN BEGIN
						OUTER_SET s9total+=1
						LAUNCH_ACTION_MACRO ~Addpic~ 
					END
				END
END
END	

ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
COPY ~BG1NPCSoA/portraits/Faldorn/EE-portraits/~ ~override~
END ELSE BEGIN
COPY ~BG1NPCSoA/portraits/Faldorn/vanilla-portraits~ ~override~
END


COPY ~BG1NPCSoA/cre/FALDORN/7xcreee.CRE~ ~override/7xcreee.cre~
SAY NAME1 @1439
SAY NAME2 @1439

COPY ~BG1NPCSoA/cre/FALDORN/7xcreff.CRE~ ~override/7xcreff.cre~
SAY NAME1 @1440
SAY NAME2 @1440

COPY ~BG1NPCSoA/cre/FALDORN/7xcregg.CRE~ ~override/7xcregg.cre~
SAY NAME1 @1441
SAY NAME2 @1441

COPY ~BG1NPCSoA/cre/FALDORN/7xcreii.CRE~ ~override/7xcreii.cre~
SAY NAME1 @1442
SAY NAME2 @1442

COPY ~BG1NPCSoA/cre/FALDORN/7xcrejj.CRE~ ~override/7xcrejj.cre~
SAY NAME1 @1443
SAY NAME2 @1443

COPY ~BG1NPCSoA/Cre/7XCRE72.CRE~ ~override/7XCRE72.cre~
SAY NAME1 @1438
SAY NAME2 @1438
SAY BIO @1444
SAY INITIAL_MEETING ~~ [CEFALD02]
  SAY MORALE ~~ [FALDO26]
  SAY HAPPY ~~ [faldo18]
  SAY UNHAPPY_ANNOYED ~~ [FALDO03]
  SAY UNHAPPY_SERIOUS ~~ [FALDO26]
  SAY UNHAPPY_BREAKING ~~ [CEFALD10]
  SAY LEADER ~~ [CEFALD07]
  SAY TIRED ~~ [FALDO10]
  SAY BORED ~~ [CEFALD11]
  SAY BATTLE_CRY1 ~~ [CEFALD03]
  SAY BATTLE_CRY2 ~~ [CEFALD04]
  SAY BATTLE_CRY3 ~~ [CEFALD03]
  SAY BATTLE_CRY4 ~~ [CEFALD04]
  SAY BATTLE_CRY5 ~~ [CEFALD12]
  SAY DAMAGE ~~ [CEFALD05]
  SAY DYING ~~ [CEFALD06]
  SAY HURT ~~ [CEFALD18]
  SAY AREA_FOREST ~~ [FALDO04]
  SAY AREA_CITY ~~ [FALDO33]
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [FALDO19]
  SAY SELECT_COMMON2 ~~ [FALDO17]
  SAY SELECT_COMMON3 ~~ [FALDO03]
  SAY SELECT_COMMON4 ~~ [FALDO19]
  SAY SELECT_COMMON5 ~~ [FALDO26]
  SAY SELECT_COMMON6 ~~ [FALDO27]
  SAY SELECT_ACTION1 ~~ [FALDO23]
  SAY SELECT_ACTION2 ~~ [FALDO24]
  SAY SELECT_ACTION3 ~~ [CEFALD01]
  SAY SELECT_ACTION4  ~~ [FALDO23]
  SAY SELECT_ACTION5 ~~ [FALDO24]
  SAY SELECT_ACTION6 ~~ [CEFALD01]
  SAY SELECT_ACTION7 ~~ [FALDO24]
  SAY SELECT_RARE1 ~~ [FALDO26]
  SAY SELECT_RARE2 ~~ [FALDO27]
  SAY CRITICAL_HIT ~~ 
  SAY CRITICAL_MISS ~~ 
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [FALDO39]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END

LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Faldorn" oggdec_path = "BG1NPCSoA/sounds" END

ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
   // If a EE-version is installed, change the journal entries to adapt it 
  ADD_JOURNAL @1776 @1777 @1778 USING ~%MOD_FOLDER%/tra/%LANGUAGE%/setup.tra~ 
END 

EXTEND_TOP ~AR2007.bcs~ ~BG1NPCSoA/scripts/FALDORN/AR2007.baf~
EXTEND_TOP ~AR2008.bcs~ ~BG1NPCSoA/scripts/FALDORN/AR2008.baf~
EXTEND_TOP ~AR2011.bcs~ ~BG1NPCSoA/scripts/FALDORN/AR2011.baf~
EXTEND_TOP ~AR2012.bcs~ ~BG1NPCSoA/scripts/FALDORN/AR2012.baf~
EXTEND_TOP ~AR2014.bcs~ ~BG1NPCSoA/scripts/FALDORN/AR2014.baf~


EXTEND_TOP ~AR2000.bcs~ ~BG1NPCSoA/scripts/FALDORN/AR2000.baf~
EXTEND_TOP ~AR1400.bcs~ ~BG1NPCSoA/scripts/FALDORN/AR1400.baf~
EXTEND_TOP ~AR1404.bcs~ ~BG1NPCSoA/scripts/FALDORN/AR1404.baf~
EXTEND_TOP ~AR1900.bcs~ ~BG1NPCSoA/scripts/FALDORN/AR1900.baf~

EXTEND_TOP ~GP116.bcs~ ~BG1NPCSoA/scripts/FALDORN/GP116.baf~

COPY ~BG1NPCSoA/Spells/OWLW.SPL~ ~Override/OWLW.SPL~
SAY NAME1  @597
 SAY UNIDENTIFIED_DESC @598

COPY ~BG1NPCSoA/Spells/SPIN884.SPL~ ~Override/SPIN884.SPL~
SAY NAME1  @565
 SAY UNIDENTIFIED_DESC @565

COPY ~BG1NPCSoA/Spells/FALDORN/spin114.SPL~ ~override/spin114.SPL~
SAY NAME1  @1468
 SAY UNIDENTIFIED_DESC @1468

COPY ~BG1NPCSoA/Spells/SPPR116.SPL~ ~Override/SPPR116.SPL~
SAY NAME1  @508
 SAY UNIDENTIFIED_DESC @509

COPY ~BG1NPCSoA/BAM~ ~override~

APPEND ~pdialog.2da~
~7XFALD	7XFALDP	7XFALDJ	7XFALDD  7XFAL25P 7XFAL25J 7XFAL25D 7XFAL25~
UNLESS ~7XFALD~
APPEND ~interdia.2da~
  ~7XFALD     7XFALDB       B7XFAL25~
  UNLESS ~7XFALD~

// Faldorn
  COPY_EXISTING ~7XCRE72.cre~ ~override~
    WRITE_EVALUATED_ASCII SCRIPT_OVERRIDE ~7XFALD~ #8
  BUT_ONLY_IF_IT_CHANGES


ACTION_IF FILE_EXISTS_IN_GAME ~7XFALDJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/Faldorn/7XFALD.d~
END ELSE BEGIN
COMPILE ~BG1NPCSoA/dialogues/Faldorn/7XFALD-begin.d~
COMPILE ~BG1NPCSoA/dialogues/Faldorn/7XFALD.d~
END


COMPILE ~BG1NPCSoA/scripts/Faldorn/7XFALD.baf~

COMPILE ~BG1NPCSoA/dialogues/FALDORN/7XFALD25.d~
EXTEND_TOP ~AR4500.bcs~ ~BG1NPCSoA/scripts/MISC/AR4500Faldorn.baf~
EXTEND_TOP ~AR5203.bcs~ ~BG1NPCSoA/scripts/MISC/AR5203Faldorn.baf~

// Faldorn's Epilogue
EXTEND_TOP ~AR6200.bcs~ ~BG1NPCSoA/epilogues/Faldorn/AR6200.baf~
COPY ~BG1NPCSoA/epilogues/Faldorn/FaldEp.2da~ ~override/FaldEp.2da~
REPLACE ~99999~ @8002

// EET Fate Spirit Faldorn

ACTION_IF (GAME_IS ~eet~) BEGIN
INCLUDE ~EET/other/EET_functions.tph~ // functions from EET mod

// remove duplication in the call dialog with the option of the original EET
<<<<<<<< faldorn_fix.baf
IF
	!Global("FaldornSummoned","GLOBAL",2)
THEN
	RESPONSE #100
		SetGlobal("FaldornSummoned","GLOBAL",2)
		Continue()
END
>>>>>>>>
EXTEND_BOTTOM ~AR4000.bcs~ ~faldorn_fix.baf~


//// Create and install a missing ToB-script file to avoid installation errors and not to use a script from the BG1&SOA

ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/Faldorn/7XFAL25.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/Faldorn/7XFAL25.baf~ END
ELSE BEGIN
<<<<<<<<7XFAL25.baf
>>>>>>>>
COMPILE ~7XFAL25.baf~
END

LAF ~EET_NPC_TRANSITION~
INT_VAR
type = 2 // NPC is summon-able if met before
default_ToB = 1
STR_VAR
dv = "7XCRE72" // death variable in 7XFALD25.d
override_SoA = "7XFALD" // override script (SoA)
override_ToB = "7XFAL25" // override script (ToB)
cre_ToB = "7XCRE72"
dialog_ToB = "7XFALD" // joining dialogue for ToB
traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/7XFALD25.tra"
string = "@0"
stringPosDV = "Garrick"
END

OUTER_SPRINT ~tob_override~ ~7XFAL25~
OUTER_SPRINT ~tob_var~ ~FaldornSummonedToB~
EXTEND_TOP ~7XFALD.bcs~ ~fix_tob_script.baf~ EVALUATE_BUFFER
END 

BEGIN @1485 DESIGNATED 45
GROUP ~Main Mod~
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~

COPY_EXISTING ~sw1h01.itm~ ~override/7xbg1n.mrk~ // This file helps to determine if at least one component is installed - to disable the installation of the audio component and cross-banters if none of the main components is installed.

APPEND ~STATE.IDS~ ~0x80101FEF CD_STATE_NOTVALID~
UNLESS ~CD_STATE_NOTVALID~

//MONTARON

ACTION_IF FILE_EXISTS_IN_GAME ~MONTYRA2.bcs~ // Check "The Darkest Day" mod installed
THEN BEGIN
// The code that is needed to remove Montaron from "The Darkest Day" mod and install Montaron from this mod instead
LAF CLEAR_SCRIPT_BLOCKS INT_VAR reverse = 1 STR_VAR search_text = ~MONTYDD~ END
COPY_EXISTING ~MONTYRA2.bcs~ ~override~
	DECOMPILE_AND_PATCH BEGIN
		SET start_offset = BUFFER_LENGTH - 1
		WHILE (start_offset >= 0) BEGIN
			LPF GET_SCRIPT_BLOCK INT_VAR reverse = 1 start_offset STR_VAR search_regexp = ~montar13~ RET start_offset end_offset END
			PATCH_IF start_offset >= 0 BEGIN
				DELETE_BYTES start_offset (end_offset - start_offset)
			END
		END
	END
	BUT_ONLY_IF_IT_CHANGES
COPY_EXISTING ~MONTYRAS.bcs~ ~override~
	DECOMPILE_AND_PATCH BEGIN
		SET start_offset = BUFFER_LENGTH - 1
		WHILE (start_offset >= 0) BEGIN
			LPF GET_SCRIPT_BLOCK INT_VAR reverse = 1 start_offset STR_VAR search_regexp = ~montar13~ RET start_offset end_offset END
			PATCH_IF start_offset >= 0 BEGIN
				DELETE_BYTES start_offset (end_offset - start_offset)
			END
		END
	END
	BUT_ONLY_IF_IT_CHANGES

COPY_EXISTING ~pdialog.2da~ ~override~
	REPLACE_TEXTUALLY ~[ %TAB%%LNL%%WNL%%MNL%]MONTYDD.*$~ ~~
END


COPY ~BG1NPCSoA/Cre/7XCRE74.cre~ ~override/7XCRE74.cre~
SAY NAME1 @1486
SAY NAME2 @1486
SAY BIO @1487
SAY INITIAL_MEETING ~~ 
  SAY MORALE ~~ 
  SAY HAPPY @1488 
  SAY UNHAPPY_ANNOYED @1489
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER @1490
  SAY TIRED @1491
  SAY BORED @1492 
  SAY BATTLE_CRY1 @1493
  SAY BATTLE_CRY2 @1494 
  SAY BATTLE_CRY3 @1495
  SAY BATTLE_CRY4 @1494 
  SAY BATTLE_CRY5 @1496
  SAY DAMAGE ~~ [monty34]
  SAY DYING ~~ [monty37]
  SAY HURT @1499
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY @1500 
  SAY AREA_DUNGEON @1501 
  SAY AREA_DAY @1502 
  SAY AREA_NIGHT ~~ [monty43]
  SAY SELECT_COMMON1  @1504
  SAY SELECT_COMMON2 @1505
  SAY SELECT_COMMON3 ~~ 
  SAY SELECT_COMMON4 ~~ [monty12]
  SAY SELECT_COMMON5 ~~ [monty22]
  SAY SELECT_COMMON6 @1508
  SAY SELECT_ACTION1 @1509
  SAY SELECT_ACTION2 ~~ [monty20]
  SAY SELECT_ACTION3 ~~ [monty19]
  SAY SELECT_ACTION4  ~~ [monty26]
  SAY SELECT_ACTION5 ~~ [monty20]
  SAY SELECT_ACTION6 ~~ [monty28]
  SAY SELECT_ACTION7 @1514
  SAY SELECT_RARE1 ~~ 
  SAY SELECT_RARE2 ~~ 
  SAY CRITICAL_HIT ~~ 
  SAY CRITICAL_MISS ~~ 
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL @1515
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XMONTJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XMONTJ-begin.d~
END

COMPILE ~BG1NPCSoA/dialogues/MONTARON-QUEST/MQFIRE1.d~
EXTEND_TOP ~AR0701.bcs~ ~BG1NPCSoA/scripts/MONTARON-QUEST/AR0701.baf~
COMPILE ~BG1NPCSoA/scripts/7XMONT.baf~

EXTEND_TOP ~AR0407.bcs~ ~BG1NPCSoA/scripts/AR0407.baf~

EXTEND_TOP ~Anomen.bcs~ ~BG1NPCSoA/scripts/AnomenRomConf.baf~

ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
EXTEND_TOP ~Rasaad.bcs~ ~BG1NPCSoA/scripts/RasaadRomConf.baf~
EXTEND_TOP ~Dorn.bcs~ ~BG1NPCSoA/scripts/DornRomConf.baf~
END

APPEND ~pdialog.2da~
~7XMONT	7XMONTP	7XMONTJ	7XMONTD 7XMON25P 7XMON25J 7XMON25D 7XMON25~
UNLESS ~7XMONT~
APPEND ~interdia.2da~
  ~7XMONT  7XMONTB B7XMON25~
  UNLESS ~7XMONT~

// Montaron
  COPY_EXISTING ~7XCRE74.cre~ ~override~
    WRITE_EVALUATED_ASCII SCRIPT_OVERRIDE ~7XMONT~ #8
  BUT_ONLY_IF_IT_CHANGES


// XZAR
ACTION_IF FILE_EXISTS_IN_GAME ~xzar13.cre~ BEGIN

// The code that is needed to remove Xzar from "The Darkest Day" mod and install Xzar from this mod instead
LAF CLEAR_SCRIPT_BLOCKS INT_VAR reverse = 1 STR_VAR search_text = ~XZARDD~ END
COPY_EXISTING ~AR0300.bcs~ ~override~
	DECOMPILE_AND_PATCH BEGIN
		SET start_offset = BUFFER_LENGTH - 1
		WHILE (start_offset >= 0) BEGIN
			LPF GET_SCRIPT_BLOCK INT_VAR reverse = 1 start_offset STR_VAR search_regexp = ~xzar13~ RET start_offset end_offset END
			PATCH_IF start_offset >= 0 BEGIN
				DELETE_BYTES start_offset (end_offset - start_offset)
			END
		END
	END
	BUT_ONLY_IF_IT_CHANGES

COPY_EXISTING ~AR0300.bcs~ ~override~
	DECOMPILE_AND_PATCH BEGIN
		SET start_offset = BUFFER_LENGTH - 1
		WHILE (start_offset >= 0) BEGIN
			LPF GET_SCRIPT_BLOCK INT_VAR reverse = 1 start_offset STR_VAR search_regexp = ~XzarPartyBG1~ RET start_offset end_offset END
			PATCH_IF start_offset >= 0 BEGIN
				DELETE_BYTES start_offset (end_offset - start_offset)
			END
		END
	END
BUT_ONLY_IF_IT_CHANGES
OUTER_SPRINT ~AR3000_script~ ~IF
	OR(2)
		Global("LyrosJob","GLOBAL",3)
		Dead("lyros")
	Exists("Rylock")
	Global("RylockLeavesHarperDoor","AR0300",0)
THEN
	RESPONSE #100
		SetGlobal("RylockLeavesHarperDoor","AR0300",1)
		CloseDoor("DOOR0308")
		Lock("DOOR0308")
		ActionOverride("Rylock",EscapeArea())
END~
COPY_EXISTING ~AR0300.bcs~ ~override~
	DECOMPILE_AND_PATCH BEGIN
		LPF GET_SCRIPT_BLOCK STR_VAR search_regexp = ~LyrosSpawn~ RET start_offset end_offset script_block END
		PATCH_IF start_offset >= 0 BEGIN
			DELETE_BYTES start_offset (end_offset - start_offset)
			SPRINT ~new_script~ ~%AR3000_script%%LNL%%LNL%%script_block%%LNL%%LNL%~
			SET strlen = STRING_LENGTH ~%new_script%~
			INSERT_BYTES start_offset strlen
			WRITE_ASCIIE start_offset ~%new_script%~
		END
	END



COPY_EXISTING ~pdialog.2da~ ~override~
	REPLACE_TEXTUALLY ~[ %TAB%%LNL%%WNL%%MNL%]XZARDD.*$~ ~~

/*XZAR BGT + "The Darkest Day" mod compatibility*/
ACTION_IF GAME_IS ~bgt~ BEGIN
	COPY_EXISTING ~AR0300.bcs~ ~override~
		DECOMPILE_AND_PATCH BEGIN
			SET start_offset = BUFFER_LENGTH - 1
			WHILE (start_offset >= 0) BEGIN
				LPF GET_SCRIPT_BLOCK INT_VAR reverse = 1 start_offset STR_VAR search_regexp = ~BP_XzarBG1Check~ RET start_offset end_offset END
				PATCH_IF start_offset >= 0 BEGIN
					DELETE_BYTES start_offset (end_offset - start_offset)
				END
			END
		END
	BUT_ONLY_IF_IT_CHANGES

	OUTER_SPRINT ~aram00_bgt~ ~IF
    InParty("Xzar")
    Global("MeetOldenFriends","GLOBAL",9)
THEN
  RESPONSE #100
    ActionOverride("Xzar",LeaveParty())
    ActionOverride("Xzar",ChangeAIScript("",DEFAULT))
    ActionOverride("Xzar",ClearAllActions())
    ActionOverride("Xzar",DestroySelf())
    SetGlobal("MeetOldenFriends","GLOBAL",10)
    Continue()
END~
	OUTER_SET ~strlen~ = STRING_LENGTH ~%aram00_bgt%~

	COPY_EXISTING ~aram00.bcs~ ~override~
		DECOMPILE_AND_PATCH BEGIN
			LPF GET_SCRIPT_BLOCK STR_VAR search_regexp = ~XzarPartyBG1~ RET start_offset end_offset END
			PATCH_IF start_offset >= 0 BEGIN
				DELETE_BYTES start_offset (end_offset - start_offset)
				INSERT_BYTES start_offset strlen
				WRITE_ASCIIE start_offset ~%aram00_bgt%~
			END
		END
		BUT_ONLY_IF_IT_CHANGES
END

END

COPY ~BG1NPCSoA/Cre/7XCRE75.cre~ ~override/7XCRE75.cre~
SAY NAME1 @1517
SAY NAME2 @1517
SAY BIO @1518
SAY INITIAL_MEETING ~~ 
  SAY MORALE ~~ [xzar43]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ 
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING @1520
  SAY LEADER ~~ [xzar8]
  SAY TIRED ~~ [xzar10]
  SAY BORED ~~ [xzar12]
  SAY BATTLE_CRY1 ~~ [xzar40]
  SAY BATTLE_CRY2 ~~ [xzar4]
  SAY BATTLE_CRY3 ~~ [xzar40]
  SAY BATTLE_CRY4 ~~ [xzar41]
  SAY BATTLE_CRY5 ~~ [xzar40]
  SAY DAMAGE ~~ [xzar34]
  SAY DYING ~~ [xzar42]
  SAY HURT ~~ [xzar37]
  SAY AREA_FOREST ~~ [xzar30]
  SAY AREA_CITY ~~ [xzar44]
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ [xzar44]
  SAY SELECT_COMMON1  ~~ [xzar16]
  SAY SELECT_COMMON2 ~~ [xzar17]
  SAY SELECT_COMMON3 ~~ [xzar19]
  SAY SELECT_COMMON4 ~~ [xzar18]
  SAY SELECT_COMMON5 ~~ [xzar20]
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ [xzar23]
  SAY SELECT_ACTION2 ~~ [xzar24]
  SAY SELECT_ACTION3 ~~ [xzar25]
  SAY SELECT_ACTION4  ~~ [xzar26]
  SAY SELECT_ACTION5 ~~ [xzar27]
  SAY SELECT_ACTION6 ~~ [xzar28]
  SAY SELECT_ACTION7 ~~ [xzar29]
  SAY SELECT_RARE1 ~~ [xzar32]
  SAY SELECT_RARE2 ~~ [xzar33]
  SAY CRITICAL_HIT ~~ 
  SAY CRITICAL_MISS ~~ [xzar43]
  SAY TARGET_IMMUNE ~~ [xzar43]
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ [xzar44]
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ [xzar44]
  SAY REACT_TO_DIE_GENERAL ~~ [xzar39]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~ [xzar44]
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END

// Set the portrait for Xzar before joining to the group
ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN	
INCLUDE ~%MOD_FOLDER%/lib/standardEE.tph~		
	OUTER_SET s9total=0
	OUTER_SET rows_cnt_1=0
	COPY - ~%MOD_FOLDER%/portraits/XZAR.tbl~  ~%MOD_FOLDER%/portraits/XZAR.tbl~
		COUNT_2DA_ROWS 1 "rows_cnt_1"
			FOR( cntg=0; cntg<"%rows_cnt_1%"; cntg+=1 ) BEGIN
				READ_2DA_ENTRY cntg  0 2 "Crename"
				READ_2DA_ENTRY cntg  1 2 "Filename"
				INNER_ACTION BEGIN
					ACTION_IF FILE_EXISTS_IN_GAME ~%Crename%.cre~ THEN BEGIN
						OUTER_SET s9total+=1
						LAUNCH_ACTION_MACRO ~Addpic~ 
					END
				END
END
END
ELSE BEGIN
INCLUDE ~%MOD_FOLDER%/lib/standardold.tph~	
	OUTER_SET s9total=0
	OUTER_SET rows_cnt_1=0
	COPY - ~%MOD_FOLDER%/portraits/XZAR.tbl~  ~%MOD_FOLDER%/portraits/XZAR.tbl~
		COUNT_2DA_ROWS 1 "rows_cnt_1"
			FOR( cntg=0; cntg<"%rows_cnt_1%"; cntg+=1 ) BEGIN
				READ_2DA_ENTRY cntg  0 2 "Crename"
				READ_2DA_ENTRY cntg  1 2 "Filename"
				INNER_ACTION BEGIN
					ACTION_IF FILE_EXISTS_IN_GAME ~%Crename%.cre~ THEN BEGIN
						OUTER_SET s9total+=1
						LAUNCH_ACTION_MACRO ~Addpic~ 
					END
				END
END
END	

ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
COPY ~BG1NPCSoA/portraits/Xzar/EE-portraits/~ ~override~
END ELSE BEGIN
COPY ~BG1NPCSoA/portraits/Xzar/vanilla-portraits~ ~override~
END

ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
   // If a EE-version is installed, change the journal entries to adapt it 
  ADD_JOURNAL @1801 @1802 USING ~%MOD_FOLDER%/tra/%LANGUAGE%/setup.tra~ 
END 

LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Xzar-Montaron" oggdec_path = "BG1NPCSoA/sounds" END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~IMOEN!.wav~ BEGIN
LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Imoen" oggdec_path = "BG1NPCSoA/sounds" END
END

COPY ~BG1NPCSoA/cre/XZAR-QUEST/XQLICH.cre~ ~override/XQLICH.cre~
SAY NAME1 @1548
SAY NAME2 @1548

COPY ~BG1NPCSoA/cre/XZAR-QUEST/XQNYMPH.cre~ ~override/XQNYMPH.cre~
SAY NAME1 @1549
SAY NAME2 @1549

COPY ~BG1NPCSoA/cre/XZAR-QUEST/XQWITCH.cre~ ~override/XQWITCH.cre~
SAY NAME1 @1550
SAY NAME2 @1550

COPY ~BG1NPCSoA/cre/XZAR-QUEST/XQtroll.cre~ ~override/XQtroll.cre~
SAY NAME1 @1551
SAY NAME2 @1551

COPY ~BG1NPCSoA/cre/XZAR-QUEST/7XCRE79.cre~ ~override/7XCRE79.cre~
SAY NAME1 @1552
SAY NAME2 @1552

COPY ~BG1NPCSoA/cre/MONTARON-QUEST/MQFIRE1.cre~ ~override/MQFIRE1.cre~
SAY NAME1 @1553
SAY NAME2 @1553

COPY ~BG1NPCSoA/cre/XZAR-QUEST/XMMM1.cre~ ~override/XMMM1.cre~
SAY NAME1 @1554
SAY NAME2 @1554

COPY ~BG1NPCSoA/Items/PLATNUM.itm~ ~Override/PLATNUM.itm~
SAY NAME1 @303		
SAY NAME2 @303
SAY UNIDENTIFIED_DESC @303
SAY DESC @823

COPY ~BG1NPCSoA/Items/BG1NPC5.itm~ ~Override/BG1NPC5.itm~
SAY NAME1 @1555		
SAY NAME2 @1555
SAY UNIDENTIFIED_DESC @1555
SAY DESC @1556

COPY ~BG1NPCSoA/Items/BG1NPC4.itm~ ~Override/BG1NPC4.itm~
SAY NAME1 @1557		
SAY NAME2 @1557
SAY UNIDENTIFIED_DESC @1557
SAY DESC @1557

COPY ~BG1NPCSoA/Items/BG1NPC6.itm~ ~Override/BG1NPC6.itm~
SAY NAME1 @1558		
SAY NAME2 @1558
SAY UNIDENTIFIED_DESC @1558
SAY DESC @1559

COPY ~BG1NPCSoA/Items/BG1NPCA.itm~ ~Override/BG1NPCA.itm~
SAY NAME1 @1560		
SAY NAME2 @1560
SAY UNIDENTIFIED_DESC @1560
SAY DESC @1561


COPY ~BG1NPCSoA/Items/MISC5U.itm~ ~Override/MISC5U.itm~
SAY NAME1 @1562		
SAY NAME2 @1562
SAY UNIDENTIFIED_DESC @1562
SAY DESC @1563


COPY ~BG1NPCSoA/BAM~ ~override~

EXTEND_TOP ~AR0502.bcs~ ~BG1NPCSoA/scripts/XZAR-QUEST/AR0502.baf~
EXTEND_TOP ~AR0802.bcs~ ~BG1NPCSoA/scripts/XZAR-QUEST/AR0802.baf~
EXTEND_TOP ~AR0500.bcs~ ~BG1NPCSoA/scripts/XZAR-QUEST/AR0500.baf~
EXTEND_TOP ~AR1100.bcs~ ~BG1NPCSoA/scripts/XZAR-QUEST/AR1100.baf~
EXTEND_TOP ~AR1200.bcs~ ~BG1NPCSoA/scripts/XZAR-QUEST/AR1200.baf~
EXTEND_TOP ~AR1800.bcs~ ~BG1NPCSoA/scripts/XZAR-QUEST/AR1800.baf~

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XXZARJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XXZARJ-begin.d~
END

COMPILE ~BG1NPCSoA/dialogues/7XMONT.d~
COMPILE ~BG1NPCSoA/dialogues/7XMONTJ.d~ USING ~BG1NPCSoA\tra\%LANGUAGE%\7xmontb.tra~
COMPILE ~BG1NPCSoA/dialogues/7XMONTB.d~
COMPILE ~BG1NPCSoA/dialogues/7XXZAR.d~
COMPILE ~BG1NPCSoA/dialogues/7XXZARJ.d~ USING ~BG1NPCSoA\tra\%LANGUAGE%\7xxzarb.tra~
COMPILE ~BG1NPCSoA/dialogues/7XXZARB.d~
COMPILE ~BG1NPCSoA/dialogues/XZAR-QUEST/XMMM1.d~
COMPILE ~BG1NPCSoA/dialogues/XZAR-QUEST/XQLICH.d~
COMPILE ~BG1NPCSoA/dialogues/XZAR-QUEST/XQNYMPH.d~
COMPILE ~BG1NPCSoA/dialogues/XZAR-QUEST/XQWITCH.d~
COMPILE ~BG1NPCSoA/dialogues/XZAR-QUEST/7XMULA.d~
COMPILE ~BG1NPCSoA/dialogues/XZAR-QUEST/XQtroll.d~

COMPILE ~BG1NPCSoA/scripts/7XXzar.baf~

APPEND ~pdialog.2da~
~7XXZAR	7XXZARP	7XXZARJ	7XXZARD 7XXZA25P 7XXZA25J 7XXZA25D 7XXZA25~
UNLESS ~7XXZAR~
APPEND ~interdia.2da~
  ~7XXZAR 7XXZARB B7XXZA25~
  UNLESS ~7XXZAR~
  
  
 // Add Xzar-Faldorn Quest Interjection
ACTION_IF FILE_EXISTS_IN_GAME ~7XFALD.dlg~ BEGIN
OUTER_SET XzarFaldornInterjection1 = STATE_WHICH_SAYS 139 IN ~BG1NPCSoA\tra\%s\7Xfald.tra~ FROM ~CEFALDOR~
COMPILE EVALUATE_BUFFER ~BG1NPCSoA/crossbanter/ICT/ICT_xzar-faldorn.d~ USING ~BG1NPCSoA\tra\%LANGUAGE%\7xxzarb.tra~
END  

 // Add Montaron-Faldorn Quest Interjection
ACTION_IF FILE_EXISTS_IN_GAME ~7XFALD.dlg~ BEGIN
OUTER_SET MontaronFaldornInterjection1 = STATE_WHICH_SAYS 139 IN ~BG1NPCSoA\tra\%s\7Xfald.tra~ FROM ~CEFALDOR~
COMPILE EVALUATE_BUFFER ~BG1NPCSoA/crossbanter/ICT/ICT_montaron-faldorn.d~ USING ~BG1NPCSoA\tra\%LANGUAGE%\7xmontb.tra~
END  
  
  
// Xzar
ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE75.cre~ BEGIN
  COPY_EXISTING ~7XCRE75.cre~ ~override~
    WRITE_EVALUATED_ASCII SCRIPT_OVERRIDE ~7XXZAR~ #8
  BUT_ONLY_IF_IT_CHANGES  
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~override/bimoen2.dlg~ THEN BEGIN
  <<<<<<<< BG1NPCSoA/dialogues/MISC/BIMOEN2.d
  BEGIN BIMOEN2
  >>>>>>>>
  COMPILE ~BG1NPCSoA/dialogues/MISC/BIMOEN2.d~
END


//Giving Imoen a banter file if the Fixpack isn't installed

ACTION_IF NOT FILE_EXISTS_IN_GAME ~cdbehbla.pro~ //makes sure the fixpack isn't already installed
THEN BEGIN
ACTION_IF FILE_EXISTS_IN_GAME ~saradush.mve~ THEN BEGIN
  COPY_EXISTING ~interdia.2da~ ~override~
    SET_2DA_ENTRY 17 1 2 ~BIMOEN2~ // fixes ToB version
    BUT_ONLY_IF_IT_CHANGES
END ELSE BEGIN
  APPEND ~interdia.2da~ ~IMOEN       BIMOEN2~ // fixes SoA version
    UNLESS ~BIMOEN2~
END
END

COMPILE ~BG1NPCSoA/dialogues/Xzar-MontyTOB.d~

EXTEND_TOP ~AR6000.bcs~ ~%MOD_FOLDER%/scripts/MISC/AR6000Xzar.baf~

// Xzar's Epilogue
EXTEND_TOP ~AR6200.bcs~ ~BG1NPCSoA/epilogues/Xzar/AR6200.baf~
COPY ~BG1NPCSoA/epilogues/Xzar/XzarEp.2da~ ~override/XzarEp.2da~
REPLACE ~99999~ @8007

// Montaron's epilogues
EXTEND_TOP ~AR6200.bcs~ ~BG1NPCSoA/epilogues/Montaron/AR6200.baf~
COPY ~BG1NPCSoA/epilogues/Montaron/Mont1Ep.2da~ ~override/Mont1Ep.2da~
REPLACE ~99999~ @8005

COPY ~BG1NPCSoA/epilogues/Montaron/Mont2Ep.2da~ ~override/Mont2Ep.2da~
REPLACE ~99999~ @8006

// Add the ToB Montaron script
COMPILE ~%MOD_FOLDER%/scripts/7XMON25.baf~
EXTEND_TOP ~AR4000.bcs~ ~BG1NPCSoA/scripts/misc/AR4000Monty.baf~
EXTEND_TOP ~AR4500.bcs~ ~BG1NPCSoA/scripts/misc/AR4500Monty.baf~

// EET Fate Spirit Xzar-Monty

ACTION_IF (GAME_IS ~eet~) BEGIN
INCLUDE ~EET/other/EET_functions.tph~ // functions from EET mod

// remove duplication in the call dialog with the option of the original EET
<<<<<<<< XZAR_fix.baf
IF
	!Global("XzarSummoned","GLOBAL",2)
THEN
	RESPONSE #100
		SetGlobal("XzarSummoned","GLOBAL",2)
		Continue()
END
>>>>>>>>
EXTEND_BOTTOM ~AR4000.bcs~ ~XZAR_fix.baf~

//// Create and install a missing ToB-script file to avoid installation errors and not to use a script from the BG1&SOA
ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/7XXZAR.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/7XXZAR.baf~
END ELSE BEGIN
<<<<<<<<7XXZAR.baf
>>>>>>>>
	COMPILE ~7XXZAR.baf~
END

ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/7XXZA25.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/7XXZA25.baf~ END
ELSE BEGIN
<<<<<<<<7XXZA25.baf
>>>>>>>>
COMPILE ~7XXZA25.baf~
END

LAF ~EET_NPC_TRANSITION~
INT_VAR
type = 2 // NPC is summon-able if met before
default_ToB = 1
STR_VAR
dv = "7XXZAR" // death variable 
override_SoA = "7XXZAR" // override script (SoA)
override_ToB = "7XXZA25" // override script (ToB)
cre_ToB = "7XCRE75"
dialog_ToB = "7XXZAR" // joining dialogue for ToB
traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/Xzar-MontyTOB.tra"
string = "@5"
stringPosDV = "Yeslick"
END
OUTER_SPRINT ~tob_override~ ~7XXZA25~
OUTER_SPRINT ~tob_var~ ~XZAR1SummonedTOB~
EXTEND_TOP ~7XXZAR.bcs~ ~fix_tob_script.baf~ EVALUATE_BUFFER

// remove duplication in the call dialog with the option of the original EET
<<<<<<<< MONT_fix.baf
IF
	!Global("MontaronSummoned","GLOBAL",2)
THEN
	RESPONSE #100
		SetGlobal("MontaronSummoned","GLOBAL",2)
		Continue()
END
>>>>>>>>
EXTEND_BOTTOM ~AR4000.bcs~ ~MONT_fix.baf~

LAF ~EET_NPC_TRANSITION~
INT_VAR
type = 2 // NPC is summon-able if met before
default_ToB = 1
STR_VAR
dv = "7XMONT" // death variable 
override_SoA = "7XMONT" // override script (SoA)
override_ToB = "7XMON25" // override script (ToB)
cre_ToB = "7XCRE74"
dialog_ToB = "7XMONT" // joining dialogue for ToB
traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/Xzar-MontyTOB.tra"
string = "@4"
stringPosDV = "Nalia"
END
OUTER_SPRINT ~tob_override~ ~7XMON25~
OUTER_SPRINT ~tob_var~ ~MONTISummonedTOB~
END

/////////////////////////
// Tiax & Quayle
//////////////////////


BEGIN @1594 DESIGNATED 50
GROUP ~Main Mod~
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~
REQUIRE_PREDICATE (NOT FILE_EXISTS_IN_GAME ~1xQUAYB.dlg~) OR
                  (NOT FILE_EXISTS_IN_GAME ~O#Tiax.cre~) ~No content to install~

COPY_EXISTING ~sw1h01.itm~ ~override/7xbg1n.mrk~ // This file helps to determine if at least one component is installed - to disable the installation of the audio component and cross-banters if none of the main components is installed.

APPEND ~STATE.IDS~ ~0x80101FEF CD_STATE_NOTVALID~
UNLESS ~CD_STATE_NOTVALID~

ACTION_IF NOT FILE_EXISTS_IN_GAME ~1xQUAYB.dlg~ BEGIN
COPY ~BG1NPCSoA/Cre/7XCRE78.cre~ ~override/7XCRE78.cre~
SAY NAME1 @1595
SAY NAME2 @1595
SAY BIO @1596
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END

END ELSE BEGIN
  PRINT @1597
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~O#Tiax.cre~ BEGIN

COPY ~BG1NPCSoA/Cre/7XCRE77.cre~ ~override/7XCRE77.cre~
SAY NAME1 @1598
SAY NAME2 @1598
SAY BIO @1599
SAY INITIAL_MEETING ~~ [Tiaxs]
  SAY MORALE ~~ 
  SAY HAPPY @1601
  SAY UNHAPPY_ANNOYED @1602
  SAY UNHAPPY_SERIOUS @1603
SAY UNHAPPY_BREAKING @1604
  SAY LEADER ~~ [TiaxB]
  SAY TIRED @1606
  SAY BORED ~~ [Tiaxd]
  SAY BATTLE_CRY1 @1608
  SAY BATTLE_CRY2 ~~ [Tiax8]
  SAY BATTLE_CRY3 @1610
  SAY BATTLE_CRY4 ~~ [Tiax8]
  SAY BATTLE_CRY5 @1611
  SAY DAMAGE ~~ [TiaxL]
  SAY DYING @1613
  SAY HURT @1614
  SAY AREA_FOREST @1615 
  SAY AREA_CITY @1616 
  SAY AREA_DUNGEON @1617
  SAY AREA_DAY @1618 
  SAY AREA_NIGHT @1619
  SAY SELECT_COMMON1 @1620
  SAY SELECT_COMMON2 @1621
  SAY SELECT_COMMON3 ~~ [Tiaxt]
  SAY SELECT_COMMON4 ~~ [Tiaxg]
  SAY SELECT_COMMON5 ~~ [TiaxI]
  SAY SELECT_COMMON6 ~~ [Tiaxt]
  SAY SELECT_ACTION1 ~~ [TiaxJ]
  SAY SELECT_ACTION2 ~~ [Tiaxt]
  SAY SELECT_ACTION3 ~~ [Tiaxk]
  SAY SELECT_ACTION4  ~~ [Tiaxs]
  SAY SELECT_ACTION5 ~~ [Tiaxt]
  SAY SELECT_ACTION6 ~~ [TiaxI]
  SAY SELECT_ACTION7 @1627
  SAY SELECT_RARE1 @1628
  SAY SELECT_RARE2 @1629
  SAY CRITICAL_HIT ~~ 
  SAY CRITICAL_MISS ~~ [Tiax1]
  SAY TARGET_IMMUNE ~~ [Tiax1]
  SAY INVENTORY_FULL ~~ [Tiax6]
  SAY PICKED_POCKET ~~ [Tiax6]
  SAY HIDDEN_IN_SHADOWS ~~ [Tiax6]
  SAY SPELL_DISRUPTED ~~ [Tiax1]
  SAY SET_A_TRAP ~~ [Tiax6]
  SAY REACT_TO_DIE_GENERAL @1632 
  SAY INTERACTION3 ~~ [Tiax$]
  SAY COMPLIMENT1 ~~ [Tiax#]
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END

ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
COPY ~BG1NPCSoA/portraits/Tiax/EE-portraits/TIAXL.BMP~ ~override/TIAXL.BMP~
COPY ~BG1NPCSoA/portraits/Tiax/EE-portraits/TIAXS.BMP~ ~override/TIAXS.BMP~
COPY ~BG1NPCSoA/portraits/Tiax/EE-portraits/TIAXM.BMP~ ~override/TIAXM.BMP~
END ELSE BEGIN
COPY ~BG1NPCSoA/portraits/Tiax/Vanilla-portraits/TIAXL.BMP~ ~override/TIAXL.BMP~
COPY ~BG1NPCSoA/portraits/Tiax/Vanilla-portraits/TIAXM.BMP~ ~override/TIAXS.BMP~
COPY ~BG1NPCSoA/portraits/Tiax/Vanilla-portraits/TIAXS.BMP~ ~override/TIAXS.BMP~
END

END ELSE BEGIN
  PRINT @1635
END

// Add Wilson dialog

ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN

<<<<<<<< wilson_dialog.d
BEGIN %wilson_dialog%
>>>>>>>>
ACTION_IF NOT FILE_EXISTS_IN_GAME ~BWILSON.dlg~ BEGIN
	OUTER_SPRINT ~wilson_dialog~ ~BWILSON~
	COMPILE ~wilson_dialog.d~ EVALUATE_BUFFER
END

APPEND ~interdia.2da~ ~WILSON BWILSON BWILSO25~
               UNLESS ~WILSON~

COPY_EXISTING ~pdialog.2da~ ~override~
  REPLACE_TEXTUALLY ~^[ %TAB%]*WILSON[ %TAB%].+$~
                    ~WILSON                 WILSONP                WILSONJ                WILSOND                WILSO25P               WILSO25J               WILSO25D               WILSON25~
BUT_ONLY

END

ACTION_IF (GAME_IS ~bg2ee eet~) BEGIN
   // If a EE-version is installed, change the journal entries to adapt it 
  ADD_JOURNAL @1799 @1800 @1803 @1805 @1806 USING ~%MOD_FOLDER%/tra/%LANGUAGE%/setup.tra~ 
END 

COPY ~BG1NPCSoA/cre/TIAX-QUAYLE/TQCRE2.cre~ ~override/TQCRE2.cre~
SAY NAME1 @1638
SAY NAME2 @1638

COPY ~BG1NPCSoA/cre/TIAX-QUAYLE/TQCRE3.cre~ ~override/TQCRE3.cre~
SAY NAME1 @1639
SAY NAME2 @1639


COPY ~BG1NPCSoA/cre/TIAX-QUAYLE/bg1x18.cre~ ~override/bg1x18.cre~
SAY NAME1 @1640
SAY NAME2 @1640


COPY ~BG1NPCSoA/Items/BGSX09.itm~ ~Override/BGSX09.itm~
SAY NAME1 @1641
SAY NAME2 @1642
SAY UNIDENTIFIED_DESC @1641
SAY DESC @1643


COPY ~BG1NPCSoA/Items/BGSX10.itm~ ~Override/BGSX10.itm~
SAY NAME1 @1644
SAY NAME2 @1644
SAY UNIDENTIFIED_DESC @1644
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1645" END

COPY ~BG1NPCSoA/Items/BGSX11.itm~ ~Override/BGSX11.itm~
SAY NAME1 @1646
SAY NAME2 @1647
SAY UNIDENTIFIED_DESC @1646
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1648" END


COPY ~BG1NPCSoA/Items/BGSX12.itm~ ~Override/BGSX12.itm~
SAY NAME1 @1649
SAY NAME2 @1649
SAY UNIDENTIFIED_DESC @1649
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1650" END

COPY ~BG1NPCSoA/Items/BGSX13.itm~ ~Override/BGSX13.itm~
SAY NAME1 @414
SAY NAME2 @1651
SAY UNIDENTIFIED_DESC @414
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@1652" END

COPY ~BG1NPCSoA/Items/BGSX14.itm~ ~Override/BGSX14.itm~
SAY NAME1 @1653
SAY NAME2 @1654
SAY UNIDENTIFIED_DESC @1653
SAY DESC @1655

COPY ~BG1NPCSoA/Items/BGSX15.itm~ ~Override/BGSX15.itm~
SAY NAME1 @1656
SAY NAME2 @1656
SAY UNIDENTIFIED_DESC @1656
SAY DESC @1657


COPY ~BG1NPCSoA/Items/PLATNUM.itm~ ~Override/PLATNUM.itm~
SAY NAME1 @303		
SAY NAME2 @303
SAY UNIDENTIFIED_DESC @303
SAY DESC @823

COPY ~BG1NPCSoA/Items/DEPO135.itm~ ~Override/DEPO135.itm~
SAY NAME1 @411
SAY NAME2 @412
SAY UNIDENTIFIED_DESC @412
SAY DESC @413

COPY ~BG1NPCSoA/Items/DEPO189.itm~ ~Override/DEPO189.itm~
SAY NAME1 @366
SAY NAME2 @409
SAY UNIDENTIFIED_DESC @366
SAY DESC @410

COPY ~BG1NPCSoA/Items/DEPO211.itm~ ~Override/DEPO211.itm~
SAY NAME1 @242
SAY NAME2 @407
SAY UNIDENTIFIED_DESC @242
SAY DESC @408


COPY ~BG1NPCSoA/Items/DEPO212.itm~ ~Override/DEPO212.itm~
SAY NAME1 @414
SAY NAME2 @415
SAY UNIDENTIFIED_DESC @414
SAY DESC @416


COPY ~BG1NPCSoA/cre/Coran-Safana-Chronicles/7XCRE44.cre~ ~override/7XCRE44.cre~
SAY NAME1 @352
SAY NAME2 @352

COPY ~BG1NPCSoA/Items/bg1x23b.itm~ ~Override/bg1x23b.itm~
SAY NAME1 @353
SAY NAME2 @353
SAY UNIDENTIFIED_DESC @353
SAY DESC @353

COPY ~BG1NPCSoA/cre/Coran-Safana-Chronicles/7XCRE45.cre~ ~override/7XCRE45.cre~
SAY NAME1 @354
SAY NAME2 @354
SAY INITIAL_MEETING ~~ [BASIL01]
  SAY MORALE ~~ [BASIL01]
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ [BASIL01]
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ 
  SAY TIRED ~~ [BASIL01]
  SAY BORED ~~ [BASIL01]
  SAY BATTLE_CRY1 ~~ [BASIL02]
  SAY BATTLE_CRY2 ~~ [BASIL01]
  SAY BATTLE_CRY3 ~~ [BASIL03]
  SAY BATTLE_CRY4 ~~ [BASIL02]
  SAY BATTLE_CRY5 ~~ [BASIL03]
  SAY DAMAGE ~~ [BASIL08]
  SAY DYING ~~ [BASIL10]
  SAY HURT ~~ [BASIL09]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [BASIL03]
  SAY SELECT_COMMON2 ~~ [BASIL01]
  SAY SELECT_COMMON3 ~~ [BASIL01]
  SAY SELECT_COMMON4 ~~ [BASIL01]
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ 
  SAY SELECT_ACTION2 ~~ 
  SAY SELECT_ACTION3 ~~ 
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ [BASIL01]
  SAY SELECT_RARE2 ~~ [BASIL01]
  SAY CRITICAL_HIT ~~ [BASIL03]
SAY CRITICAL_MISS ~~ [BASIL02]
SAY TARGET_IMMUNE ~~ [BASIL08]
SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [BASIL03]
  SAY INTERACTION3 ~~ [BASIL08]
  SAY COMPLIMENT1 ~~ [BASIL08]


COPY ~BG1NPCSoA/cre/MISC/7Xcre51.cre~ ~override/7Xcre51.cre~
SAY NAME1 @393
SAY NAME2 @393

COPY ~BG1NPCSoA/Items/DEPO199.itm~ ~Override/DEPO199.itm~
SAY NAME1 @1242
SAY NAME2 @1243
SAY UNIDENTIFIED_DESC @1242
SAY DESC @1243

COPY ~BG1NPCSoA/cre/MISC/7Xcre88.cre~ ~override/7Xcre88.cre~
SAY NAME1 @1658
SAY NAME2 @1658

COPY ~BG1NPCSoA/Items/IGITM.ITM~ ~Override/IGITM.ITM~
SAY NAME1 @1659
SAY NAME2 @1659
SAY UNIDENTIFIED_DESC @1659
SAY DESC @1659

COPY ~BG1NPCSoA/Items/IGITM2.ITM~ ~Override/IGITM2.ITM~
SAY NAME1 @1660
SAY NAME2 @1660
SAY UNIDENTIFIED_DESC @1660
SAY DESC @1660

COPY ~BG1NPCSoA/Items/IGITM3.ITM~ ~Override/IGITM3.ITM~
SAY NAME1 @1661
SAY NAME2 @1661
SAY UNIDENTIFIED_DESC @1661
SAY DESC @1661

COPY ~BG1NPCSoA/Items/IGITM4.ITM~ ~Override/IGITM4.ITM~
SAY NAME1 @1662
SAY NAME2 @1662
SAY UNIDENTIFIED_DESC @1662
SAY DESC @1662

COPY ~BG1NPCSoA/cre/MISC/7Xcre94.cre~ ~override/7Xcre94.cre~
SAY NAME1 @1663
SAY NAME2 @1663


COPY ~BG1NPCSoA/Items/DEPO284.itm~ ~Override/DEPO284.itm~
SAY NAME1 @429
SAY NAME2 @429
SAY UNIDENTIFIED_DESC @429
SAY DESC @429

COPY ~BG1NPCSoA/Spells/squirrel.SPL~ ~Override/squirrel.SPL~
SAY NAME1 @429
 SAY UNIDENTIFIED_DESC @430

COPY ~BG1NPCSoA/Spells/SPIN884.SPL~ ~Override/SPIN884.SPL~
SAY NAME1  @565
 SAY UNIDENTIFIED_DESC @565

COPY ~BG1NPCSoA/Items/BGSX21.itm~ ~Override/BGSX21.itm~
SAY NAME1 @431
SAY NAME2 @431
SAY UNIDENTIFIED_DESC @431
SAY DESC @432

COPY ~BG1NPCSoA/Spells/calguar.SPL~ ~Override/calguar.SPL~
SAY NAME1  @431
 SAY UNIDENTIFIED_DESC @432

COPY ~BG1NPCSoA/Items/MISCA4.itm~ ~Override/MISCA4.itm~
SAY NAME1 @1671
SAY NAME2 @1671
SAY UNIDENTIFIED_DESC @1671
SAY DESC @1672

COPY ~BG1NPCSoA/cre/TIAX-QUAYLE/7xOSWALD.cre~ ~override/7xOSWALD.cre~
SAY NAME1 @1673
SAY NAME2 @1673

COPY ~BG1NPCSoA/store/7xOSWALD.sto~ ~override~
SAY NAME2 @1674

COPY ~BG1NPCSoA/cre/TIAX-QUAYLE/MARALIE.cre~ ~override/MARALIE.cre~
SAY NAME1 @1675
SAY NAME2 @1675

COPY ~BG1NPCSoA/cre/TIAX-QUAYLE/7XGAZIB.cre~ ~override/7XGAZIB.cre~
SAY NAME1 @1676
SAY NAME2 @1676

COPY ~BG1NPCSoA/cre/TIAX-QUAYLE/7XOOPAH.cre~ ~override/7XOOPAH.cre~
SAY NAME1 @1677
SAY NAME2 @1677

COPY ~BG1NPCSoA/Items/DEPO45.itm~ ~Override/DEPO45.itm~
SAY NAME1 @248
SAY NAME2 @248
SAY UNIDENTIFIED_DESC @248
SAY DESC @249

APPEND ~pdialog.2da~
~7XTIAX	7XTIAXP	7XTIAXJ	7XTIAXD 7XTIA25P 7XTIA25J 7XTIA25D 7XTIAX25~
UNLESS ~7XTIAX~
APPEND ~interdia.2da~
  ~7XTIAX    7XTIAXB B7XTIA25~
  UNLESS ~7XTIAX~

APPEND ~pdialog.2da~
~7XQUAY	7XQUAYP	7XQUAYJ	7XQUAYD 7XQUA25p 7XQUA25J 7XQUA25D 7XQUAY25~
UNLESS ~7XQUAY~
APPEND ~interdia.2da~
  ~7XQUAY     7XQUAYB   B7XQUA25~
  UNLESS ~7XQUAY~

COMPILE ~BG1NPCSoA/dialogues/7XTIAXB.d~

ACTION_IF FILE_EXISTS_IN_GAME ~7XTIAXJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XTIAXJ.d~ EVALUATE_BUFFER
END ELSE BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XTIAXJ-Begin.d~
COMPILE ~BG1NPCSoA/dialogues/7XTIAXJ.d~ EVALUATE_BUFFER
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~7XQUAYJ.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XQUAYJ-begin.d~
END

COMPILE ~BG1NPCSoA/dialogues/7XTIAX.d~
COMPILE ~BG1NPCSoA/dialogues/7XQUAYB.d~
COMPILE ~BG1NPCSoA/dialogues/7XQUAYP.d~

ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE78.cre~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/7XQUAYP(add).d~ USING ~BG1NPCSoA/tra/%LANGUAGE%/7xtiaxj.tra~ // If Quayle is installed from this mod, and not from Lava (otherwise there would be a file conflict in the game)
END

EXTEND_TOP ~AR1700.bcs~ ~BG1NPCSoA/scripts/TIAX-QUAYLE/AR1700.baf~
EXTEND_TOP ~AR0700.bcs~ ~BG1NPCSoA/scripts/AR0700.baf~
EXTEND_TOP ~AR0607.bcs~ ~BG1NPCSoA/scripts/TIAX-QUAYLE/AR0607.baf~
COMPILE ~BG1NPCSoA/dialogues/TIAX-QUAYLE/TQCRE1.d~
COMPILE ~BG1NPCSoA/dialogues/TIAX-QUAYLE/OSWALD.d~
COMPILE ~BG1NPCSoA/dialogues/TIAX-QUAYLE/BG1X25.d~
EXTEND_TOP ~AR0400.bcs~ ~BG1NPCSoA/scripts/TIAX-QUAYLE/AR0400.baf~
EXTEND_TOP ~AR0402.bcs~ ~BG1NPCSoA/scripts/TIAX-QUAYLE/AR0402.baf~
EXTEND_TOP ~AR4500.bcs~ ~BG1NPCSoA/scripts/TIAX-QUAYLE/AR4500.baf~

ACTION_IF FILE_EXISTS_IN_GAME ~BG1X19.dlg~ BEGIN
COMPILE ~BG1NPCSoA/dialogues/TIAX-QUAYLE/MARALIE-platinum.d~ USING ~BG1NPCSoA/tra/%LANGUAGE%/maralie.tra~
END ELSE BEGIN
COMPILE ~BG1NPCSoA/dialogues/TIAX-QUAYLE/MARALIE-gold.d~ USING ~BG1NPCSoA/tra/%LANGUAGE%/maralie.tra~
END


COMPILE ~BG1NPCSoA/scripts/7xquay.BAF~
COMPILE ~BG1NPCSoA/scripts/7xtiax.BAF~
COMPILE ~BG1NPCSoA/scripts/TIAX-QUAYLE/AR01TZ.BAF~ 
COMPILE ~BG1NPCSoA/scripts/TIAX-QUAYLE/AR01TQ.BAF~ 
COMPILE ~BG1NPCSoA/scripts/TIAX-QUAYLE/7xtradmt.BAF~ 
COMPILE ~BG1NPCSoA/scripts/TIAX-QUAYLE/7xumarh.BAF~ 

LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Tiax-Quayle" oggdec_path = "BG1NPCSoA/sounds" END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~IMOEN!.wav~ BEGIN
LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Imoen" oggdec_path = "BG1NPCSoA/sounds" END
END

// Add Tiax-Safana Interjection (since the Tiax component is installed later than the Safana component, we cannot immediately include his line in her dialogue and do it later)
ACTION_IF FILE_EXISTS_IN_GAME ~7XSafa.dlg~ BEGIN
OUTER_SET TiaxSafanaInterjection1 = STATE_WHICH_SAYS 182 IN ~BG1NPCSoA\tra\%s\7XSafaJ.tra~ FROM ~7XSafaJ~
COMPILE EVALUATE_BUFFER ~BG1NPCSoA/crossbanter/ICT/ICT_tiax-safana.d~ USING ~BG1NPCSoA\tra\%LANGUAGE%\7xtiaxj.tra~
END 

// Add Tiax-Faldorn Quest Interjection
ACTION_IF FILE_EXISTS_IN_GAME ~7XFALD.dlg~ BEGIN
OUTER_SET TiaxFaldornInterjection1 = STATE_WHICH_SAYS 139 IN ~BG1NPCSoA\tra\%s\7Xfald.tra~ FROM ~CEFALDOR~
COMPILE EVALUATE_BUFFER ~BG1NPCSoA/crossbanter/ICT/ICT_tiax-faldorn.d~ USING ~BG1NPCSoA\tra\%LANGUAGE%\7xtiaxj.tra~
END 

// Add Tiax Interjection in Dalindra's dialog
ACTION_IF FILE_EXISTS_IN_GAME ~KGSTO2.dlg~ BEGIN
OUTER_SET TiaxDalindraInterjection1 = STATE_WHICH_SAYS 2 IN ~BG1NPCSoA\tra\%s\KGSTO2.tra~ FROM ~KGSTO2~
COMPILE EVALUATE_BUFFER ~BG1NPCSoA/crossbanter/Water Gardens comments/GARDENS-tiax1.d~ USING ~BG1NPCSoA\tra\%LANGUAGE%\7xtiaxj.tra~
END 

// Add Quayle-Faldorn Quest Interjection
ACTION_IF FILE_EXISTS_IN_GAME ~7XFALD.dlg~ BEGIN
OUTER_SET QuayleFaldornInterjection1 = STATE_WHICH_SAYS 139 IN ~BG1NPCSoA\tra\%s\7Xfald.tra~ FROM ~CEFALDOR~
COMPILE EVALUATE_BUFFER ~BG1NPCSoA/crossbanter/ICT/ICT_quayle-faldorn.d~ USING ~BG1NPCSoA\tra\%LANGUAGE%\7xquayb.tra~
END 

ACTION_IF GAME_IS "bg2ee eet" BEGIN
  COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/EE-tis~ ~override~ // Copy TIS files for EE version
END ELSE BEGIN  
COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/Vanilla-tis~ ~override~ // Copy TIS files for vanilla version  
COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/mos/AR01TQ.MOS~ ~override~
COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/mos/AR00TQ.MOS~ ~override~
END

COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/AR01TQ.are~ ~override~
COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/AR01TQHT.bmp~ ~override~
COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/AR01TQLM.bmp~ ~override~
COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/AR01TQSR.bmp~ ~override~
COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/AR01TQ.wed~ ~override~
COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/AR01TQ.slh~ ~override~

COPY ~BG1NPCSoA/BAM~ ~override~


// Tiax
ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE77.cre~ BEGIN
  COPY_EXISTING ~7XCRE77.cre~ ~override~
    WRITE_EVALUATED_ASCII SCRIPT_OVERRIDE ~7XTIAX~ #8
  BUT_ONLY_IF_IT_CHANGES
END

// Quayle
ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE78.cre~ BEGIN
  COPY_EXISTING ~7XCRE78.cre~ ~override~
    WRITE_EVALUATED_ASCII SCRIPT_OVERRIDE ~7XQUAY~ #8
  BUT_ONLY_IF_IT_CHANGES
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~override/bimoen2.dlg~ THEN BEGIN
  <<<<<<<< BG1NPCSoA/dialogues/MISC/BIMOEN2.d
  BEGIN BIMOEN2
  >>>>>>>>
  COMPILE ~BG1NPCSoA/dialogues/MISC/BIMOEN2.d~
END


//Giving Imoen a banter file if the Fixpack isn't installed

ACTION_IF NOT FILE_EXISTS_IN_GAME ~cdbehbla.pro~ //makes sure the fixpack isn't already installed
THEN BEGIN
ACTION_IF FILE_EXISTS_IN_GAME ~saradush.mve~ THEN BEGIN
  COPY_EXISTING ~interdia.2da~ ~override~
    SET_2DA_ENTRY 17 1 2 ~BIMOEN2~ // fixes ToB version
    BUT_ONLY_IF_IT_CHANGES
END ELSE BEGIN
  APPEND ~interdia.2da~ ~IMOEN       BIMOEN2~ // fixes SoA version
    UNLESS ~BIMOEN2~
END
END

COMPILE ~BG1NPCSoA/dialogues/Tiax-QuayleTOB.d~ EVALUATE_BUFFER

// Tiax's Epilogue
ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE77.cre~ BEGIN
EXTEND_TOP ~AR6200.bcs~ ~BG1NPCSoA/epilogues/Tiax/AR6200.baf~

COPY ~BG1NPCSoA/epilogues/Tiax/TiaxEp.2da~ ~override/TiaxEp.2da~
REPLACE ~99999~ @8000
END

// Quayle's Epilogue
ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE78.cre~ BEGIN
EXTEND_TOP ~AR6200.bcs~ ~BG1NPCSoA/epilogues/Quayle/AR6200.baf~

COPY ~BG1NPCSoA/epilogues/Quayle/QuaEp.2da~ ~override/QuaEp.2da~
REPLACE ~99999~ @8001
END

// Add the ToB Tiax script
COMPILE ~%MOD_FOLDER%/scripts/7XTIAX25.baf~
EXTEND_TOP ~AR4000.bcs~ ~BG1NPCSoA/scripts/misc/AR4000Tiax.baf~
EXTEND_TOP ~AR4500.bcs~ ~BG1NPCSoA/scripts/misc/AR4500Tiax.baf~

// Add the ToB Quayle script
COMPILE ~%MOD_FOLDER%/scripts/7XQUAY25.baf~
EXTEND_TOP ~AR4000.bcs~ ~BG1NPCSoA/scripts/misc/AR4000Quayle.baf~
EXTEND_TOP ~AR4500.bcs~ ~BG1NPCSoA/scripts/misc/AR4500Quayle.baf~

// EET Fate Spirit TIAX-QUAYLE

ACTION_IF (GAME_IS ~eet~) BEGIN
INCLUDE ~EET/other/EET_functions.tph~ // functions from EET mod

// remove duplication in the call dialog with the option of the original EET
<<<<<<<< TIAX_fix.baf
IF
	!Global("TiaxSummoned","GLOBAL",2)
THEN
	RESPONSE #100
		SetGlobal("TiaxSummoned","GLOBAL",2)
		Continue()
END
>>>>>>>>
EXTEND_BOTTOM ~AR4000.bcs~ ~TIAX_fix.baf~

LAF ~EET_NPC_TRANSITION~
INT_VAR
type = 2 // NPC is summon-able if met before
default_ToB = 1
STR_VAR
dv = "7XTIAX" // death variable 
override_SoA = "7XTIAX" // override script (SoA)
override_ToB = "7XTIAX25" // override script (ToB)
cre_ToB = "7XCRE77"
dialog_ToB = "7XTIAX" // joining dialogue for ToB
traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/Tiax-QuayleTOB.tra"
string = "@12"
stringPosDV = "Valygar"
END
OUTER_SPRINT ~tob_override~ ~7XTIAX25~
OUTER_SPRINT ~tob_var~ ~Tiax1SummonedTOB~

// remove duplication in the call dialog with the option of the original EET
<<<<<<<< Quayle_fix.baf
IF
	!Global("QuayleSummoned","GLOBAL",2)
THEN
	RESPONSE #100
		SetGlobal("QuayleSummoned","GLOBAL",2)
		Continue()
END
>>>>>>>>
EXTEND_BOTTOM ~AR4000.bcs~ ~Quayle_fix.baf~

LAF ~EET_NPC_TRANSITION~
INT_VAR
type = 2 // NPC is summon-able if met before
default_ToB = 1
STR_VAR
dv = "7XQUAY" // death variable 
override_SoA = "7XQUAY" // override script (SoA)
override_ToB = "7XQUAY25" // override script (ToB)
cre_ToB = "7XCRE78"
dialog_ToB = "7XQUAY" // joining dialogue for ToB
traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/Tiax-QuayleTOB.tra"
string = "@11"
stringPosDV = "Rasaad"
END
OUTER_SPRINT ~tob_override~ ~7XQUAY25~
OUTER_SPRINT ~tob_var~ ~QuayleSummonedTOB~
END



// Optional component 
// Variant 1
BEGIN @2000 DESIGNATED 55
GROUP ~Main Mod~
REQUIRE_COMPONENT ~BG1NPCSoA.tp2~ ~50~ @2001
SUBCOMPONENT @1999

COMPILE ~BG1NPCSoA/dialogues/TIAX-QUAYLE/Alternate/TQCRE3.d~
COMPILE ~BG1NPCSoA/dialogues/TIAX-QUAYLE/KSLAVE02.d~
COMPILE ~BG1NPCSoA/dialogues/TIAX-QUAYLE/kgenie2.d~

COMPILE ~BG1NPCSoA/scripts/TIAX-QUAYLE/AR00TQ.BAF~
COMPILE ~BG1NPCSoA/scripts/TIAX-QUAYLE/KALAH1.BAF~
COMPILE ~BG1NPCSoA/scripts/TIAX-QUAYLE/KALAH2.BAF~ 

COPY ~BG1NPCSoA/scripts/TIAX-QUAYLE/ICELORD.bcs~ ~override/ICELORD.bcs~

COPY ~BG1NPCSoA/Items/tqkey1.itm~ ~Override/tqkey1.itm~
SAY NAME1 @1664
SAY NAME2 @1665
SAY UNIDENTIFIED_DESC @1665
SAY DESC @1666

COPY ~BG1NPCSoA/Items/tqkey2.itm~ ~Override/tqkey2.itm~
SAY NAME1 @1664
SAY NAME2 @1667
SAY UNIDENTIFIED_DESC @1667
SAY DESC @1668

COPY ~BG1NPCSoA/Items/tqkey3.itm~ ~Override/tqkey3.itm~
SAY NAME1 @1664
SAY NAME2 @1669
SAY UNIDENTIFIED_DESC @1669
SAY DESC @1670

COPY ~BG1NPCSoA/cre/TIAX-QUAYLE/Alternate/TQCRE1.cre~ ~override/TQCRE1.cre~
SAY NAME1 @1637
SAY NAME2 @1637

COPY ~BG1NPCSoA/cre/TIAX-QUAYLE/KSLAVE02.cre~ ~override/KSLAVE02.cre~
SAY NAME1 @1636
SAY NAME2 @1636

COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/Alternate/ar00tq.are~ ~override/ar00tq.are~
COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/AR00TQHT.bmp~ ~override~
COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/AR00TQLM.bmp~ ~override~
COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/AR00TQSR.bmp~ ~override~
COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/AR00TQ.wed~ ~override~
COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/AR00TQ.slh~ ~override~

// Variant 2
BEGIN @2003 DESIGNATED 56
GROUP ~Main Mod~
REQUIRE_COMPONENT ~BG1NPCSoA.tp2~ ~50~ @2001
SUBCOMPONENT @1999

COMPILE ~BG1NPCSoA/dialogues/TIAX-QUAYLE/TQCRE3.d~
COMPILE ~BG1NPCSoA/dialogues/TIAX-QUAYLE/KSLAVE02.d~
COMPILE ~BG1NPCSoA/dialogues/TIAX-QUAYLE/kgenie2.d~

COMPILE ~BG1NPCSoA/scripts/TIAX-QUAYLE/AR00TQ.BAF~
COMPILE ~BG1NPCSoA/scripts/TIAX-QUAYLE/KALAH1.BAF~
COMPILE ~BG1NPCSoA/scripts/TIAX-QUAYLE/KALAH2.BAF~ 

COPY ~BG1NPCSoA/scripts/TIAX-QUAYLE/ICELORD.bcs~ ~override/ICELORD.bcs~

COPY ~BG1NPCSoA/Items/tqkey1.itm~ ~Override/tqkey1.itm~
SAY NAME1 @1664
SAY NAME2 @1665
SAY UNIDENTIFIED_DESC @1665
SAY DESC @1666

COPY ~BG1NPCSoA/Items/tqkey2.itm~ ~Override/tqkey2.itm~
SAY NAME1 @1664
SAY NAME2 @1667
SAY UNIDENTIFIED_DESC @1667
SAY DESC @1668

COPY ~BG1NPCSoA/Items/tqkey3.itm~ ~Override/tqkey3.itm~
SAY NAME1 @1664
SAY NAME2 @1669
SAY UNIDENTIFIED_DESC @1669
SAY DESC @1670

COPY ~BG1NPCSoA/cre/TIAX-QUAYLE/TQCRE1.cre~ ~override/TQCRE1.cre~
SAY NAME1 @1637
SAY NAME2 @1637

COPY ~BG1NPCSoA/cre/TIAX-QUAYLE/KSLAVE02.cre~ ~override/KSLAVE02.cre~
SAY NAME1 @1636
SAY NAME2 @1636

COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/ar00tq.are~ ~override/ar00tq.are~
COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/AR00TQHT.bmp~ ~override~
COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/AR00TQLM.bmp~ ~override~
COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/AR00TQSR.bmp~ ~override~
COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/AR00TQ.wed~ ~override~
COPY ~BG1NPCSoA/areas/TIAX-QUAYLE/AR00TQ.slh~ ~override~

////////////////////////////////////
// Ajantis
/////////////////////////////////////

BEGIN @745 DESIGNATED 60
GROUP ~Main Mod~
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~
REQUIRE_PREDICATE ((NOT FILE_EXISTS_IN_GAME ~c#ajan08.cre~) AND
                   (NOT FILE_EXISTS_IN_GAME ~c#ajan09.cre~) AND
                   (NOT FILE_EXISTS_IN_GAME ~c#ajan10.cre~) AND
                   (NOT FILE_EXISTS_IN_GAME ~c#ajan12.cre~) AND
                   (NOT FILE_EXISTS_IN_GAME ~c#ajan14.cre~) AND 
                   (NOT FILE_EXISTS_IN_GAME ~c#ajan16.cre~) AND
                   (NOT FILE_EXISTS_IN_GAME ~ajantis.cre~)) @795

COPY_EXISTING ~sw1h01.itm~ ~override/7xbg1n.mrk~ // This file helps to determine if at least one component is installed - to disable the installation of the audio component and cross-banters if none of the main components is installed.

APPEND ~STATE.IDS~ ~0x80101FEF CD_STATE_NOTVALID~
UNLESS ~CD_STATE_NOTVALID~


COPY ~BG1NPCSoA/Cre/7XCRE70.cre~ ~override/7XCRE70.cre~
SAY NAME1 @7450
SAY NAME2 @746
SAY BIO @747
SAY INITIAL_MEETING ~~ 
  SAY MORALE ~~ 
  SAY HAPPY @748 
  SAY UNHAPPY_ANNOYED @749 
  SAY UNHAPPY_SERIOUS @750 
  SAY UNHAPPY_BREAKING @751
  SAY LEADER @752
  SAY TIRED ~~ [ajantisc]
  SAY BORED ~~ [ajantisd]
  SAY BATTLE_CRY1 @755
  SAY BATTLE_CRY2 @756
  SAY BATTLE_CRY3 ~~ [ajantis9] 
  SAY BATTLE_CRY4 ~~ [ajantisa]
  SAY BATTLE_CRY5 @759
  SAY DAMAGE ~~ [ajantisl]
  SAY DYING @761
  SAY HURT ~~ [ajantise]  
  SAY AREA_FOREST @763
  SAY AREA_CITY @764
  SAY AREA_DUNGEON @765
  SAY AREA_DAY ~~ [ajantisq]
  SAY AREA_NIGHT ~~ [ajantisr] 
  SAY SELECT_COMMON1  @768
  SAY SELECT_COMMON2 @769
  SAY SELECT_COMMON3 @770
  SAY SELECT_COMMON4 @771
  SAY SELECT_COMMON5 ~~ [ajantis0] 
  SAY SELECT_COMMON6 ~~ [ajantisf]
  SAY SELECT_ACTION1 @774 
  SAY SELECT_ACTION2 ~~ [ajantisj] 
  SAY SELECT_ACTION3 @776 
  SAY SELECT_ACTION4  ~~ [ajantisj]
  SAY SELECT_ACTION5 ~~ [ajantist]
  SAY SELECT_ACTION6 ~~ [ajantisu] 
  SAY SELECT_ACTION7 ~~ [ajantisv]
  SAY SELECT_RARE1 ~~ [ajantisx]
  SAY SELECT_RARE2 ~~ [Ajantisy]
  SAY CRITICAL_HIT ~~ [ajantisz]
  SAY CRITICAL_MISS ~~ [ajantis1]
  SAY TARGET_IMMUNE ~~ [ajantis2]
  SAY INVENTORY_FULL ~~ [ajantis3]
  SAY PICKED_POCKET ~~ [ajantis4]
  SAY HIDDEN_IN_SHADOWS ~~ [ajantis5] 
  SAY SPELL_DISRUPTED ~~ [ajantis6]
  SAY SET_A_TRAP ~~ [ajantis7]
 SAY REACT_TO_DIE_GENERAL @790 
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~ 
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END

LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Ajantis" oggdec_path = "BG1NPCSoA/sounds" END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~IMOEN!.wav~ BEGIN
LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Imoen" oggdec_path = "BG1NPCSoA/sounds" END
END

COPY ~BG1NPCSoA/Items/bgnpc1.itm~ ~Override/bgnpc1.itm~
SAY NAME1 @791
SAY NAME2 @791
SAY UNIDENTIFIED_DESC @791
SAY DESC @791

COPY ~BG1NPCSoA/Items/bg1AJA.itm~ ~Override/bg1AJA.itm~
SAY NAME1 @792
SAY NAME2 @793
SAY UNIDENTIFIED_DESC @792
LPF ~GW_WRITE_EE_ITM_DESCRIPTIONS~ STR_VAR GW_desc_to_update = "@794" END


EXTEND_TOP ~AR1202.bcs~ ~BG1NPCSoA/scripts/Ajantis/AR1202.baf~
EXTEND_TOP ~AR4000.bcs~ ~BG1NPCSoA/scripts/Ajantis/AR4000Ajan.baf~
EXTEND_TOP ~AR4500.bcs~ ~BG1NPCSoA/scripts/Ajantis/AR4500Ajan.baf~
COMPILE ~BG1NPCSoA/scripts/Ajantis/7XAjan.baf~ EVALUATE_BUFFER
COMPILE ~BG1NPCSoA/scripts/Ajantis/7XAjan25.baf~ EVALUATE_BUFFER

COPY ~BG1NPCSoA/BAM/BG1NPC1.bam~ ~override/BG1NPC1.bam~

COMPILE ~BG1NPCSoA/dialogues/7XAJAN.d~ 
COMPILE ~BG1NPCSoA/dialogues/AjantisTOB.d~


APPEND ~pdialog.2da~
~7XAJAN 7XAJANP 7XAJANJ 7XAJAND 7XAJA25P 7XAJA25J 7XAJA25D 7XAJAN25~
UNLESS ~7XAJAN~
APPEND ~interdia.2da~
  ~7XAJAN     7XAJANB   B7XAJA25~
  UNLESS ~7XAJAN~



ACTION_IF NOT FILE_EXISTS_IN_GAME ~override/bimoen2.dlg~ THEN BEGIN
  <<<<<<<< BG1NPCSoA/dialogues/MISC/BIMOEN2.d
  BEGIN BIMOEN2
  >>>>>>>>
  COMPILE ~BG1NPCSoA/dialogues/MISC/BIMOEN2.d~
END


//Giving Imoen a banter file if the Fixpack isn't installed

ACTION_IF NOT FILE_EXISTS_IN_GAME ~cdbehbla.pro~ //makes sure the fixpack isn't already installed
THEN BEGIN
ACTION_IF FILE_EXISTS_IN_GAME ~saradush.mve~ THEN BEGIN
  COPY_EXISTING ~interdia.2da~ ~override~
    SET_2DA_ENTRY 17 1 2 ~BIMOEN2~ // fixes ToB version
    BUT_ONLY_IF_IT_CHANGES
END ELSE BEGIN
  APPEND ~interdia.2da~ ~IMOEN       BIMOEN2~ // fixes SoA version
    UNLESS ~BIMOEN2~
END
END


// EET Fate Spirit Ajantis

ACTION_IF (GAME_IS ~eet~) BEGIN
INCLUDE ~EET/other/EET_functions.tph~ // functions from EET mod

// remove duplication in the call dialog with the option of the original EET
<<<<<<<< AJAN_fix.baf
IF
	!Global("AjantisSummoned","GLOBAL",2)
THEN
	RESPONSE #100
		SetGlobal("AjantisSummoned","GLOBAL",2)
		Continue()
END
>>>>>>>>
EXTEND_BOTTOM ~AR4000.bcs~ ~AJAN_fix.baf~


LAF ~EET_NPC_TRANSITION~
INT_VAR
type = 2 // NPC is summon-able if met before
default_ToB = 1
STR_VAR
dv = "7XAJAN" // death variable
override_SoA = "7XAJAN" // override script (SoA)
override_ToB = "7XAJAN25" // override script (ToB)
cre_ToB = "7XCRE70"
dialog_ToB = "7XAJAN" // joining dialogue for ToB
traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/AjantisTOB.tra"
string = "@0"
stringPosDV = "Alora"
END
OUTER_SPRINT ~tob_override~ ~7XAJAN25~
OUTER_SPRINT ~tob_var~ ~AjantisSummonedToB~
EXTEND_TOP ~7XAJAN.bcs~ ~fix_tob_script.baf~ EVALUATE_BUFFER
END

// Ajantis's Epilogue
EXTEND_TOP ~AR6200.bcs~ ~BG1NPCSoA/epilogues/Ajantis/AR6200.baf~
COPY ~BG1NPCSoA/epilogues/Ajantis/AjanEp.2da~ ~override/AjanEp.2da~
REPLACE ~99999~ @8019

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//
//
//
//
//
//UNFINISHED COMPONENTS
//
//
//
//
//

BEGIN @1678 DESIGNATED 65
GROUP @1900
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~
REQUIRE_PREDICATE (NOT FILE_EXISTS_IN_GAME ~DYNA10.cre~) @1679

COPY_EXISTING ~sw1h01.itm~ ~override/7xbg1n.mrk~

APPEND ~STATE.IDS~ ~0x80101FEF CD_STATE_NOTVALID~
UNLESS ~CD_STATE_NOTVALID~

COPY ~BG1NPCSoA/cre/dynaheir/7XDYNA.cre~ ~override/7XDYNA.cre~
SAY NAME1 @16780
SAY NAME2 @16780
SAY INITIAL_MEETING ~~ 
  SAY MORALE ~~ [DYNAH01]
  SAY HAPPY ~~ [DYNAH09]
  SAY UNHAPPY_ANNOYED ~~ [DYNAH29]
  SAY UNHAPPY_SERIOUS ~~ 
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ [DYNAH08]
  SAY TIRED ~~ [DYNAH10]
  SAY BORED ~~ [DYNAH12]
  SAY BATTLE_CRY1 ~~ [DYNAH03]
  SAY BATTLE_CRY2 ~~ 
  SAY BATTLE_CRY3 ~~ 
  SAY BATTLE_CRY4 ~~ 
  SAY BATTLE_CRY5 ~~ 
  SAY DAMAGE ~~ [DYNAH34]
  SAY DYING ~~ [DYNAH37]
  SAY HURT ~~ [DYNAH14]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY ~~ 
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  ~~ [DYNAH17]
  SAY SELECT_COMMON2 ~~ [DYNAH18]
  SAY SELECT_COMMON3 ~~ [DYNAH19]
  SAY SELECT_COMMON4 ~~ [DYNAH21]
  SAY SELECT_COMMON5 ~~ [DYNAH22]
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ [DYNAH16]
  SAY SELECT_ACTION2 ~~ [DYNAH20]
  SAY SELECT_ACTION3 ~~ [DYNAH23]
  SAY SELECT_ACTION4  ~~ [DYNAH24]
  SAY SELECT_ACTION5 ~~ [DYNAH27]
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 ~~ 
  SAY SELECT_RARE2 ~~ [DYNAH22]
  SAY CRITICAL_HIT ~~ 
SAY CRITICAL_MISS ~~ 
SAY TARGET_IMMUNE ~~ 
SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [DYNAH39]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~ 
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END

COPY ~BG1NPCSoA/cre/dynaheir/7XDYNAx.cre~ ~override/7XDYNAx.cre~
SAY NAME1 @1700
SAY NAME2 @1700

LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Dynaheir" oggdec_path = "BG1NPCSoA/sounds" END

COPY ~BG1NPCSoA/bam/dynaheir/HELM7X.bam~ ~override/HELM7X.bam~

COPY ~BG1NPCSoA/Items/dynaheir/HELM7X.itm~ ~Override/HELM7X.itm~
SAY NAME1 @1701
SAY NAME2 @1701
SAY UNIDENTIFIED_DESC @1701
SAY DESC @1702

EXTEND_TOP ~Ar0700.bcs~ ~BG1NPCSoA/scripts/dynaheir/AR0700.baf~
COMPILE ~BG1NPCSoA/dialogues/dynaheir/7XDYNA.d~
COMPILE ~BG1NPCSoA/dialogues/dynaheir/7XDYNAx.d~
APPEND ~pdialog.2da~
~7XDYNA	7XDYNAP	7XDYNAJ	7XDYNAD 7XDYN25P 7XDYN25J 7XDYN25D 7XDYNA25~
UNLESS ~7XDYNA~
APPEND ~interdia.2da~
  ~7XDYNA    7XDYNAB B7XDYN25~
  UNLESS ~7XDYNA~


BEGIN @1469 DESIGNATED 70
GROUP @1900
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~
REQUIRE_PREDICATE ((NOT FILE_EXISTS_IN_GAME ~p#kivan.cre~) AND 
                   (NOT FILE_EXISTS_IN_GAME ~kivan10.cre~)) @1484

COPY_EXISTING ~sw1h01.itm~ ~override/7xbg1n.mrk~ // This file helps to determine if at least one component is installed - to disable the installation of the audio component and cross-banters if none of the main components is installed.

APPEND ~STATE.IDS~ ~0x80101FEF CD_STATE_NOTVALID~
UNLESS ~CD_STATE_NOTVALID~

COPY ~BG1NPCSoA/Cre/7XCRE73.cre~ ~override/7XCRE73.cre~
SAY NAME1 @1471
SAY NAME2 @1471
SAY BIO @1470
SAY INITIAL_MEETING ~~ [KIVANJ]
  SAY MORALE ~~ 
  SAY HAPPY ~~ 
  SAY UNHAPPY_ANNOYED ~~ [KIVAN_]
  SAY UNHAPPY_SERIOUS ~~ [KIVAN_]
  SAY UNHAPPY_BREAKING ~~
  SAY LEADER ~~ [KIVANB]
  SAY TIRED ~~ [KIVANC]
  SAY BORED ~~ 
  SAY BATTLE_CRY1 ~~ 
  SAY BATTLE_CRY2 ~~ 
  SAY BATTLE_CRY3 ~~ 
  SAY BATTLE_CRY4 ~~ 
  SAY BATTLE_CRY5 ~~ 
  SAY DAMAGE ~~ 
  SAY DYING ~~ [KIVANM]
  SAY HURT ~~ [KIVANE]
  SAY AREA_FOREST ~~ 
  SAY AREA_CITY @1477
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ 
  SAY AREA_NIGHT ~~ [KIVANR]
  SAY SELECT_COMMON1  ~~ [KIVANF]
  SAY SELECT_COMMON2 ~~ [KIVANG]
  SAY SELECT_COMMON3 ~~ 
  SAY SELECT_COMMON4 ~~
  SAY SELECT_COMMON5 ~~ 
  SAY SELECT_COMMON6 ~~ 
  SAY SELECT_ACTION1 ~~ [KIVANI]
  SAY SELECT_ACTION2 ~~ [KIVANJ]
  SAY SELECT_ACTION3 ~~ 
  SAY SELECT_ACTION4  ~~ 
  SAY SELECT_ACTION5 ~~ 
  SAY SELECT_ACTION6 ~~ 
  SAY SELECT_ACTION7 ~~ 
  SAY SELECT_RARE1 @1482 
  SAY SELECT_RARE2 ~~ 
  SAY CRITICAL_HIT ~~ 
  SAY CRITICAL_MISS ~~ 
  SAY TARGET_IMMUNE ~~ 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ 
  SAY HIDDEN_IN_SHADOWS ~~ 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ 
  SAY REACT_TO_DIE_GENERAL ~~ [KIVAN!]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END

LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Kivan" oggdec_path = "BG1NPCSoA/sounds" END

COMPILE ~BG1NPCSoA/dialogues/7XKIVA.d~
EXTEND_TOP ~AR0020.bcs~ ~BG1NPCSoA/scripts/AR0020.baf~



APPEND ~pdialog.2da~
~7XKIVA	7XKIVAP		7XKIVAJ		7XKIVAD 7XKIV25P 7XKIV25J 7XKIV25D 7XKIVA25~
UNLESS ~7XKIVA~
APPEND ~interdia.2da~
  ~7XKIVA     7XKIVAB       BKIVA25~
  UNLESS ~7XKIVA~

// Kivan
ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE73.cre~ BEGIN
  COPY_EXISTING ~7XCRE73.cre~ ~override~
    WRITE_EVALUATED_ASCII SCRIPT_OVERRIDE ~7XKIVA~ #8
  BUT_ONLY_IF_IT_CHANGES
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~override/bimoen2.dlg~ THEN BEGIN
  <<<<<<<< BG1NPCSoA/dialogues/MISC/BIMOEN2.d
  BEGIN BIMOEN2
  >>>>>>>>
  COMPILE ~BG1NPCSoA/dialogues/MISC/BIMOEN2.d~
END

//Giving Imoen a banter file if the Fixpack isn't installed

ACTION_IF NOT FILE_EXISTS_IN_GAME ~cdbehbla.pro~ //makes sure the fixpack isn't already installed
THEN BEGIN
ACTION_IF FILE_EXISTS_IN_GAME ~saradush.mve~ THEN BEGIN
  COPY_EXISTING ~interdia.2da~ ~override~
    SET_2DA_ENTRY 17 1 2 ~BIMOEN2~ // fixes ToB version
    BUT_ONLY_IF_IT_CHANGES
END ELSE BEGIN
  APPEND ~interdia.2da~ ~IMOEN       BIMOEN2~ // fixes SoA version
    UNLESS ~BIMOEN2~
END

COMPILE ~BG1NPCSoA/dialogues/KivanTOB.d~


// EET Fate Spirit Kivan

ACTION_IF (GAME_IS ~eet~) BEGIN
	PRINT ~Lalala~
	INCLUDE ~EET/other/EET_functions.tph~ // functions from EET mod

// remove duplication in the call dialog with the option of the original EET
<<<<<<<< kivan_fix.baf
IF
	!Global("KivanSummoned","GLOBAL",2)
THEN
	RESPONSE #100
		SetGlobal("KivanSummoned","GLOBAL",2)
		Continue()
END
>>>>>>>>
	EXTEND_BOTTOM ~AR4000.bcs~ ~kivan_fix.baf~

//// Create and install a missing ToB-script file to avoid installation errors and not to use a script from the BG1&SOA
	ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/7XKIVA.baf~ BEGIN
		COMPILE ~%MOD_FOLDER%/scripts/7XKIVA.baf~
	END ELSE BEGIN
	<<<<<<<<7XKIVA.baf
	>>>>>>>>
		COMPILE ~7XKIVA.baf~
	END

	ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/MISC/7XKIVA25.baf~ BEGIN
		COMPILE ~%MOD_FOLDER%/scripts/MISC/7XKIVA25.baf~ END
	ELSE BEGIN
	<<<<<<<<7XKIVA25.baf
	>>>>>>>>
	COMPILE ~7XKIVA25.baf~
	END

	LAF ~EET_NPC_TRANSITION~
	INT_VAR
	type = 2 // NPC is summon-able if met before
	default_ToB = 1
	STR_VAR
	dv = "7XKIVA" // death variable 
	override_SoA = "7XKIVA" // override script (SoA)
	override_ToB = "7XKIVA25" // override script (ToB)
	cre_ToB = "7XCRE73"
	dialog_ToB = "7XKIVA" // joining dialogue for ToB
	traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/kivantob.tra"
	string = "@0"
	stringPosDV = "Korgan"
	END
	OUTER_SPRINT ~tob_override~ ~7XKIVA25~
	OUTER_SPRINT ~tob_var~ ~KIVANSummonedToB~
	EXTEND_TOP ~7XKIVA.bcs~ ~fix_tob_script.baf~ EVALUATE_BUFFER
END

END



BEGIN @1564 DESIGNATED 75
GROUP @1900
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~
REQUIRE_PREDICATE (NOT FILE_EXISTS_IN_GAME ~O#Xan09.cre~) @1593

COPY_EXISTING ~sw1h01.itm~ ~override/7xbg1n.mrk~ // This file helps to determine if at least one component is installed - to disable the installation of the audio component and cross-banters if none of the main components is installed.

APPEND ~STATE.IDS~ ~0x80101FEF CD_STATE_NOTVALID~
UNLESS ~CD_STATE_NOTVALID~

COPY ~BG1NPCSoA/Cre/7XCRE76.cre~ ~override/7XCRE76.cre~
SAY NAME1 @1567
SAY NAME2 @1567
SAY BIO @1565
SAY INITIAL_MEETING @1566 
  SAY MORALE ~~ [xan1]
  SAY HAPPY ~~ [xan15] 
  SAY UNHAPPY_ANNOYED ~~ [xan2] 
  SAY UNHAPPY_SERIOUS ~~ [xan2] 
  SAY UNHAPPY_BREAKING ~~ [xan2] 
  SAY LEADER ~~ [xan8]
  SAY TIRED ~~ [xan10]
  SAY BORED ~~ [xan12]
  SAY BATTLE_CRY1 ~~ [xan5] 
  SAY BATTLE_CRY2 ~~ 
  SAY BATTLE_CRY3 ~~ 
  SAY BATTLE_CRY4 ~~ 
  SAY BATTLE_CRY5 ~~ 
  SAY DAMAGE ~~ [xan35]
  SAY DYING ~~ [xan14] 
  SAY HURT ~~ [xan35]
  SAY AREA_FOREST ~~ [xan30]
  SAY AREA_CITY ~~ [xan31]
  SAY AREA_DUNGEON ~~ 
  SAY AREA_DAY ~~ [xan32]
  SAY AREA_NIGHT ~~ 
  SAY SELECT_COMMON1  @1579
  SAY SELECT_COMMON2 ~~ [xan20] 
  SAY SELECT_COMMON3 ~~ [xan24] 
  SAY SELECT_COMMON4 ~~ [xan25] 
  SAY SELECT_COMMON5 ~~ [xan29] 
  SAY SELECT_COMMON6 ~~ [xan7] 
  SAY SELECT_ACTION1 @1585
  SAY SELECT_ACTION2 ~~ [xan3] 
  SAY SELECT_ACTION3 ~~ [xan21] 
  SAY SELECT_ACTION4  ~~ [xan22]  
  SAY SELECT_ACTION5 ~~ [xan21] 
  SAY SELECT_ACTION6 ~~ [xan19] 
  SAY SELECT_ACTION7 ~~ [xan22] 
  SAY SELECT_RARE1 ~~ [xan24] 
  SAY SELECT_RARE2 ~~ [xan29] 
  SAY CRITICAL_HIT ~~ [xan4] 
  SAY CRITICAL_MISS ~~ [xan5] 
  SAY TARGET_IMMUNE ~~ [xan5] 
  SAY INVENTORY_FULL ~~ 
  SAY PICKED_POCKET ~~ [xan4] 
  SAY HIDDEN_IN_SHADOWS ~~ [xan4] 
  SAY SPELL_DISRUPTED ~~ 
  SAY SET_A_TRAP ~~ [xan4] 
  SAY REACT_TO_DIE_GENERAL ~~ [xan39]
  SAY INTERACTION3 ~~ 
  SAY COMPLIMENT1 ~~
PATCH_IF GAME_IS ~bg2ee eet~ BEGIN
	LPF ADD_CRE_EFFECT
		INT_VAR
			opcode = 360 //Ignore reputation
			timing = 9 //Permanent
			target = 1 //Self
			resist_dispel = 0 //Not dispellable + bypass resistance
	END
END

LAF HANDLE_AUDIO STR_VAR audio_path = "BG1NPCSoA/sounds/Xan" oggdec_path = "BG1NPCSoA/sounds" END

COPY ~BG1NPCSoA/cre/MISC/7XCRE80.cre~ ~override/7XCRE80.cre~
SAY NAME1 @1592
SAY NAME2 @1592

COPY ~BG1NPCSoA/Items/PLATNUM.itm~ ~Override/PLATNUM.itm~
SAY NAME1 @303		
SAY NAME2 @303
SAY UNIDENTIFIED_DESC @303
SAY DESC @823



COMPILE ~BG1NPCSoA/dialogues/MISC/7XCRE80.d~ 

COMPILE ~BG1NPCSoA/dialogues/7XXAN.d~


EXTEND_TOP ~AR0405.bcs~ ~BG1NPCSoA/scripts/AR0405.baf~


ACTION_IF NOT FILE_EXISTS_IN_GAME ~override/bimoen2.dlg~ THEN BEGIN
  <<<<<<<< BG1NPCSoA/dialogues/MISC/BIMOEN2.d
  BEGIN BIMOEN2
  >>>>>>>>
  COMPILE ~BG1NPCSoA/dialogues/MISC/BIMOEN2.d~
END



//Giving Imoen a banter file if the Fixpack isn't installed

ACTION_IF NOT FILE_EXISTS_IN_GAME ~cdbehbla.pro~ //makes sure the fixpack isn't already installed
THEN BEGIN
ACTION_IF FILE_EXISTS_IN_GAME ~saradush.mve~ THEN BEGIN
  COPY_EXISTING ~interdia.2da~ ~override~
    SET_2DA_ENTRY 17 1 2 ~BIMOEN2~ // fixes ToB version
    BUT_ONLY_IF_IT_CHANGES
END ELSE BEGIN
  APPEND ~interdia.2da~ ~IMOEN       BIMOEN2~ // fixes SoA version
    UNLESS ~BIMOEN2~
END
END



APPEND ~pdialog.2da~
~7XXAN	7XXANP	7XXANJ	7XXAND 7XXAN25P 7XXAN25J 7XXAN25D 7XXAN25~
UNLESS ~7XXAN~
APPEND ~interdia.2da~
  ~7XXAN     7XXANB       B7XXAN25~
  UNLESS ~7XXAN~


// Xan
ACTION_IF FILE_EXISTS_IN_GAME ~7XCRE76.cre~ BEGIN
  COPY_EXISTING ~7XCRE76.cre~ ~override~
    WRITE_EVALUATED_ASCII SCRIPT_OVERRIDE ~7XXAN~ #8
  BUT_ONLY_IF_IT_CHANGES
END


COMPILE ~BG1NPCSoA/dialogues/XanTOB.d~

// EET Fate Spirit Xan

ACTION_IF (GAME_IS ~eet~) BEGIN

INCLUDE ~EET/other/EET_functions.tph~ // functions from EET mod

// remove duplication in the call dialog with the option of the original EET

<<<<<<<< xan_fix.baf
IF
	!Global("XanSummoned","GLOBAL",2)
THEN
	RESPONSE #100
		SetGlobal("XanSummoned","GLOBAL",2)
		Continue()
END

>>>>>>>>
EXTEND_BOTTOM ~AR4000.bcs~ ~xan_fix.baf~


//// Create and install a missing ToB-script file to avoid installation errors and not to use a script from the BG1&SOA
ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/7XXAN.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/7XXAN.baf~
END ELSE BEGIN
<<<<<<<<7XXAN.baf
>>>>>>>>
	COMPILE ~7XXAN.baf~
END

ACTION_IF FILE_EXISTS ~%MOD_FOLDER%/scripts/MISC/7XXAN25.baf~ BEGIN
	COMPILE ~%MOD_FOLDER%/scripts/MISC/7XXAN25.baf~ END
ELSE BEGIN
<<<<<<<<7XXAN25.baf
>>>>>>>>
COMPILE ~7XXAN25.baf~
END


LAF ~EET_NPC_TRANSITION~
INT_VAR
type = 2 // NPC is summon-able if met before
default_ToB = 1
STR_VAR
dv = "7XXAN" // death variable of your NPC
override_SoA = "7XXAN" // override script of your NPC (SoA)
override_ToB = "7XXAN25" // override script of your NPC (ToB)
cre_ToB = "7XCRE76"
dialog_ToB = "7XXAN" // joining dialogue for ToB
traFile = EVAL "BG1NPCSoA/tra/%LANGUAGE%/XanTOB.tra"
string = "@3"
stringPosDV = "Xzar" 
END
OUTER_SPRINT ~tob_override~ ~7XXAN25~
OUTER_SPRINT ~tob_var~ ~XAN1SummonedTOB~
EXTEND_TOP ~7XXAN.bcs~ ~fix_tob_script.baf~ EVALUATE_BUFFER
END



/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//
//
//
//
//
//Change NPC Classes
//
//
//
//
//

// Make Branwen a Priest of Tempus	
BEGIN @1921 DESIGNATED 80
GROUP @1920
REQUIRE_PREDICATE GAME_IS ~bg2ee eet~ ~This component requires either BG2:EE or EET to be installed~
REQUIRE_PREDICATE (FILE_EXISTS_IN_GAME ~7Xcre5.cre~) AND (FILE_EXISTS_IN_GAME ~OHTEMPUS.2DA~) ~To install this component you must install a Branwen component~

COPY_EXISTING ~kitlist.2da~ ~override~
		COUNT_2DA_ROWS 8 "rows"
		FOR ( index = 31 ; index < rows ; index = index + 1 ) BEGIN
			READ_2DA_ENTRY "%index%" 5 8 "clab"
				PATCH_IF ("%clab%" STRING_EQUAL_CASE "OHTEMPUS" = 1) BEGIN
			SET "OHTEMPUS" = "%index%"-1
			SET "rows" = 0
			END
		END
	BUT_ONLY	
	
COPY_EXISTING ~7Xcre5.cre~ ~override~
		WRITE_BYTE 0x246 ~%OHTEMPUS%~

// Make Eldoth a Jester
BEGIN @1922 DESIGNATED 81
GROUP @1920
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~
REQUIRE_PREDICATE (FILE_EXISTS_IN_GAME ~7Xcre6.cre~) ~To install this component you must install a Eldoth component~

COPY_EXISTING ~7Xcre6.cre~ ~override~
		WRITE_SHORT 0x246  0x400E	

// Make Faldorn an Avenger
BEGIN @1923 DESIGNATED 82
GROUP @1920
REQUIRE_PREDICATE GAME_IS ~bg2ee eet~ ~This component requires either BG2:EE or EET to be installed~
REQUIRE_PREDICATE (FILE_EXISTS_IN_GAME ~7Xcre72.cre~) ~To install this component you must install a Faldorn component~

COPY_EXISTING ~7Xcre72.cre~ ~override~
		WRITE_SHORT 0x246 0x4012	

// Make Garrick a Skald
BEGIN @1924 DESIGNATED 83
GROUP @1920
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~
REQUIRE_PREDICATE (FILE_EXISTS_IN_GAME ~7Xcre3.cre~) ~To install this component you must install a Garrick component~

COPY_EXISTING ~7Xcre3.cre~ ~override~
		WRITE_SHORT 0x246 0x400F	
		
// Make Montaron a Assasin
BEGIN @1925 DESIGNATED 84
GROUP @1920
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~
REQUIRE_PREDICATE (FILE_EXISTS_IN_GAME ~7XCRE74.cre~) ~To install this component you must install a Montaron component~

COPY_EXISTING ~7XCRE74.cre~ ~override~
		WRITE_SHORT 0x246 0x400A

// Make Safana a Swashbuckler
BEGIN @1926 DESIGNATED 85
GROUP @1920
REQUIRE_PREDICATE GAME_IS ~bg2 tob bgt bg2ee eet~ ~Not support game~
REQUIRE_PREDICATE (FILE_EXISTS_IN_GAME ~7XCRE62.cre~) ~To install this component you must install a Safana component~

COPY_EXISTING ~7XCRE62.cre~ ~override~
		WRITE_SHORT 0x246 0x400C	

// Make Skie a Shadowdancer
BEGIN @1927 DESIGNATED 86
GROUP @1920
REQUIRE_PREDICATE GAME_IS ~bg2ee eet~ ~This component requires either BG2:EE or EET to be installed~
REQUIRE_PREDICATE (FILE_EXISTS_IN_GAME ~7XCRE4.cre~) ~To install this component you must install a Skie component~

COPY_EXISTING ~7XCRE4.cre~ ~override~
		WRITE_SHORT 0x246 0x4021
		WRITE_BYTE 0x0045 35 		// hide in shadows
		WRITE_BYTE 0x0064 10 		// detect illusion
		WRITE_BYTE 0x0065 0 		// set traps
		WRITE_BYTE 0x0067 0 		// open locks
		WRITE_BYTE 0x0068 35 		// move silently
		WRITE_BYTE 0x0069 0 		// find traps
		WRITE_BYTE 0x006a 10  		// pick pockets		

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


//
//
//
//
//
// CROSS-BANTERS
//
//
//
//
//
BEGIN @1737 INSTALL_BY_DEFAULT
REQUIRE_PREDICATE GAME_IS ~tob bgt bg2ee eet~ ~Not support game~
REQUIRE_PREDICATE (FILE_EXISTS_IN_GAME ~7xbg1n.mrk~) ~To install this component you must install at least one component of the mod~

ACTION_IF ( GAME_IS "bg2ee eet" ) AND ( FILE_EXISTS_IN_GAME ~ui.menu~ ) BEGIN

ACTION_IF NOT FILE_CONTAINS_EVALUATED (~ui.menu~ ~zZdialogAI~) BEGIN
//Disable AI in dialog
COPY_EXISTING ~ui.menu~ ~override~
	REPLACE_TEXTUALLY ~Infinity_PushMenu('WORLD_DIALOG_CONFIRM')~ ~if aiButtonToggle == 1 then
			zZdialogAI = 1
			game:ToggleAI()
		end
		Infinity_PushMenu('WORLD_DIALOG_CONFIRM')~
	REPLACE_TEXTUALLY ~Infinity_PopMenu('WORLD_DIALOG_CONFIRM')~ ~if zZdialogAI == 1 then
			game:ToggleAI()
		end
		zZdialogAI = 0
		Infinity_PopMenu('WORLD_DIALOG_CONFIRM')~
END

END 

ACTION_IF FILE_EXISTS_IN_GAME ~7XAJANB.dlg~ AND FILE_EXISTS_IN_GAME ~B7Xshar.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/ajantis-sharteel.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

// Smiling Imp's Shar-Teel - Jastey's Ajantis 
ACTION_IF FILE_EXISTS_IN_GAME ~C#AjanB.dlg~ AND FILE_EXISTS_IN_GAME ~B7Xshar.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Jastey's Ajantis/ajantis-sharteel.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XSkiB.dlg~ AND FILE_EXISTS_IN_GAME ~7XAJANB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/ajantis-skie.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

// Smiling Imp's Skie - Jastey's Ajantis 
ACTION_IF FILE_EXISTS_IN_GAME ~7XSkiB.dlg~ AND FILE_EXISTS_IN_GAME ~C#AjanB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Jastey's Ajantis/ajantis-skie.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XKAGA.dlg~ AND FILE_EXISTS_IN_GAME ~7XALORAJ.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/alora-kagain.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XAloraB.dlg~ AND FILE_EXISTS_IN_GAME ~7XMONTB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/alora-montaron.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XAloraB.dlg~ AND FILE_EXISTS_IN_GAME ~B7Xshar.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/alora-sharteel.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XAloraB.dlg~ AND FILE_EXISTS_IN_GAME ~7XTIAXB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/alora-tiax.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XAloraB.dlg~ AND FILE_EXISTS_IN_GAME ~B7XYES.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/alora-yeslik.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XAJANB.dlg~ AND FILE_EXISTS_IN_GAME ~7XBRANB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/branwen-ajantis.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

// Smiling Imp's Branwen - Jastey's Ajantis 
ACTION_IF FILE_EXISTS_IN_GAME ~C#AjanB.dlg~ AND FILE_EXISTS_IN_GAME ~7XBRANB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Jastey's Ajantis/branwen-ajantis.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XQUAYB.dlg~ AND FILE_EXISTS_IN_GAME ~7XBRANB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/branwen-quayle.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XTIAXB.dlg~ AND FILE_EXISTS_IN_GAME ~7XBRANB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/branwen-tiax.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XXANB.dlg~ AND FILE_EXISTS_IN_GAME ~7XBRANB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/branwen-xan.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

// Smiling Imp's Branwen - Kulyok's Xan 
ACTION_IF FILE_EXISTS_IN_GAME ~BO#XAN.dlg~ AND FILE_EXISTS_IN_GAME ~7XBRANB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Kulyok's Xan/branwen-xan(kulyok's).d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XXZARB.dlg~ AND FILE_EXISTS_IN_GAME ~7XBRANB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/branwen-xzar.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XXANB.dlg~ AND FILE_EXISTS_IN_GAME ~B7XCoran.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/coran-xan.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

// Smiling Imp's Coran - Kulyok's Xan 
ACTION_IF FILE_EXISTS_IN_GAME ~BO#XAN.dlg~ AND FILE_EXISTS_IN_GAME ~B7XCoran.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Kulyok's Xan/coran-xan(kulyok's).d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XXZARB.dlg~ AND FILE_EXISTS_IN_GAME ~B7XCoran.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/coran-xzar.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~B7XGar.dlg~ AND FILE_EXISTS_IN_GAME ~B7XCoran.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/garrik-coran.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XQUAYB.dlg~ AND FILE_EXISTS_IN_GAME ~B7XGar.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/garrik-quayle.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XTIAXB.dlg~ AND FILE_EXISTS_IN_GAME ~B7XGar.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/garrik-tiax.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XXANB.dlg~ AND FILE_EXISTS_IN_GAME ~B7XGar.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/garrik-xan.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

// Smiling Imp's Garrick - Kulyok's Xan 
ACTION_IF FILE_EXISTS_IN_GAME ~BO#XAN.dlg~ AND FILE_EXISTS_IN_GAME ~B7XGar.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Kulyok's Xan/garrik-xan(kulyok's).d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END


ACTION_IF FILE_EXISTS_IN_GAME ~7XXZARB.dlg~ AND FILE_EXISTS_IN_GAME ~B7XGar.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/garrik-xzar.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XKagaB.dlg~ AND FILE_EXISTS_IN_GAME ~7XMONTB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/kagain-montaron.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XKagaB.dlg~ AND FILE_EXISTS_IN_GAME ~7XSkiB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/kagain-skie.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XKagaB.dlg~ AND FILE_EXISTS_IN_GAME ~B7XYES.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/kagain-yeslik.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~B7Xshar.dlg~ AND FILE_EXISTS_IN_GAME ~B7XCoran.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/sharteel-coran.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XSHAR.dlg~ AND FILE_EXISTS_IN_GAME ~DEEKIN.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/sharteel-deekin.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XSHAR.dlg~ AND FILE_EXISTS_IN_GAME ~7XkagaJ.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/sharteel-kagain.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~B7Xshar.dlg~ AND FILE_EXISTS_IN_GAME ~7XMONTB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/sharteel-montaron.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~B7Xshar.dlg~ AND FILE_EXISTS_IN_GAME ~7XQUAYB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/sharteel-quayle.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~B7Xshar.dlg~ AND FILE_EXISTS_IN_GAME ~B7XSafa.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/sharteel-safana.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~B7Xshar.dlg~ AND FILE_EXISTS_IN_GAME ~7XTIAXB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/sharteel-tiax.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~B7Xshar.dlg~ AND FILE_EXISTS_IN_GAME ~7XXANB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/sharteel-xan.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

// Smiling Imp's Sharteel - Kulyok's Xan 
ACTION_IF FILE_EXISTS_IN_GAME ~B7Xshar.dlg~ AND FILE_EXISTS_IN_GAME ~BO#XAN.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Kulyok's Xan/sharteel-xan(kulyok's).d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~B7Xshar.dlg~ AND FILE_EXISTS_IN_GAME ~7XXZARB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/sharteel-xzar.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~B7XCoran.dlg~ AND FILE_EXISTS_IN_GAME ~7XSkiB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/skie-coran.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XMONTB.dlg~ AND FILE_EXISTS_IN_GAME ~7XSkiB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/skie-montaron.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XQUAYB.dlg~ AND FILE_EXISTS_IN_GAME ~7XSkiB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/skie-quayle.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~B7XCoran.dlg~ AND FILE_EXISTS_IN_GAME ~7XTIAXB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/tiax-coran.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XKAGA.dlg~ AND FILE_EXISTS_IN_GAME ~7XTIAXJ.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/tiax-kagain.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XXANB.dlg~ AND FILE_EXISTS_IN_GAME ~7XTIAXB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/tiax-xan.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

// Smiling Imp's Tiax - Kulyok's Xan 
ACTION_IF FILE_EXISTS_IN_GAME ~BO#XAN.dlg~ AND FILE_EXISTS_IN_GAME ~7XTIAXB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Kulyok's Xan/tiax-xan(kulyok's).d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~B7XCoran.dlg~ AND FILE_EXISTS_IN_GAME ~B7XYES.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/yeslik-coran.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XMONTB.dlg~ AND FILE_EXISTS_IN_GAME ~B7XYES.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/yeslik-montaron.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XXZARB.dlg~ AND FILE_EXISTS_IN_GAME ~B7XYES.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/yeslik-xzar.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~TQCRE1.dlg~ AND FILE_EXISTS_IN_GAME ~7XALORAJ.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Circus comments/CIRCUS-alora.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~KGSTO2.dlg~ AND FILE_EXISTS_IN_GAME ~7XALORAJ.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Water Gardens comments/GARDENS-alora.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~BG1X20.dlg~ AND FILE_EXISTS_IN_GAME ~7XCoranJ.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Water Gardens comments/GARDENS-coran.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~BG1X20.dlg~ AND FILE_EXISTS_IN_GAME ~7XkagaJ.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Water Gardens comments/GARDENS-kagain.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~BG1X20.dlg~ AND FILE_EXISTS_IN_GAME ~7XMONTJ.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Water Gardens comments/GARDENS-montaron.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~BG1X20.dlg~ AND FILE_EXISTS_IN_GAME ~7XXANJ.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Water Gardens comments/GARDENS-xan.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

// Kulyok's Xan in Water Gardens
ACTION_IF FILE_EXISTS_IN_GAME ~BG1X20.dlg~ AND FILE_EXISTS_IN_GAME ~O#XANJ.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Water Gardens comments/GARDENS-xan(kulyok's).d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~KGSTO2.dlg~ AND FILE_EXISTS_IN_GAME ~7XXZARJ.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Water Gardens comments/GARDENS-xzar.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END


ACTION_IF FILE_EXISTS_IN_GAME ~B7XSafa.dlg~ AND FILE_EXISTS_IN_GAME ~7XXZARB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/xzar-safana.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END


////////////

ACTION_IF FILE_EXISTS_IN_GAME ~B7XGar.dlg~ AND FILE_EXISTS_IN_GAME ~B7XEldo.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/garrik-eldoth.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/interbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~B7XGar.dlg~ AND FILE_EXISTS_IN_GAME ~B7Xshar.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/garrick-sharteel.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/interbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~B7XGar.dlg~ AND FILE_EXISTS_IN_GAME ~7XBRANB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/branwen-garrick.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/interbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~B7XGar.dlg~ AND FILE_EXISTS_IN_GAME ~7XSkiB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/skie-garrick.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/interbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~B7Xshar.dlg~ AND FILE_EXISTS_IN_GAME ~7XBRANB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/branwen-sharteel.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/interbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XSkiB.dlg~ AND FILE_EXISTS_IN_GAME ~B7XYES.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/yeslik-skie.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/interbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~B7XYES.dlg~ AND FILE_EXISTS_IN_GAME ~7XBRANB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/branwen-yeslick.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/interbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XSkiB.dlg~ AND FILE_EXISTS_IN_GAME ~7XBRANB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/branwen-skie.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/interbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XFALDB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/faldorn-korgan-ALL.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XFALDB.dlg~ AND FILE_EXISTS_IN_GAME ~7XkagaB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/faldorn-kagain-ALL.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~BDEEKIN.dlg~ AND FILE_EXISTS_IN_GAME ~7XTIAXB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/tiax-deekin.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~BDEEKIN.dlg~ AND FILE_EXISTS_IN_GAME ~7XXZARB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/xzar-deekin.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

// Smiling Imp's Garrick - Kulyok's Coran 
ACTION_IF FILE_EXISTS_IN_GAME ~BO#CORAN.dlg~ AND FILE_EXISTS_IN_GAME ~B7XGar.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Kulyok's Coran/garrik-coran(kulyok's).d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XKagaB.dlg~ AND FILE_EXISTS_IN_GAME ~B7XGar.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/garrik-kagain.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XAloraB.dlg~ AND FILE_EXISTS_IN_GAME ~B7XGar.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/alora-garrick.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XAJANB.dlg~ AND FILE_EXISTS_IN_GAME ~B7XGar.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/ajantis-garrick.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

// Smiling Imp's Garrick - Jastey's Ajantis 
ACTION_IF FILE_EXISTS_IN_GAME ~C#AjanB.dlg~ AND FILE_EXISTS_IN_GAME ~B7XGar.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Jastey's Ajantis/ajantis-garrick.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~B7XSafa.dlg~ AND FILE_EXISTS_IN_GAME ~B7XGar.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/garrick-safana.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XFALDB.dlg~ AND FILE_EXISTS_IN_GAME ~7XSkiB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/faldorn-skie.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~BDEEKIN.dlg~ AND FILE_EXISTS_IN_GAME ~7XMONTB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/montaron-deekin.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XTIAXB.dlg~ AND FILE_EXISTS_IN_GAME ~7XMONTB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/montaron-tiax.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

// Smiling Imp's Montaron - Kulyok's Tiax
ACTION_IF FILE_EXISTS_IN_GAME ~BO#TIAX.dlg~ AND FILE_EXISTS_IN_GAME ~7XMONTB.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Kulyok's Tiax/montaron-tiax(kulyok's).d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XAJANB.dlg~ AND FILE_EXISTS_IN_GAME ~BDEEKIN.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/ajantis-deekin.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

ACTION_IF FILE_EXISTS_IN_GAME ~7XAJANB.dlg~ AND FILE_EXISTS_IN_GAME ~B7XCoran.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/ajantis-coran.d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END

// Smiling Imp's Ajantis - Kulyok's Coran
ACTION_IF FILE_EXISTS_IN_GAME ~7XAJANB.dlg~ AND FILE_EXISTS_IN_GAME ~BO#CORAN.dlg~ BEGIN
COMPILE ~%MOD_FOLDER%/crossbanter/Kulyok's Coran/ajantis-coran(kulyok's).d~ USING ~%MOD_FOLDER%/tra/%LANGUAGE%/crossbanter.tra~
END